"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1470],{114321:(e,t,i)=>{i.d(t,{A:()=>a});i(286326);var n=i(237064),o=i(592353),r=i(919796),s=i(836870);const a=e=>{let{children:t,className:i,full_width:a,icon:l,is_disabled_for_mobile:c=!1,message:d,text:u}=e;const{isDesktop:_}=(0,r.Y)();return(0,s.jsx)(o.Div100vhContainer,{className:(0,n.A)("account-management__message-wrapper",{"account-management__message-wrapper-full-width":a}),is_disabled:_||c,height_offset:"110px",children:(0,s.jsxs)("div",{className:(0,n.A)("account-management__message-content",{[`${i}__message-content`]:i}),children:[l&&(0,s.jsx)("div",{className:(0,n.A)("account-management__message-icon",{[`${i}__message-icon`]:i}),children:l}),(0,s.jsx)(o.Text,{as:"div",color:"general",weight:"bold",align:"center",className:(0,n.A)("account-management__message",{[`${i}__message`]:i}),children:d}),u&&(0,s.jsx)("div",{className:"account-management__text-container",children:(0,s.jsx)(o.Text,{className:(0,n.A)({[`${i}__text`]:i}),as:"p",size:"xs",align:"center",children:u})}),t]})})}},155142:(e,t,i)=>{i.d(t,{A:()=>n});const n=i(114321).A},513617:(e,t,i)=>{i.d(t,{A:()=>_});var n=i(286326),o=i(103083),r=i(338508),s=i(773835),a=i(438295);const l=["data"];function c(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function d(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?c(Object(i),!0).forEach((function(t){u(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function u(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const _=()=>{const e=(0,o.getActiveAuthTokenIDFromLocalStorage)(),t=(0,r.A)(),{switchEnvironment:i,queryClient:c}=(0,a.xH)(),[u,_]=(0,n.useState)((0,o.getActiveLoginIDFromLocalStorage)()),m=(0,s.A)("authorize",{payload:{authorize:e||""},options:{enabled:Boolean(e),refetchOnWindowFocus:!1,refetchOnReconnect:!1}}),{data:f}=m,p=function(e,t){if(null==e)return{};var i,n,o=function(e,t){if(null==e)return{};var i={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;i[n]=e[n]}return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)i=r[n],-1===t.indexOf(i)&&{}.propertyIsEnumerable.call(e,i)&&(o[i]=e[i])}return o}(m,l),b=(0,n.useMemo)((()=>d({},null==f?void 0:f.authorize)),[null==f?void 0:f.authorize]);return d({data:b,switchAccount:(0,n.useCallback)((e=>{const t=(0,o.getActiveLoginIDFromLocalStorage)();t!==e&&(sessionStorage.setItem("active_loginid",e),localStorage.setItem("active_loginid",e),i(t),c.cancelQueries(),_(e))}),[t,i,u]),currentLoginID:u},p)}},780146:(e,t,i)=>{i.d(t,{A:()=>c});var n=i(286326),o=i(773835);const r=["data"];function s(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function a(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?s(Object(i),!0).forEach((function(t){l(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function l(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const c=()=>{const e=(0,o.A)("residence_list"),{data:t}=e,i=function(e,t){if(null==e)return{};var i,n,o=function(e,t){if(null==e)return{};var i={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;i[n]=e[n]}return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)i=r[n],-1===t.indexOf(i)&&{}.propertyIsEnumerable.call(e,i)&&(o[i]=e[i])}return o}(e,r),s=(0,n.useMemo)((()=>t&&t.residence_list?t.residence_list.map((e=>a({},e))):[]),[t]);return a({data:s},i)}},672313:(e,t,i)=>{i.d(t,{A:()=>f});var n=i(286326),o=i(513617),r=i(773835),s=i(338508),a=i(108340);const l=["data"],c=["mutate"];function d(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function u(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?d(Object(i),!0).forEach((function(t){_(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):d(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function _(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function m(e,t){if(null==e)return{};var i,n,o=function(e,t){if(null==e)return{};var i={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;i[n]=e[n]}return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)i=r[n],-1===t.indexOf(i)&&{}.propertyIsEnumerable.call(e,i)&&(o[i]=e[i])}return o}const f=()=>{const{isSuccess:e}=(0,o.A)(),t=(0,r.A)("get_settings",{options:{enabled:e}}),{data:i}=t,d=m(t,l),_=(0,a.A)("set_settings",{onSuccess:()=>b("get_settings")}),{mutate:f}=_,p=m(_,c),b=(0,s.A)(),x=(0,n.useCallback)((e=>f({payload:e})),[f]),h=(0,n.useMemo)((()=>{var e,t,n,o,r,s,a,l,c,d;const _=null!==(e=null==i||null===(t=i.get_settings)||void 0===t?void 0:t.citizen)&&void 0!==e?e:"",m=null!==(n=null==i||null===(o=i.get_settings)||void 0===o?void 0:o.account_opening_reason)&&void 0!==n?n:"",f=null!==(r=null==i||null===(s=i.get_settings)||void 0===s?void 0:s.place_of_birth)&&void 0!==r?r:"",p=null!==(a=null==i||null===(l=i.get_settings)||void 0===l?void 0:l.tax_residence)&&void 0!==a?a:"",b=null!==(c=null==i||null===(d=i.get_settings)||void 0===d?void 0:d.tax_identification_number)&&void 0!==c?c:"";return u(u({},null==i?void 0:i.get_settings),{},{has_submitted_personal_details:Boolean(_&&m&&f&&p&&b)})}),[null==i?void 0:i.get_settings]);return u({data:h,update:x,mutation:p},d)}},95627:(e,t,i)=>{i.r(t),i.d(t,{default:()=>on});var n=i(286326),o=i(592353),r=i(679955),s=i(414646),a=i(189137),l=i(33118),c=i(155142),d=i(836870);const u=e=>{let{onClick:t}=e;return(0,d.jsx)("div",{className:"account-management__container",children:(0,d.jsx)(c.A,{message:(0,d.jsx)(l.Localize,{i18n_default_text:"New proof of address is needed"}),text:(0,d.jsx)(l.Localize,{i18n_default_text:"Your document for proof of address is expired. <0/>Please submit again.",components:[(0,d.jsx)("br",{},0)]}),icon:(0,d.jsx)(o.Icon,{icon:"IcPoaUpload",size:128}),children:(0,d.jsx)(o.Button,{onClick:t,has_effect:!0,primary:!0,children:(0,d.jsx)(o.Text,{className:"dc-btn__text",size:"xs",weight:"bold",as:"p",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Resubmit"})})})})})},_=()=>(0,d.jsx)(c.A,{message:(0,l.localize)("Proof of address verification not required"),text:(0,l.localize)("Your account does not need address verification at this time. We will inform you if address verification is required in the future."),icon:(0,d.jsx)(o.Icon,{icon:"IcPoaVerified",size:128})});var m=i(824223),f=i(919796),p=i(205007);const b=e=>{let{error_message:t}=e;return(0,d.jsx)(c.A,{message:t,icon:(0,d.jsx)(o.Icon,{icon:"IcPoaLock",size:128})})};var x=i(291218);const h=e=>{let{back:t,leave:i}=e;const{isMobile:n}=(0,f.Y)();return(0,d.jsx)(c.A,{className:"leave-confirm",message:(0,l.localize)("Unsaved changes"),text:(0,l.localize)("You have unsaved changes. Are you sure you want to discard changes and leave this page?"),icon:(0,d.jsx)(o.Icon,{icon:"IcUnsavedChanges",size:n?93:128,data_testid:"dt_unsaved_changes_icon"}),is_disabled_for_mobile:!0,children:(0,d.jsxs)("div",{className:"account-management-flex-wrapper account-management-leave-confirm",children:[(0,d.jsx)(o.Button,{type:"button",has_effect:!0,onClick:t,text:(0,l.localize)("Cancel"),secondary:!0,large:n}),(0,d.jsx)(o.Button,{type:"button",has_effect:!0,onClick:i,text:(0,l.localize)("Leave Settings"),primary:!0,large:n})]})})},y=(0,x.withRouter)((e=>{let{dirty:t,onDirty:i}=e;const r=(0,x.useHistory)(),s=(0,x.useLocation)(),{isMobile:a}=(0,f.Y)(),[l,c]=n.useState(!1),[u,_]=n.useState(s.pathname);n.useEffect((()=>{const e=r.block((e=>!(t&&!l)||(i&&i(!1),_(e.pathname),c(!0),!1)));return()=>e()}),[t,l,r,i]);const m=n.useCallback((()=>{u&&(c(!1),r.push(u),i&&i(!1))}),[u,r,i]),p=()=>{c(!1),_(s.pathname),i&&i(!0)};return(0,d.jsx)(d.Fragment,{children:l&&a?(0,d.jsx)(h,{back:p,leave:m}):(0,d.jsx)(o.Modal,{is_open:l,small:!0,toggleModal:p,children:(0,d.jsx)(o.Modal.Body,{children:(0,d.jsx)(h,{back:p,leave:m})})})})})),g=e=>{let{onDirty:t}=e;return(0,d.jsx)(m.FormikConsumer,{children:e=>(0,d.jsx)(y,{onDirty:t,dirty:e.dirty&&0===e.submitCount})})};var v=i(837062);const j=Object.freeze({DUPLICATE_ACCOUNT:"DuplicateAccount",CLAIMED_DOCUMENT:"ClaimedDocument",DUPLICATE_DOCUMENT:"DuplicateUpload"});var O=i(596176),w=i(237064);const S=()=>{const{isDesktop:e,isMobile:t}=(0,f.Y)();return(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(o.Icon,{icon:"IcUpload",className:"dc-file-dropzone__message-icon",size:30}),(0,d.jsxs)("div",{className:"dc-file-dropzone__message-subtitle",children:[(0,d.jsx)(o.Text,{size:"xxs",align:"center",weight:"bold",color:"less-prominent",children:e?(0,d.jsx)(l.Localize,{i18n_default_text:"Drag and drop a file or click to browse your files."}):(0,d.jsx)(l.Localize,{i18n_default_text:"Click here to browse your files."})}),(0,d.jsx)(o.Text,{size:t?"xxxxs":"xxxs",align:"center",color:"less-prominent",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Remember, selfies, pictures of houses, or non-related images will be rejected."})})]})]})},P=e=>{let{onFileDrop:t,onError:i}=e;const[r,s]=n.useState([]),[c,u]=n.useState(null);n.useEffect((()=>{r&&(t(r),null==i||i(""))}),[r,t,i]);return(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(o.FileDropzone,{accept:a.supported_filetypes,error_message:(0,l.localize)("Please upload supported file type."),filename_limit:26,hover_message:(0,l.localize)("Drop files here.."),max_size:a.max_document_size,message:(0,d.jsx)(S,{}),multiple:!1,onDropAccepted:e=>{e.length>0&&(s(e),u(null),null==i||i(""))},onDropRejected:e=>{const t=e.length>0&&e[0].file.size>a.max_document_size,n=e.filter((e=>(0,a.getSupportedFiles)(e.file.name))),o=t&&n.length>0?(0,l.localize)("File size should be 8MB or less"):(0,l.localize)("File uploaded is not supported");s([]),null==i||i(o),u(o)},validation_error_message:c,value:r}),(r&&(null==r?void 0:r.length)>0||c)&&(0,d.jsx)("div",{className:"file-uploader__remove-btn-container",children:(0,d.jsx)(o.Icon,{icon:"IcCloseCircle",className:(0,w.A)("file-uploader__remove-btn",{"file-uploader__remove-btn--error":c}),onClick:()=>{s([]),u(null),null==i||i("")},color:"secondary",data_testid:"dt_remove_file_icon"})})]})};var z=i(773835);const N=["data"];function D(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function k(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const A=e=>{const{client:t}=(0,s.A)(),{is_authorize:i}=t,n=(0,z.A)("kyc_auth_status",{payload:e,options:{enabled:i}}),{data:o}=n,r=function(e,t){if(null==e)return{};var i,n,o=function(e,t){if(null==e)return{};var i={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;i[n]=e[n]}return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)i=r[n],-1===t.indexOf(i)&&{}.propertyIsEnumerable.call(e,i)&&(o[i]=e[i])}return o}(n,N);return function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?D(Object(i),!0).forEach((function(t){k(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):D(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({kyc_auth_status:null==o?void 0:o.kyc_auth_status},r)},T=(e,t)=>{const i={title:(0,d.jsx)(O.Localize,{i18n_default_text:"The document must be recent and include your name and address:"}),descriptions:[{id:"signed_document",value:(0,d.jsx)(O.Localize,{i18n_default_text:"The document must be up-to-date and signed by the issuance authority."})},{id:"contains_letterhead",value:(0,d.jsx)(O.Localize,{i18n_default_text:"The document must contain a letterhead."})},{id:"invalid_rejected",value:(0,d.jsx)(O.Localize,{i18n_default_text:"Invalid or incomplete documents shall be rejected."})}]},n={title:(0,d.jsx)(O.Localize,{i18n_default_text:"Upload an original (unaltered) document that clearly shows your name and address, issued within the past {{expiry_in_months}} months. We accept:",values:{expiry_in_months:t?6:12}}),descriptions:[{id:"utility_bill",value:(0,d.jsx)(O.Localize,{i18n_default_text:"<0>Utility bill:</0> Electricity, water, gas, or landline phone bill.",components:[(0,d.jsx)("strong",{},0)]})},{id:"financial_legal_government_document",value:(0,d.jsx)(O.Localize,{i18n_default_text:"<0>Financial, legal, or government document:</0> Recent bank statement, affidavit, or government-issued letter.",components:[(0,d.jsx)("strong",{},0)]})},{id:"tenancy_agreement",value:(0,d.jsx)(O.Localize,{i18n_default_text:"<0>Tenancy agreement:</0> Valid and current agreement.",components:[(0,d.jsx)("strong",{},0)]})}]};return"poinc"===e?i:"poa"===e?n:{title:"",descriptions:[]}},I=()=>[{value:"utility_bill",text:(0,O.localize)("Utility bill (electricity, water, gas)")},{value:"phone_bill",text:(0,O.localize)("Landline phone bill")},{value:"bank_statement",text:(0,O.localize)("Bank statement")},{value:"affidavit",text:(0,O.localize)("Official residence declaration or affidavit")},{value:"official_letter",text:(0,O.localize)("Official letter issued by the government or solicitor")},{value:"rental_agreement",text:(0,O.localize)("Rental/tenancy agreement")},{text:(0,O.localize)("Others"),value:"poa_others"}];function E(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function C(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?E(Object(i),!0).forEach((function(t){L(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):E(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function L(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const F=e=>{let{examples:t,files_description:i,country_of_residence:r,onFileDrop:s,onError:a,placeholder:l}=e;const{isMobile:c}=(0,f.Y)(),{localize:u}=(0,O.useTranslations)(),{kyc_auth_status:_,isLoading:p}=A({country:r}),[b,x]=n.useState([]);return n.useEffect((()=>{if(_){const{address:e}=_,{supported_documents:t}=e,i=I().filter((e=>null==t?void 0:t.includes(e.value)));x(i)}}),[_]),p?(0,d.jsx)(o.Loading,{is_fullscreen:!1}):(0,d.jsxs)("div",{className:"file-uploader__container","data-testid":"dt_file_uploader_container",children:[i,t,r&&(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(o.Text,{size:c?"xxs":"xs",as:"div",className:"file-uploader__file-title",weight:"bold",children:(0,d.jsx)(O.Localize,{i18n_default_text:"Select the type of document:"})}),(0,d.jsx)(m.Field,{name:"document_type",children:e=>{let{field:t,form:{setFieldValue:i}}=e;return(0,d.jsx)(o.Autocomplete,C(C({},t),{},{"data-lpignore":"true",autoComplete:"off",list_items:b,type:"text",value:t.value,label:l,placeholder:null!=l?l:u("Select a document"),onItemSelection:e=>{i("document_type",e.text,!0)},required:!0}))}})]}),(0,d.jsx)(o.Text,{size:c?"xxs":"xs",as:"div",className:"file-uploader__file-title",weight:"bold",children:(0,d.jsx)(O.Localize,{i18n_default_text:"Upload file"})}),(0,d.jsx)("div",{className:"file-uploader__file-dropzone-wrapper",children:(0,d.jsx)(P,{onError:a,onFileDrop:s})}),(0,d.jsxs)("div",{className:"file-uploader__file-supported-formats",children:[(0,d.jsx)(o.Text,{size:c?"xxxs":"xxs",children:(0,d.jsx)(O.Localize,{i18n_default_text:"Supported formats: JPEG, JPG, PNG, PDF, and GIF only"})}),(0,d.jsx)(o.Text,{size:c?"xxxs":"xxs",children:(0,d.jsx)(O.Localize,{i18n_default_text:"Maximum size: 8MB"})})]})]})},R=e=>{let{descriptions:t,title:i}=e;const{isMobile:n}=(0,f.Y)();return(0,d.jsxs)("div",{className:"files-description",children:[(0,d.jsx)(o.Text,{size:n?"xxs":"xs",as:"div",className:"files-description__title",weight:"bold",children:i}),(0,d.jsx)("ul",{children:t.map((e=>(0,d.jsx)("li",{children:(0,d.jsx)(o.Text,{size:n?"xxs":"xs",line_height:n?"l":"xl",children:e.value})},e.id)))})]})},M=e=>{let{children:t,className:i,scroll_offset:n,isFullHeight:r=!1}=e;const{isDesktop:s}=(0,f.Y)(),a=r?"100vh":"100%";return(0,d.jsx)(o.ThemedScrollbars,{is_bypassed:!s,height:n?`calc(${a} - ${n})`:"100%",children:(0,d.jsx)("div",{className:(0,w.A)("account__scrollbars_container",i),"data-testid":"dt_scrollbar_container_div",children:t})})},U=e=>{let{children:t,scroll_offset:i,className:r,isFullHeight:s}=e;const{isDesktop:a}=(0,f.Y)();return(0,d.jsx)(n.Fragment,{children:a?(0,d.jsx)(M,{className:(0,w.A)("account__scrollbars_container--grid-layout",r),scroll_offset:i,isFullHeight:s,children:t}):(0,d.jsx)(o.Div100vhContainer,{className:(0,w.A)("account__scrollbars_container--grid-layout",r),height_offset:i||"100%",children:t})})};var V=i(37811);const B=e=>{let{children:t,className:i}=e;return(0,d.jsx)("div",{className:(0,w.A)("account-form__footer",i),"data-testid":"form-footer-container",children:t})};var Y=i(138768),q=i(678891),$=i(602012),W=i(429106),H=i(338535),G=i(496148),J=i(936017),Z=i(296049);function K(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Q(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?K(Object(i),!0).forEach((function(t){X(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):K(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function X(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var ee=i(345102);const te=e=>{let{description:t,image:i}=e;return(0,d.jsxs)("div",{className:"common-mistake-examples__content-layout",children:[i,(0,d.jsxs)("div",{className:"common-mistake-examples__content-description",children:[(0,d.jsx)(ee.A,{iconSize:"xs"}),(0,d.jsx)(o.Text,{size:"xxxs",line_height:"s",role:"document",children:t})]})]})},ie=()=>{const{isDesktop:e}=(0,f.Y)(),{client:t}=(0,s.A)(),{is_eu:i}=t,r=(e=>[{image:q.A,description:(0,d.jsx)(l.Localize,{i18n_default_text:"Name in document doesn’t match your Deriv profile."}),ref:"name_mismatch"},{image:$.A,description:(0,d.jsx)(l.Localize,{i18n_default_text:"Address in document doesn’t match address you entered above."}),ref:"address_mismatch"},Q({},e?{image:W.A,description:(0,d.jsx)(l.Localize,{i18n_default_text:"Document issued more than 6-months ago."}),ref:"old_6_month_issued_document"}:{image:H.A,description:(0,d.jsx)(l.Localize,{i18n_default_text:"Document issued more than 12-months ago."}),ref:"old_12_month_issued_document"}),{image:G.A,description:(0,d.jsx)(l.Localize,{i18n_default_text:"Blurry document. All information must be clear and visible."}),ref:"blurry_document"},{image:J.A,description:(0,d.jsx)(l.Localize,{i18n_default_text:"Cropped document. All information must be clear and visible."}),ref:"cropped_document"},{image:Z.A,description:(0,d.jsx)(l.Localize,{i18n_default_text:"An envelope with your name and address."}),ref:"envelope"}])(i);return(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(o.Text,{as:"div",weight:"bold",size:e?"xs":"xxs",className:"common-mistake-examples__title",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Common mistakes"})}),(0,d.jsx)("div",{className:"common-mistake-examples__content",children:r.map((e=>(0,d.jsx)(te,{description:e.description,image:(0,d.jsx)(e.image,{})},e.ref)))})]})};var ne=i(791768);const oe=(0,r.observer)((e=>{let{className:t,setOffset:i,is_for_cfd_modal:r,is_resubmit:a,setDocumentFiles:l,document_files:c,form_state:u}=e;const{status:_,handleSubmit:p,isSubmitting:b,isValid:x}=(0,m.useFormikContext)(),{isDesktop:h}=(0,f.Y)(),{client:y}=(0,s.A)(),[g,v]=n.useState(null),{localize:j}=(0,O.useTranslations)(),{states_list:w,account_settings:S,is_eu:P,getChangeableFields:z}=y,N=z(),D=n.useMemo((()=>T("poa",P)),[]);return(0,d.jsxs)(m.Form,{noValidate:!0,className:"account-form account-form_poa",onSubmit:p,children:[(0,d.jsx)(o.ThemedScrollbars,{height:"572px",is_bypassed:!r||!h,className:t,children:(0,d.jsxs)(U,{scroll_offset:i(_),isFullHeight:!h,children:[((null==_?void 0:_.msg)||a)&&(0,d.jsx)(o.InlineMessage,{type:"error",message:(0,d.jsxs)(o.Text,{as:"p",size:"xs",children:[!(null!=_&&_.msg)&&a&&(0,d.jsx)(O.Localize,{i18n_default_text:"We were unable to verify your address with the details you provided. Please check and resubmit or choose a different document type."}),null==_?void 0:_.msg]}),id:"dt_poa_submit-error"}),(0,d.jsx)(Y.A,{title:j("Enter your address"),title_text_size:"s"}),(0,d.jsx)(ne.A,{is_qualified_for_poa:!0,editable_fields:N,states_list:w}),(0,d.jsx)(Y.A,{title:j("Submit your document"),title_text_size:"s"}),(0,d.jsx)(V.A,{children:(0,d.jsx)(F,{onFileDrop:e=>{l(e)},onError:v,files_description:(0,d.jsx)(R,{title:D.title,descriptions:D.descriptions}),examples:(0,d.jsx)(ie,{}),country_of_residence:null==S?void 0:S.country_code,placeholder:j("Type of document")})})]})}),r?(0,d.jsx)(o.Modal.Footer,{has_separator:!0,children:(0,d.jsx)(o.FormSubmitButton,{is_disabled:b||!x||c&&c.length<1||!!g,label:j("Continue"),is_loading:b})}):(0,d.jsx)(B,{className:"account-form__footer-poa",children:(0,d.jsx)(o.Button,{className:"account-form__footer-btn",type:"submit",is_disabled:b||!x||c&&c.length<1||!!g,has_effect:!0,is_loading:u.is_btn_loading,is_submit_success:u.is_submit_success,text:j("Save and submit"),primary:!0})})]})}));var re=i(182997);function se(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function ae(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?se(Object(i),!0).forEach((function(t){le(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):se(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function le(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const ce=e=>{let{is_active:t}=e;return(0,d.jsx)("div",{className:"progress-container",children:(0,d.jsx)("div",{className:(0,w.A)("progress-bar",{"progress-bar--animate":t})})})},de=(0,r.observer)((e=>{let{setOffset:t,is_resubmit:i,form_state:r,document_files:a,setDocumentFiles:l,is_for_cfd_modal:c}=e;const{localize:u}=(0,O.useTranslations)(),{status:_,handleSubmit:f,isSubmitting:p,isValid:b,values:x,errors:h}=(0,m.useFormikContext)(),{client:y}=(0,s.A)(),[g,v]=n.useState(null),[j,S]=n.useState({id:1,text:u("Enter your address")}),{states_list:P,account_settings:z,is_eu:N,getChangeableFields:D}=y,k=D(),A=n.useMemo((()=>T("poa",N)),[N]),I=n.useMemo((()=>2!==j.id&&!(x.address_line_1&&!h.address_line_1&&!h.address_line_2&&x.address_city&&!h.address_city&&!h.address_state&&!h.address_postcode)),[x,h,j.id]);return(0,d.jsxs)("div",{className:"poa-mobile-layout",children:[(0,d.jsxs)("div",{className:(0,w.A)("poa-header",{"poa-header--non-modal":!c}),children:[(0,d.jsxs)("div",{className:"timeline",children:[2===j.id&&(0,d.jsx)(re.A,{onClick:()=>S({id:1,text:u("Enter your address")})}),(0,d.jsx)(o.Text,{as:"p",size:"xxs",children:(0,d.jsx)(O.Localize,{i18n_default_text:"<0>Step {{step}}/2: </0> {{title}}",values:{step:j.id,title:j.text},components:[(0,d.jsx)("strong",{},0)]})})]}),(0,d.jsxs)("div",{className:"timeline-item",children:[(0,d.jsx)(ce,{is_active:j.id<=2}),(0,d.jsx)(ce,{is_active:2===j.id})]})]}),(0,d.jsx)(m.Form,{noValidate:!0,className:"account-form account-form_poa",onSubmit:f,children:(0,d.jsxs)(U,{scroll_offset:t(_),children:[((null==_?void 0:_.msg)||i)&&(0,d.jsx)(o.InlineMessage,{type:"error",message:(0,d.jsxs)(o.Text,{as:"p",size:"xxxs",children:[!(null!=_&&_.msg)&&i&&(0,d.jsx)(O.Localize,{i18n_default_text:"We were unable to verify your address with the details you provided. Please check and resubmit or choose a different document type."}),null==_?void 0:_.msg]}),className:"poa-error-banner",id:"dt_poa_submit-error"}),1===j.id&&(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(ne.A,{is_qualified_for_poa:!0,editable_fields:k,states_list:P}),(0,d.jsx)(B,{className:"account-form__footer-poa",children:(0,d.jsx)(o.Button,{className:"account-form__footer-btn",type:"button",has_effect:!0,text:u("Next"),primary:!0,is_disabled:I,onClick:()=>S((e=>ae(ae({},e),{},{id:2,text:u(" Document submission")})))})})]}),2===j.id&&(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(F,{onFileDrop:e=>{l(e)},onError:v,files_description:(0,d.jsx)(R,{title:A.title,descriptions:A.descriptions}),examples:(0,d.jsx)(ie,{}),country_of_residence:null==z?void 0:z.country_code,placeholder:u("Type of document")}),(0,d.jsx)(B,{className:"account-form__footer-poa",children:(0,d.jsx)(o.Button,{className:"account-form__footer-btn",type:"submit",has_effect:!0,text:u("Submit"),primary:!0,is_disabled:p||!b||a&&a.length<1||!!g,is_loading:r.is_btn_loading,is_submit_success:r.is_submit_success})})]})]})})]})}));function ue(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function _e(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(i),!0).forEach((function(t){me(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ue(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function me(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const fe=(0,r.observer)((e=>{let{is_resubmit:t,is_for_cfd_modal:i,onSubmit:r,onSubmitForCFDModal:l,className:c}=e;const{isMobile:u,isDesktop:_}=(0,f.Y)(),{client:x,notifications:h}=(0,s.A)(),{account_settings:y,fetchResidenceList:w,fetchStatesList:S,states_list:P}=x,{addNotificationMessageByKey:z,removeNotificationMessage:N,removeNotificationByKey:D}=h,[k,A]=n.useState([]),[T,E]=n.useState(!0),[C,L]=n.useState({address_line_1:"",address_line_2:"",address_city:"",address_state:"",address_postcode:""}),[F,R]=n.useState(null),[M,U]=n.useState({is_btn_loading:!1,is_submit_success:!1,should_allow_submit:!0,should_show_form:!0}),[V,B]=n.useState(!1),{upload:Y}=(0,p.A)(),{localize:q}=(0,O.useTranslations)();n.useEffect((()=>{null==w||w().then((async()=>{Promise.all([S(),a.WS.wait("get_settings")]).then((()=>{var e,t,i,n,o;L({address_line_1:null!==(e=y.address_line_1)&&void 0!==e?e:"",address_line_2:null!==(t=y.address_line_2)&&void 0!==t?t:"",address_city:null!==(i=y.address_city)&&void 0!==i?i:"",address_state:null!==(n=y.address_state)&&void 0!==n?n:"",address_postcode:null!==(o=y.address_postcode)&&void 0!==o?o:""}),E(!1)}))}))}),[y,w,S]),n.useEffect((()=>{if(V){var e;const t=document.querySelector("#dt_poa_submit-error"),i=null!==(e=null==t?void 0:t.parentElement)&&void 0!==e?e:t;"function"==typeof(null==i?void 0:i.scrollIntoView)&&(null==i||i.scrollIntoView({behavior:"smooth",block:"start"})),B(!1)}}),[V]);const $=e=>{U(_e(_e({},M),{should_show_form:e}))},{address_line_1:W,address_line_2:H,address_city:G,address_state:J,address_postcode:Z}=C,K={address_line_1:W,address_line_2:H,address_city:G,address_state:J,address_postcode:Z,document_type:""};if(F)return(0,d.jsx)(b,{error_message:F});if(T)return(0,d.jsx)(o.Loading,{is_fullscreen:!1,className:"account__initial-loader"});if(K.address_state){const e=(0,a.getLocation)(P,K.address_state,"text");K.address_state=P.length&&e?e:K.address_state}else K.address_state="";const Q=e=>{const t=null!=e&&e.msg?"200px":"166px";return _||i?"94px":t};return(0,d.jsx)(m.Formik,{initialValues:K,onSubmit:async(e,t)=>{let{setStatus:n,setSubmitting:o}=t;n({msg:""}),U(_e(_e({},M),{is_btn_loading:!0}));const s=_e({},e);e.address_state&&P.length&&(s.address_state=(0,a.getLocation)(P,e.address_state,"value")||""),null==s||delete s.document_type;const c=await a.WS.setSettings(s);if(c.error)return n({msg:c.error.message}),U(_e(_e({},M),{is_btn_loading:!1})),o(!1),void B(!0);const d=await a.WS.authorized.storage.getSettings();if(d.error)return R(d.error.message),void o(!1);const u=d.get_settings,{address_line_1:_,address_line_2:m,address_city:f,address_state:p,address_postcode:b}=u;L({address_line_1:_,address_line_2:m,address_city:f,address_state:p,address_postcode:b});try{const t=I().find((t=>t.text===e.document_type)),s=await Y(k,{document_type:null==t?void 0:t.value});if(null!=s&&s.warning)return U(_e(_e({},M),{is_btn_loading:!1})),void(s.warning===j.DUPLICATE_DOCUMENT?i?null==l||l(e,!0):null==r||r(!1,!0):(n({msg:null==s?void 0:s.message}),B(!0)));const c=await a.WS.authorized.getAccountStatus();if(!c||c.error)return R(c.error.message),void o(!1);const d=c.get_account_status;U(_e(_e({},M),{is_submit_success:!0,is_btn_loading:!1}));const{needs_verification:u}=d.authentication,_=Boolean(u.length)&&u.includes("identity");null==r||r(_),["authenticate","needs_poa","poa_expired"].forEach((e=>{N({key:e}),D({key:e})})),_&&z("needs_poi")}catch(e){(0,v.GQ)(e)&&(n({msg:e.message}),o(!1),U(_e(_e({},M),{is_btn_loading:!1})),B(!0))}i&&(null==l||l(e))},validate:e=>{U(_e(_e({},M),{should_allow_submit:!1}));const t={};(0,v.tf)(t,e)((e=>e),["address_line_1","address_city"],q("This field is required"));const i=(0,a.validAddress)(e.address_line_1,{is_required:!0});i.is_ok||(t.address_line_1=i.message);const n=(0,a.validAddress)(e.address_line_2);n.is_ok||(t.address_line_2=n.message);const o=q("Only letters, space, hyphen, period, and apostrophe are allowed.");return e.address_city&&!(0,a.validLetterSymbol)(e.address_city)&&(t.address_city=o),e.address_state&&!(0,a.validAddressState)(e.address_state)&&(null==P?void 0:P.length)<1&&(t.address_state=o),e.address_postcode&&((0,a.validLength)(e.address_postcode,{min:0,max:20})?(0,a.validPostCode)(e.address_postcode)||(t.address_postcode=q("Only letters, numbers, space, and hyphen are allowed.")):t.address_postcode=q("Please enter a {{field_name}} under {{max_number}} characters.",{field_name:q("Postal/ZIP code"),max_number:20,interpolation:{escapeValue:!1}})),e.document_type||(t.document_type=q("Document type is required.")),t},enableReinitialize:!0,validateOnMount:!0,children:()=>(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(g,{onDirty:_?void 0:$}),M.should_show_form&&(u?(0,d.jsx)(de,{setOffset:Q,is_for_cfd_modal:i,is_resubmit:t,setDocumentFiles:A,document_files:k,form_state:M}):(0,d.jsx)(oe,{className:c,setOffset:Q,is_for_cfd_modal:i,is_resubmit:t,setDocumentFiles:A,document_files:k,form_state:M}))]})})})),pe=e=>{let{button_label:t,className:i,route:n}=e;return(0,d.jsx)(o.ButtonLink,{className:(0,w.A)("account-management__button",i),to:n,children:(0,d.jsx)(o.Text,{className:"dc-btn__text",as:"p",weight:"bold","data-testid":"route_btn_text",children:t})})},be=e=>{let{needs_poi:t,redirect_button:i}=e;const n=(0,l.localize)("Review in progress"),r=(0,a.isNavigationFromP2P)()||(0,a.isNavigationFromDerivGO)();return t?(0,d.jsx)("div",{className:"account-management__container",children:(0,d.jsxs)(c.A,{message:n,icon:(0,d.jsx)(o.Icon,{icon:"IcPoaVerified",size:128}),children:[(0,d.jsxs)("div",{className:"account-management__text-container",children:[(0,d.jsx)(o.Text,{align:"center",size:"xs",as:"p",children:(0,l.localize)("Your proof of address is under review. We’ll get back to you in 1–3 working days.")}),(0,d.jsx)(o.Text,{align:"center",size:"xs",as:"p",children:(0,l.localize)("To start trading, you also need to verify your identity.")})]}),(0,d.jsx)(pe,{button_label:(0,l.localize)("Next"),route:a.routes.proof_of_identity})]})}):(0,d.jsx)("div",{className:"account-management__container",children:(0,d.jsx)(c.A,{message:n,text:(0,l.localize)("Your proof of address is under review. We’ll get back to you in 1–3 working days."),icon:(0,d.jsx)(o.Icon,{icon:"IcPoaVerified",size:128}),children:i||!r&&(0,d.jsx)(pe,{button_label:(0,l.localize)("Return to Trader's Hub"),route:a.routes.traders_hub})})})},xe=e=>{let{title:t,description:i,button_text:n,onClick:r}=e;return(0,d.jsx)(c.A,{message:null!=t?t:(0,l.localize)("We could not verify your proof of address"),text:null!=i?i:(0,l.localize)("Please check your email for details."),icon:(0,d.jsx)(o.Icon,{icon:"IcPoaError",size:128}),children:(0,d.jsx)(o.Button,{onClick:r,has_effect:!0,primary:!0,children:(0,d.jsx)(o.Text,{className:"dc-btn__text",size:"xs",weight:"bold",as:"p",children:null!=n?n:(0,l.localize)("Resubmit")})})})};var he=i(119180);const ye=e=>{let{className:t}=e;return(0,d.jsx)(o.ButtonLink,{className:(0,w.A)("account-management__button",t),to:he.routes.trade,children:(0,d.jsx)(o.Text,{className:"dc-btn__text",as:"p",weight:"bold","data-testid":"continue_btn_text",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Continue trading"})})})},ge=()=>(0,d.jsx)(o.ButtonLink,{className:"account-management__button",to:"/account/proof-of-identity",children:(0,d.jsx)(o.Text,{className:"dc-btn__text",weight:"bold",as:"p",children:(0,l.localize)("Proof of identity")})}),ve=e=>{let{needs_poi:t,redirect_button:i}=e;const n=(0,l.localize)("Your proof of address is verified"),r=(0,a.isNavigationFromP2P)()||(0,a.isNavigationFromDerivGO)();return t?(0,d.jsx)("div",{className:"account-management__container",children:(0,d.jsx)(c.A,{message:n,text:(0,l.localize)("To continue trading, you must also submit a proof of identity."),icon:(0,d.jsx)(o.Icon,{icon:"IcPoaVerified",size:128}),children:(0,d.jsx)(ge,{})})}):(0,d.jsx)("div",{className:"account-management__container",children:(0,d.jsx)(c.A,{message:n,icon:(0,d.jsx)(o.Icon,{icon:"IcPoaVerified",size:128}),children:i||!r&&(0,d.jsx)(ye,{})})})},je=ve,Oe=e=>{if(!e||!e.authentication)return{};const{attempts:t,document:i,identity:n,income:o,needs_verification:r}=e.authentication,s=n.status,a=i.status,l=o.status,c=e.status.some((e=>"allow_document_upload"===e)),d=e.status.some((e=>"allow_poi_resubmission"===e)),u=e.status.some((e=>"allow_poa_resubmission"===e)),_=e.status.some((e=>"allow_poinc_resubmission"===e)),m=e.status.some((e=>"age_verification"===e)),f=e.status.some((e=>"authenticated"===e)),p=e.status.some((e=>"idv_disallowed"===e)),b=e.status.some((e=>"poa_address_mismatch"===e)),x=e.status.some((e=>"poi_expiring_soon"===e)),h=e.status.some((e=>"poa_authenticated_with_idv"===e)),y=e.status.some((e=>"poa_authenticated_with_idv_photo"===e)),g=e.status.some((e=>"poa_expiring_soon"===e)),v=["pending","verified"].includes(s),j=!(i&&"none"===i.status),O=!(n&&"none"===n.status),w=!(o&&"none"===o.status),S="pending"===a&&!u,P=!(S||"verified"===a)||r.length&&r.includes("document"),z=!v||Boolean(r.length)&&r.includes("identity"),N=r.length&&r.includes("income"),{idv:D,onfido:k,manual:A}=n.services,T=t.latest;return{allow_document_upload:c,allow_poa_resubmission:u,allow_poi_resubmission:d,allow_poinc_resubmission:_,has_attempted_idv:Boolean(t.history.length&&t.history.find((e=>"idv"===e.service))),has_poa:j,has_poi:O,has_poinc:w,has_submitted_poa:S,identity_last_attempt:T,identity_status:s,document_status:a,income_status:l,idv:D,is_age_verified:m,is_fully_authenticated:f,is_idv_disallowed:p,manual:A,needs_poa:P,needs_poi:z,needs_poinc:N,needs_verification:r,onfido:k,poa_address_mismatch:b,poa_authenticated_with_idv:h,poa_authenticated_with_idv_photo:y,poi_expiring_soon:x,poa_expiring_soon:g}};function we(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Se(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?we(Object(i),!0).forEach((function(t){Pe(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):we(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Pe(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const ze=(0,r.observer)((e=>{var t;let{onSubmit:i}=e;const[r,c]=n.useState(!0),[m,f]=n.useState({allow_document_upload:!1,allow_poi_resubmission:!1,allow_poa_resubmission:!1,needs_poi:!1,needs_poa:!1,has_poi:!1,resubmit_poa:!1,has_submitted_poa:!1,document_status:void 0,is_age_verified:!1,poa_address_mismatch:!1,poa_expiring_soon:!1,poa_authenticated_with_idv:!1,poa_authenticated_with_idv_photo:!1,has_submitted_duplicate_poa:!1}),{client:p,notifications:b,common:x,ui:h}=(0,s.A)(),{app_routing_history:y}=x,{has_restricted_mt5_account:g,is_switching:v}=p,{is_verification_modal_visible:j}=h,{refreshNotifications:O}=b,w=localStorage.getItem("mt5_poa_status");n.useEffect((()=>{v||a.WS.authorized.getAccountStatus().then((e=>{const{get_account_status:t}=e;if(t){const{allow_document_upload:e,allow_poa_resubmission:i,document_status:n,has_submitted_poa:o,is_age_verified:r,needs_poa:s,needs_poi:a,poa_address_mismatch:l,poa_authenticated_with_idv:d,poa_authenticated_with_idv_photo:u,poa_expiring_soon:_}=Oe(t);f((t=>Se(Se({},t),{},{allow_document_upload:e,allow_poa_resubmission:i,document_status:n,has_submitted_poa:o,is_age_verified:r,needs_poa:s,needs_poi:a,poa_address_mismatch:l,poa_authenticated_with_idv:d,poa_authenticated_with_idv_photo:u,poa_expiring_soon:_}))),c(!1),O()}}))}),[v,O]),n.useEffect((()=>()=>{localStorage.removeItem("mt5_poa_status")}),[]);const S=()=>{f((e=>Se(Se({},e),{resubmit_poa:!0})))},P=(e,t)=>{f((i=>Se(Se({},i),{has_submitted_poa:!0,needs_poi:e,poa_expiring_soon:!1,has_submitted_duplicate_poa:null!=t&&t}))),j&&(null==i||i())},{allow_document_upload:z,allow_poa_resubmission:N,document_status:D,needs_poi:k,resubmit_poa:A,has_submitted_poa:T,poa_address_mismatch:I,poa_expiring_soon:E,poa_authenticated_with_idv:C,poa_authenticated_with_idv_photo:L,has_submitted_duplicate_poa:F}=m,R=(0,a.getPlatformRedirect)(y),M=Object.keys(a.platforms).includes(null!==(t=null==R?void 0:R.ref)&&void 0!==t?t:""),U=A||N||g&&D&&["expired","rejected","suspected"].includes(D)||I||E||(C||L)&&(null==R?void 0:R.route)===a.routes.cashier_p2p,V=M&&(0,d.jsx)(o.Button,{primary:!0,className:"proof-of-identity__redirect",onClick:()=>{var e;const t=null===(e=a.platforms[R.ref])||void 0===e?void 0:e.url;t&&(window.location.href=t,window.sessionStorage.removeItem("config.platform"))},children:(0,d.jsx)(l.Localize,{i18n_default_text:"Back to {{platform_name}}",values:{platform_name:R.name}})});if(r)return(0,d.jsx)(o.Loading,{is_fullscreen:!1,className:"account__initial-loader"});if(!z)return(0,d.jsx)(_,{});if(F)return(0,d.jsx)(xe,{title:(0,d.jsx)(l.Localize,{i18n_default_text:"Proof of address documents upload failed"}),description:(0,d.jsx)(l.Localize,{i18n_default_text:"It seems you’ve submitted this document before. Upload a new document."}),button_text:(0,d.jsx)(l.Localize,{i18n_default_text:"Try again"}),onClick:()=>{f((e=>Se(Se({},e),{resubmit_poa:!0,has_submitted_duplicate_poa:!1,has_submitted_poa:!1})))}});if(T&&!I)return(0,d.jsx)(be,{needs_poi:k,redirect_button:V});if(U)return(0,d.jsx)(fe,{is_resubmit:!E,onSubmit:P});const B=e=>{switch(e){case a.AUTH_STATUS_CODES.NONE:return(0,d.jsx)(fe,{onSubmit:P});case a.AUTH_STATUS_CODES.PENDING:return(0,d.jsx)(be,{needs_poi:k,redirect_button:V});case a.AUTH_STATUS_CODES.VERIFIED:return(0,d.jsx)(je,{needs_poi:k,redirect_button:V});case a.AUTH_STATUS_CODES.EXPIRED:return(0,d.jsx)(u,{onClick:S});case a.AUTH_STATUS_CODES.REJECTED:case a.AUTH_STATUS_CODES.SUSPECTED:return(0,d.jsx)(xe,{onClick:S});default:return null}};return w?B(w):D?B(D):null})),Ne={none:"none",pending:"pending",rejected:"rejected",verified:"verified",expired:"expired",suspected:"suspected"},De="selecting",ke="submitting",Ae="complete",Te="idv",Ie="onfido",Ee="manual",Ce=(0,r.observer)((e=>{let{has_button:t,icon:i,message:n}=e;const{client:r,ui:a}=(0,s.A)(),{isDesktop:c}=(0,f.Y)(),{has_any_real_account:u}=r,{toggleAccountsDialog:_,toggleShouldShowRealAccountsList:m}=a;return(0,d.jsxs)("div",{className:"da-icon-with-message",children:[(0,d.jsx)(o.Icon,{icon:i,size:128}),(0,d.jsx)(o.Text,{className:"da-icon-with-message__text",as:"p",color:"general",size:c?"s":"xs",line_height:"m",weight:"bold",children:n}),t&&(0,d.jsx)(o.Button,{primary:!0,onClick:()=>{m(!0),_()},className:"account__demo-message-button","data-testid":"icon-with-message-button",children:u?(0,l.localize)("Switch to real account"):(0,l.localize)("Add a real account")})]})})),Le=e=>{let{has_button:t}=e;const{localize:i}=(0,O.useTranslations)();return(0,d.jsx)(Ce,{icon:"IcPoaLock",message:i("This feature is not available for demo accounts."),has_button:t})};var Fe=i(983211),Re=i(610447),Me=i(160756);const Ue=/deriv\.(com)/.test(window.location.hostname)||/localhost:8443/.test(window.location.host),Ve=e=>{let{header:t,message:i,code:r,redirect_label:s,redirectOnClick:l,should_show_refresh:c=!0}=e;const{isTmbEnabled:u}=(0,Me.A)(),[_,m]=(0,n.useState)(!1);(0,n.useEffect)((()=>{(async()=>{const e=await u();m(e)})()}),[u]);const f=c?(0,d.jsx)(O.Localize,{i18n_default_text:"Please refresh this page to continue."}):"";if("InvalidToken"===r&&"true"===Re.A.get("logged_state")&&Ue&&!_){try{(0,Fe.ZF)({redirectCallbackUri:`${window.location.origin}/callback`}).catch((e=>{console.error(e)}))}catch(e){console.error(e)}return null}return(0,d.jsx)(o.PageError,{header:t||(0,d.jsx)(O.Localize,{i18n_default_text:"Oops, something went wrong."}),messages:i?[i,f]:[(0,d.jsx)(O.Localize,{i18n_default_text:"Sorry, an error occurred while processing your request."},0),f],redirect_urls:[a.routes.trade],redirect_labels:[null!=s?s:(0,d.jsx)(O.Localize,{i18n_default_text:"Refresh"})],buttonOnClick:null!=l?l:()=>location.reload()})},Be=e=>{let{handleRequireSubmission:t,is_from_external:i,redirect_button:n}=e;return(0,d.jsxs)(c.A,{message:(0,l.localize)("New proof of identity document needed"),icon:(0,d.jsx)(o.Icon,{icon:"IcPoiUpload",size:128}),children:[(0,d.jsx)(o.Button,{type:"button",className:"account-management__continue",onClick:t,large:!0,text:(0,l.localize)("Upload Document"),primary:!0}),!i&&n]})};var Ye=i(138150);const qe=e=>{let{handleRequireSubmission:t}=e;const{setSubmissionStatus:i}=n.useContext(a.POIContext);return(0,d.jsxs)("div",{className:"proof-of-identity__container",children:[(0,d.jsx)(Ye.A,{className:"icon"}),(0,d.jsx)(o.Text,{className:"proof-of-identity__text btm-spacer",align:"center",weight:"bold",children:(0,l.localize)("ID verification failed")}),(0,d.jsxs)(o.Text,{className:"proof-of-identity__text btm-spacer",align:"center",size:"xs",children:[(0,l.localize)("We were unable to verify your ID with the details you provided. "),(0,l.localize)("Please upload your identity document.")]}),(0,d.jsx)(o.Button,{type:"button",className:"account-management__continue",onClick:()=>{t(),i(De)},large:!0,text:(0,l.localize)("Upload identity document"),primary:!0})]})};var $e=i(794216);const We=(0,d.jsx)(l.Localize,{i18n_default_text:"Submit proof of address"}),He=e=>{let{custom_text:t=We,class_name:i}=e;return(0,d.jsx)(o.ButtonLink,{className:(0,w.A)("account-management__button",i),to:a.routes.proof_of_address,children:(0,d.jsx)(o.Text,{className:"dc-btn__text",as:"p",weight:"bold","data-testid":"poa_button_text",children:t})})},Ge=He,Je=(0,r.observer)((e=>{let{is_from_external:t,mismatch_status:i,needs_poa:r,redirect_button:c}=e;const{client:u}=(0,s.A)(),{is_already_attempted:_}=u,m=i===a.IDV_ERROR_STATUS.NameDobMismatch.code||i===a.IDV_ERROR_STATUS.DobMismatch.code||i===a.IDV_ERROR_STATUS.NameMismatch.code,f=i===a.IDV_ERROR_STATUS.Expired.code||i===a.IDV_ERROR_STATUS.Failed.code,p=!t&&(0,d.jsx)(Ge,{custom_text:(0,d.jsx)(l.Localize,{i18n_default_text:"Next"})});return(0,d.jsxs)("div",{className:(0,w.A)("proof-of-identity__container","proof-of-identity__container--status"),children:[(0,d.jsx)($e.A,{className:"icon"}),(0,d.jsx)(o.Text,{className:"proof-of-identity__text btm-spacer",align:"center",weight:"bold",children:(()=>{if(_){if(m)return(0,d.jsx)(l.Localize,{i18n_default_text:"Your profile is updated"});if(f)return(0,d.jsx)(l.Localize,{i18n_default_text:"Your document has been submitted"})}return(0,d.jsx)(l.Localize,{i18n_default_text:"Review in progress"})})()}),(0,d.jsx)(o.Text,{className:"proof-of-identity__text text",size:"xs",align:"center",children:_&&(m||f)?(0,d.jsx)(l.Localize,{i18n_default_text:"We'll review your proof of identity again and will give you an update as soon as possible."}):(0,d.jsx)(l.Localize,{i18n_default_text:"Your proof of identity is under review. We’ll get back to you within 5 minutes."})}),r?(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(o.Text,{className:"text",size:"xs",align:"center",children:(0,d.jsx)(l.Localize,{i18n_default_text:"To start trading, you also need to verify your address."})}),p]}):(0,d.jsx)("div",{className:"proof-of-identity__redirection",children:c})]})})),Ze=n.memo(Je);var Ke=i(84158);const Qe=e=>{let{needs_poa:t,is_from_external:i,redirect_button:r}=e;const s=t?(0,d.jsx)(l.Localize,{i18n_default_text:"Your ID is verified. You will also need to submit proof of your address."}):(0,d.jsx)(l.Localize,{i18n_default_text:"ID verification passed"}),{isDesktop:a}=(0,f.Y)();return(0,d.jsxs)("div",{className:(0,w.A)("proof-of-identity__container","proof-of-identity__container--status"),"data-testid":"poi_idv_verified_container",children:[(0,d.jsx)(Ke.A,{className:"icon"}),(0,d.jsx)(o.Text,{className:"proof-of-identity__text btm-spacer",align:"center",weight:"bold",children:s}),t?(0,d.jsxs)(n.Fragment,{children:[a&&(0,d.jsx)(o.Text,{className:"text",size:"xs",align:"center",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Next, we'll need your proof of address."})}),!i&&(0,d.jsx)(He,{custom_text:(0,d.jsx)(l.Localize,{i18n_default_text:"Submit proof of address"})})]}):r||(0,d.jsx)(ye,{className:"continue-trade"})]})},Xe=e=>{let{handleRequireSubmission:t,idv:i,is_from_external:n,needs_poa:o,redirect_button:r}=e;const{status:s,submissions_left:l,last_rejected:c}=i;switch(s){case Ne.pending:return(0,d.jsx)(Ze,{is_from_external:n,mismatch_status:(0,a.formatIDVError)(c,s),needs_poa:o,redirect_button:r});case Ne.rejected:case Ne.suspected:case Ne.expired:return Number(l)<1?(0,d.jsx)(qe,{handleRequireSubmission:t}):null;case Ne.verified:return(0,d.jsx)(Qe,{is_from_external:n,needs_poa:o,redirect_button:r});default:return null}};var et=i(103083);const tt=()=>(0,d.jsx)(c.A,{message:(0,l.localize)("You've reached the limit for uploading your documents."),text:(0,d.jsx)(l.Localize,{i18n_default_text:"Please contact us via <0>live chat</0>.",components:[(0,d.jsx)("span",{className:"link link--orange",onClick:et.Chat.open},0)]}),icon:(0,d.jsx)(o.Icon,{icon:"IcPoiFailed",size:128})}),it=()=>(0,d.jsx)(c.A,{message:(0,l.localize)("Proof of identity verification not required"),text:(0,l.localize)("Your account does not need identity verification at this time. We will inform you if identity verification is required in the future."),icon:(0,d.jsx)(o.Icon,{icon:"IcPoiVerified",size:128})});var nt=i(114321);const ot=e=>{let{needs_poa:t,redirect_button:i,is_from_external:r,is_manual_upload:s=!1}=e;const{localize:l}=(0,O.useTranslations)(),c=l("Review in progress"),u=l(s?"Your proof of identity is under review. We’ll get back to you within 1–3 working days.":"Your proof of identity is under review. We’ll get back to you within 5 minutes.");return t?(0,d.jsxs)(nt.A,{message:c,icon:(0,d.jsx)(o.Icon,{icon:"IcPoiVerified",size:128}),children:[(0,d.jsxs)(n.Fragment,{children:[(0,d.jsxs)("div",{className:"account-management__text-container",children:[(0,d.jsx)(o.Text,{align:"center",size:"xs",as:"p",children:u}),(0,d.jsx)(o.Text,{align:"center",size:"xs",as:"p",children:l("To start trading, you also need to verify your address.")})]}),(0,d.jsx)(Ge,{custom_text:l("Next")})]}),!r&&i]}):(0,d.jsx)(nt.A,{message:c,text:u,icon:(0,d.jsx)(o.Icon,{icon:"IcPoiVerified",size:128}),children:!r&&(0,d.jsx)(pe,{button_label:l("Return to Trader's Hub"),route:a.routes.traders_hub})})},rt=ot,st=ye,at=e=>{let{needs_poa:t,redirect_button:i,is_from_external:r,service:s}=e;const a=s===Te?(0,l.localize)("ID verification passed"):(0,l.localize)("Your proof of identity is verified");return t?(0,d.jsx)(c.A,{message:a,icon:(0,d.jsx)(o.Icon,{icon:"IcPoaVerified",size:128}),className:"account-management-dashboard",text:(0,l.localize)("To continue trading, you must also submit a proof of address."),children:!r&&(0,d.jsx)(n.Fragment,{children:(0,d.jsx)(Ge,{})})}):(0,d.jsx)(c.A,{message:a,icon:(0,d.jsx)(o.Icon,{icon:"IcPoaVerified",size:128,data_testid:"dt_IcPoaVerified"}),className:"account-management-dashboard",children:!r&&(i||(0,d.jsx)(st,{}))})},lt=at,ct=e=>{let{text:t,index:i}=e;const{isDesktop:n}=(0,f.Y)(),r=n?"xs":"xxs";return(0,d.jsxs)("div",{className:"account-management__list-text-container",children:[i&&(0,d.jsxs)(o.Text,{size:r,className:"account-management__list-text",children:[(0,d.jsx)(l.Localize,{i18n_default_text:"{{index}}.",values:{index:i}})," "]}),(0,d.jsx)(o.Text,{size:r,className:"account-management__list-text",children:t})]})},dt=e=>{let{className:t,icon:i,message:n,message_list:r=[],onContinue:s}=e;const{isDesktop:c,isMobile:u}=(0,f.Y)();return(0,d.jsx)(o.ThemedScrollbars,{is_bypassed:u,children:(0,d.jsx)(o.Div100vhContainer,{className:"account-management__message-wrapper",is_disabled:c,height_offset:"110px",children:(0,d.jsxs)("div",{className:(0,w.A)("account-management__message-content",{[`${t}__message-content`]:t}),"data-testid":"dt_icon_message_list",children:[i&&(0,d.jsx)("div",{className:(0,w.A)("account-management__message-icon",{[`${t}__message-icon`]:t}),children:i}),(0,d.jsx)(o.Text,{as:"div",weight:"bold",className:(0,w.A)("account-management__message",{[`${t}__message`]:t}),size:c?"s":"xs",children:n}),r&&(0,d.jsx)("div",{className:"account-management__list-container",children:(0,d.jsxs)("div",{className:"account-management__list-message",children:[(0,d.jsx)("div",{className:"account-management__list-icon",children:(0,d.jsx)(o.Icon,{icon:"IcAlertDanger",color:"red"})}),(0,d.jsx)("section",{children:r.length<2?(0,d.jsx)(ct,{text:(0,a.getOnfidoError)(r[0])}):r.map(((e,t)=>(0,d.jsx)(ct,{text:(0,a.getOnfidoError)(r[t]),index:t+1},e)))})]})}),s&&(0,d.jsx)(o.Button,{type:"button",className:"account-management__continue",onClick:s,large:!0,primary:!0,children:(0,d.jsx)(l.Localize,{i18n_default_text:"Verify again"})})]})})})},ut=e=>{let{handleRequireSubmission:t,rejected_reasons:i}=e;return(0,d.jsx)(dt,{message:(0,l.localize)("Your proof of identity submission failed because:"),icon:(0,d.jsx)(o.Icon,{icon:"IcPoiFailed",size:128}),message_list:i,onContinue:t})},_t=e=>{let{children:t,message:i,error:n}=e;return(0,d.jsx)(c.A,{message:null!=i?i:(0,d.jsx)(l.Localize,{i18n_default_text:"Proof of identity documents upload failed"}),text:n,icon:(0,d.jsx)(o.Icon,{icon:"IcPoiFailed",size:128}),className:"account-management-dashboard",children:t})};var mt=i(649524),ft=i.n(mt);const pt=e=>(0,l.localize)("Unable to read file {{name}}",{name:e}),bt=(e,t,i)=>new Promise(((n,o)=>{e||o();const r=new(ft())({connection:t()});let s=!1;(0,a.compressImageFiles)([e]).then((e=>{(0,a.readFiles)(e,pt,i).then((e=>{e.forEach((e=>{e.message&&(s=!0,o(e))}));const t=e.length;!s&&t&&r.upload(e[0]).then(n).catch(o)})).catch((e=>console.error("error: ",e)))})).catch((e=>console.error("error: ",e)))}));var xt=i(557344),ht=i(672313),yt=i(751506),gt=i(539943);const vt=e=>{let{anchor:t,from:i,text:n}=e;const r=i?`?from=${i}`:"",s=t?`#${t}`:"";return(0,d.jsx)(o.ButtonLink,{to:`/account/personal-details${r}${s}`,children:(0,d.jsx)(o.Text,{className:"dc-btn__text",weight:"bold",as:"p",children:null!=n?n:(0,l.localize)("Go to personal details")})})},jt=e=>{let{has_invalid_postal_code:t,from:i}=e;return t?(0,d.jsx)(c.A,{message:(0,l.localize)("Your postal code is invalid"),text:(0,l.localize)("Please check and update your postal code before submitting proof of identity."),icon:(0,d.jsx)(o.Icon,{icon:"IcAccountMissingDetails",size:128}),children:(0,d.jsx)(vt,{anchor:"address_postcode",from:i,text:(0,l.localize)("Update postal code")})}):(0,d.jsx)(c.A,{message:(0,l.localize)("Your personal details are missing"),text:(0,l.localize)("Please complete your personal details before you verify your identity."),icon:(0,d.jsx)(o.Icon,{icon:"IcAccountMissingDetails",size:128}),children:(0,d.jsx)(vt,{from:i})})};var Ot=i(406941),wt=i(263610),St=i(560798);const Pt=()=>et.Chat.open(),zt=(0,d.jsx)(l.Localize,{i18n_default_text:"Sorry, an internal error occurred. Hit the above checkbox to try again."}),Nt=(0,d.jsx)(l.Localize,{i18n_default_text:"An account with these details already exists. Please make sure the details you entered are correct as only one real account is allowed per client. If this is a mistake, contact us via <0>live chat</0>.",components:[(0,d.jsx)("span",{className:"link link--orange",onClick:Pt,onKeyDown:Pt},0)]}),Dt=(0,d.jsx)(l.Localize,{i18n_default_text:"This document number was already submitted for a different account. It seems you have an account with us that doesn't need further verification. Please contact us via <0>live chat</0> if you need help.",components:[(0,d.jsx)("span",{className:"link link--orange",onClick:Pt,onKeyDown:Pt},0)]}),kt=(e,t,i,n)=>{const o=e?"identity document":(0,v.xy)(t,i);switch(n){case a.IDV_ERROR_STATUS.NameMismatch.code:return{required_fields:["first_name","last_name"],side_note_image:(0,d.jsx)(wt.A,{height:"195px",width:"285px"}),inline_note_text:(0,d.jsx)(l.Localize,{i18n_default_text:"To avoid delays, enter your <0>name</0> exactly as it appears on your {{document_name}}.",components:[(0,d.jsx)("strong",{},0)],values:{document_name:o}}),failure_message:a.IDV_ERROR_STATUS.NameMismatch.message};case a.IDV_ERROR_STATUS.DobMismatch.code:return{required_fields:["date_of_birth"],side_note_image:(0,d.jsx)(St.A,{height:"195px",width:"285px"}),inline_note_text:(0,d.jsx)(l.Localize,{i18n_default_text:"To avoid delays, enter your <0>date of birth</0> exactly as it appears on your {{document_name}}.",components:[(0,d.jsx)("strong",{},0)],values:{document_name:o}}),failure_message:a.IDV_ERROR_STATUS.DobMismatch.message};default:return{required_fields:["first_name","last_name","date_of_birth"],side_note_image:(0,d.jsx)(Ot.A,{height:"195px",width:"285px"}),inline_note_text:(0,d.jsx)(l.Localize,{i18n_default_text:"To avoid delays, enter your <0>name</0> and <0>date of birth</0> exactly as they appear on your {{document_name}}.",components:[(0,d.jsx)("strong",{},0)],values:{document_name:o}}),failure_message:(0,a.getIDVError)(n)}}};function At(){return At=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)({}).hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},At.apply(null,arguments)}function Tt(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function It(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Tt(Object(i),!0).forEach((function(t){Et(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Tt(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Et(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Ct=e=>{let{account_settings:t,getChangeableFields:i,onFormConfirm:r}=e;const{isDesktop:s}=(0,f.Y)(),[c,u]=n.useState(!0),[_,p]=n.useState(!1),[x,h]=n.useState({show_form:!0,form_initial_values:{first_name:"",last_name:"",date_of_birth:""},changeable_fields:[],api_error:""}),y=(0,d.jsx)(Ot.A,{height:"195px",width:"285px"});n.useEffect((()=>{(async()=>{try{await(null===a.WS||void 0===a.WS?void 0:a.WS.wait("get_settings"));const e=["first_name","last_name","date_of_birth"],n=(0,a.filterObjProperties)(t,e);n.date_of_birth&&(n.date_of_birth=(0,a.toMoment)(n.date_of_birth).format("YYYY-MM-DD")),h(It(It({},x),{},{changeable_fields:i(),form_initial_values:n})),u(!1)}catch(e){console.error(e)}})()}),[t]);const{api_error:g}=x,O=At({},(function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(x.form_initial_values),x.form_initial_values));return g?(0,d.jsx)(b,{error_message:g}):c?(0,d.jsx)(o.Loading,{is_fullscreen:!1,className:"account__initial-loader"}):(0,d.jsx)(m.Formik,{initialValues:O,enableReinitialize:!0,onSubmit:async(e,t)=>{let{setStatus:i,setSubmitting:n}=t;if(_)return;i({error_msg:""});const o=(0,v.Di)(e,null!=x&&x.changeable_fields?[...x.changeable_fields]:[]),s=await a.WS.setSettings(o);if(null!=s&&s.error){var l;i({error_msg:(null===(l=s.error)||void 0===l?void 0:l.code)===j.DUPLICATE_ACCOUNT?Nt:zt}),n(!1)}else{var c;const e=await a.WS.authorized.storage.getSettings();if(null!=e&&e.error)return void h(It(It({},x),{},{api_error:e.error.message}));const{first_name:t,last_name:i,date_of_birth:n}=null!==(c=null==e?void 0:e.get_settings)&&void 0!==c?c:It({},x.form_initial_values);h(It(It({},x),{},{form_initial_values:{first_name:t,last_name:i,date_of_birth:n}})),p(!0),u(!1),r&&setTimeout((()=>{r()}),500)}},validate:e=>{const t={};return(0,v.tf)(t,e)((e=>e),["first_name","last_name","date_of_birth"],(0,l.localize)("This field is required")),e.first_name&&(t.first_name=(0,v.yS)(e.first_name)),e.last_name&&(t.last_name=(0,v.yS)(e.last_name)),h(It(It({},x),{},{errors:!(0,a.isEmptyObject)((0,a.removeEmptyPropertiesFromObject)(t))})),(0,a.removeEmptyPropertiesFromObject)(t)},children:e=>{let{errors:t,handleSubmit:i,isSubmitting:n,status:r}=e;return(0,d.jsx)(m.Form,{className:"account-form__poi-confirm-example",onSubmit:i,children:(0,d.jsxs)(U,{children:[(0,d.jsx)(ne.A,{editable_fields:x.changeable_fields,is_rendered_for_onfido:!0,side_note:y,inline_note_text:(0,d.jsx)(l.Localize,{i18n_default_text:"To avoid delays, enter your <0>name</0> and <0>date of birth</0> exactly as they appear on your identity document.",components:[(0,d.jsx)("strong",{},0)]})}),(0,d.jsx)("button",{type:"submit",className:(0,w.A)("account-form__poi-confirm-example--button",{"account-form__poi-confirm-example--button__disabled":_||!(0,a.isEmptyObject)(t)}),children:(0,d.jsx)(o.Checkbox,{value:_,label:(0,d.jsx)(o.Text,{size:s?"xs":"xxs",children:(0,l.localize)("I confirm that the name and date of birth above match my chosen identity document (see below)")}),disabled:n})}),(null==r?void 0:r.error_msg)&&(0,d.jsx)("div",{className:"account-form__poi-confirm-example--status-message",children:(0,d.jsx)(o.HintBox,{icon:"IcAlertDanger",message:(0,d.jsx)(o.Text,{as:"p",size:"xxxs",children:null==r?void 0:r.error_msg}),is_danger:!0,className:"hint-box-layout"})})]})})}})},Lt=e=>{let{is_onfido_disabled:t,is_onfido_container_hidden:i,onfido_element_id:r="onfido",is_confirmed:s,data_testid:a,is_onfido_initialized:c}=e;const[u,_]=n.useState(!1),m=n.useRef(),f=n.useRef();return n.useEffect((()=>{s&&(m.current=setTimeout((()=>{_(!0)}),800),f.current=setTimeout((()=>{_(!1)}),4650))}),[s]),n.useEffect((()=>()=>{clearTimeout(m.current),clearTimeout(f.current)}),[]),(0,d.jsxs)("div",{className:"onfido-container-view_wrapper",children:[(0,d.jsx)("div",{className:(0,w.A)({"onfido-container__status-message_container":!t}),children:(0,d.jsx)(xt.A,{appear:u,in:u,timeout:{exit:350},classNames:{exit:"onfido-container__status-message--exit"},unmountOnExit:!0,children:(0,d.jsx)(o.HintBox,{className:"onfido-container__status-message",icon:"IcAlertAnnounce",message:(0,d.jsx)(o.Text,{as:"p",size:"xxxs",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Your personal details have been saved successfully."})}),is_info:!0})})}),(0,d.jsxs)("section",{children:[t&&c&&(0,d.jsx)("div",{className:"onfido-container__info-message",children:(0,d.jsx)(o.HintBox,{icon:"IcInfoBlue",message:(0,d.jsx)(o.Text,{as:"p",size:"xxxs",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Hit the checkbox above to choose your document."})}),is_info:!0})}),(0,d.jsx)("div",{"data-testid":a,id:r,className:(0,w.A)({"onfido-container__disabled":t,"onfido-container__hidden":i})})]})]})};var Ft=i(442438);const Rt=(0,r.observer)((e=>{var t;let{country_code:i,documents_supported:r,getChangeableFields:a,handleViewComplete:l,height:c,is_default_enabled:u}=e;const[_,m]=n.useState(),[p,b]=n.useState(""),[x,h]=n.useState(!0),[y,g]=n.useState(!1),[j,O]=n.useState(!1),[w,S]=n.useState(!1),{data:P}=(0,ht.A)(),{send:z,isSuccess:N}=(0,yt.A)(),{common:D}=(0,s.A)(),{current_language:k}=D,{isMobile:A}=(0,f.Y)(),T=(0,v.aZ)(i),I=(0,v.IW)(i),{service_token:E,isSuccess:C,isError:L,error:F,isLoading:R}=(0,gt.A)({service:"onfido",country:I}),M=n.useRef(),U=Array.isArray(r)?r:Object.keys(r).map((e=>r[e].display_name));let V;const B=n.useCallback((e=>{var t;null==M||null===(t=M.current)||void 0===t||t.tearDown();const i=Object.keys(e).map((t=>{var i;return null===(i=e[t])||void 0===i?void 0:i.id}));null!=i&&i.length&&z({category:"authentication",event:"poi_documents_uploaded",args:{documents:i}})}),[z]),Y=n.useCallback((async e=>{if(e)try{M.current=await window.Onfido.init({containerId:"onfido",language:{locale:(0,v.hf)(k),phrases:(0,Ft.e)(),mobilePhrases:(0,Ft.e)()},token:e,useModal:!1,useMemoryHistory:!0,onComplete:B,steps:[{type:"document",options:{documentTypes:{passport:U.some((e=>/Passport/g.test(e))),driving_licence:!!U.some((e=>/Driving Licence/g.test(e)))&&{country:T},national_identity_card:!!U.some((e=>/National Identity Card/g.test(e)))&&{country:T}},hideCountrySelection:!0}},"face"]}),O(!0)}catch(e){var t;m(null!==(t=null==e?void 0:e.message)&&void 0!==t?t:e),h(!0),M.current=void 0}finally{S(!0)}}),[B,U,T,k]),q=n.useCallback((e=>{var t,i;null===(t=document.getElementById("onfido_sdk"))||void 0===t||t.remove(),null===(i=document.getElementById("onfido_style"))||void 0===i||i.remove();const n=document.createElement("script"),o=document.createElement("link");n.id="onfido_sdk",n.src="https://assets.onfido.com/web-sdk-releases/13.8.4/onfido.min.js",o.href="https://assets.onfido.com/web-sdk-releases/13.8.4/style.css",o.rel="stylesheet",o.id="onfido_style",document.body.appendChild(n),document.body.appendChild(o),n.addEventListener("load",(()=>{Y(e)}))}),[Y]),$=(0,n.useCallback)((()=>{g(!0),h(!1)}),[]);return n.useEffect((()=>{var e,t;C&&null!=E&&null!==(e=E.onfido)&&void 0!==e&&e.token&&!w?q(null==E||null===(t=E.onfido)||void 0===t?void 0:t.token):L&&(e=>{switch(e.code){case"MissingPersonalDetails":b("all");break;case"InvalidPostalCode":b("postal_code");break;default:m(e.message)}})(F)}),[F,L,C,w,q,null==E||null===(t=E.onfido)||void 0===t?void 0:t.token]),n.useEffect((()=>{u&&h(!1)}),[u]),n.useEffect((()=>{N&&l()}),[l,N]),R||!w?V=(0,d.jsx)(o.Loading,{is_fullscreen:!1}):p?V=(0,d.jsx)(jt,{has_invalid_postal_code:"postal_code"===p,from:"proof_of_identity"}):_&&(V=(0,d.jsx)(Ve,{message:_})),(0,d.jsx)(o.ThemedScrollbars,{is_bypassed:A,height:c,children:(0,d.jsxs)("div",{className:"onfido-container",children:[V||(0,d.jsx)(xt.A,{appear:x,in:x,timeout:{exit:350},classNames:{exit:"account-form__poi-confirm-example_wrapper--exit"},unmountOnExit:!0,children:(0,d.jsx)("div",{className:"account-form__poi-confirm-example_wrapper account-form__poi-confirm-example_container",children:(0,d.jsx)(Ct,{account_settings:P,getChangeableFields:a,onFormConfirm:$})})}),(0,d.jsx)(Lt,{is_onfido_disabled:x,is_confirmed:y,is_onfido_container_hidden:!!V,is_onfido_initialized:j})]})})}));Rt.displayName="OnfidoSdkViewContainer";const Mt=Rt;function Ut(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Vt(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Ut(Object(i),!0).forEach((function(t){Bt(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Ut(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Bt(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Yt="manual-poi-details",qt="national_identity_card",$t="nimc_slip",Wt="passport",Ht="driving_licence",Gt="birth_certificate",Jt="front",Zt="back",Kt="photo",Qt={document_type:"selfie_with_id",pageType:Kt,name:"selfie_with_id",icon:"IcSelfie",info:(0,l.localize)("Upload your selfie.")},Xt={name:"expiry_date",label:(0,l.localize)("Expiry date"),type:"date",required:!0};function ei(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function ti(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ei(Object(i),!0).forEach((function(t){ii(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ei(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function ii(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const ni=e=>{let{data:t}=e;const i=(0,a.toMoment)().add(6,"months").format("YYYY-MM-DD");switch(t.type){case"text":return(0,d.jsx)(m.Field,{name:t.name,children:e=>{let{field:i,form:{errors:n,touched:r}}=e;return(0,d.jsx)(o.Input,ti(ti({},i),{},{className:`${Yt}__field`,type:"text",label:`${t.label}${t.required?"*":""}`,error:r[i.name]&&n[i.name]}))}});case"date":return(0,d.jsx)(m.Field,{name:t.name,children:e=>{let{field:n,form:{errors:r,touched:s}}=e;return(0,d.jsx)(o.DatePicker,ti(ti({},n),{},{className:`${Yt}__field`,date_format:"YYYY-MM-DD",display_format:"DD-MM-YYYY",start_date:i,min_date:i,name:t.name,label:`${t.label}${t.required?"*":""}`,error:s[n.name]&&r[n.name],readOnly:!0}))}});default:return null}};function oi(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function ri(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?oi(Object(i),!0).forEach((function(t){si(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):oi(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function si(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const ai={"file-too-large":(0,l.localize)("File size should be 8MB or less"),"file-invalid-type":(0,l.localize)("File uploaded is not supported"),"too-many-files":(0,l.localize)("Please select one file only"),GENERAL:(0,l.localize)("Sorry, an error occured. Please select another file.")},li=e=>{let{data:t,open:i}=e;const{isDesktop:n}=(0,f.Y)();return(0,d.jsxs)("div",{className:`${Yt}__uploader-details`,children:[(0,d.jsx)(o.Icon,{className:`${Yt}__uploader-icon`,icon:null==t?void 0:t.icon,size:236}),(0,d.jsx)(o.Text,{as:"p",size:"xs",color:"general",align:"center",children:null==t?void 0:t.info}),(0,d.jsx)(o.Button,{medium:!0,secondary:!0,text:n?(0,l.localize)("Drop file or click here to upload"):(0,l.localize)("Tap here to upload"),onClick:i})]})},ci=e=>{let{data:t,setFieldValue:i,value:r,has_frame:s,handleChange:a}=e;const[l,c]=n.useState("");return n.useEffect((()=>{c(null!=r&&r.file?URL.createObjectURL(null==r?void 0:r.file):"")}),[r]),(0,d.jsxs)("div",{className:`${Yt}__uploader-details ${Yt}__uploader-details--preview`,children:[(0,d.jsxs)("div",{className:(0,w.A)(`${Yt}__uploader-image`,{[`${Yt}__uploader-image--has-frame`]:s}),style:{backgroundImage:`url(${l})`},children:[s&&(0,d.jsx)(o.Icon,{icon:"IcPoiFrame",className:`${Yt}__uploader-frame`}),(!l||-1!==(null==r?void 0:r.file.type.indexOf("pdf")))&&(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(o.Icon,{icon:"IcCloudUpload",size:50}),(0,d.jsx)(o.Text,{as:"p",size:"xs",color:"general",align:"center",children:null==r?void 0:r.file.name})]}),(0,d.jsx)(o.Icon,{icon:"IcCloseCircle",className:`${Yt}__uploader-remove`,onClick:()=>{null==a||a(null,i)},size:16})]}),(0,d.jsx)(o.Text,{as:"p",size:"xs",color:"general",align:"center",children:null==t?void 0:t.info})]})},di=e=>{let{data:t,value:i,is_full:r,onChange:s,has_frame:c}=e;const{isDesktop:u}=(0,f.Y)(),[_,p]=n.useState();n.useEffect((()=>{p(i)}),[i]);const b=(e,i)=>{null==s||s(e),null==i||i(null==t?void 0:t.name,e)},x=e=>{var t;return(0,d.jsxs)("div",{className:`${Yt}__uploader-details`,children:[null==_||null===(t=_.errors)||void 0===t?void 0:t.map(((e,t)=>(0,d.jsx)(o.Text,{as:"p",size:"xs",color:"secondary",align:"center",children:e},t))),(0,d.jsx)(o.Button,{medium:!0,secondary:!0,text:u?(0,l.localize)("Drop file or click here to upload"):(0,l.localize)("Tap here to upload"),onClick:e})]})};return(0,d.jsx)(m.Field,{name:null==t?void 0:t.name,children:e=>{var n;let{form:{setFieldValue:s}}=e;return(0,d.jsx)("div",{className:(0,w.A)(`${Yt}__uploader`,{[`${Yt}__uploader--full`]:r}),children:(0,d.jsx)(o.FileDropzone,{accept:a.supported_filetypes,error_message:(0,l.localize)("Please upload supported file type."),filename_limit:32,hover_message:(0,l.localize)("Drop files here.."),max_size:a.max_document_size,message:e=>(0,d.jsx)(li,{open:e,data:t}),preview_single:_&&(0,d.jsx)(ci,{data:t,value:_,has_frame:c,setFieldValue:s,handleChange:b}),multiple:!1,onDropAccepted:e=>((e,i)=>{const n=ri({file:e[0],errors:[]},t);b(n,i)})(e,s),onDropRejected:e=>((e,i)=>{var n;const o=null===(n=e[0].errors)||void 0===n?void 0:n.map((e=>ai[e.code]?ai[e.code]:ai.GENERAL)),r=ri(ri({},e[0]),{},{errors:o},t);b(r,i)})(e,s),validation_error_message:null!=i&&null!==(n=i.errors)&&void 0!==n&&n.length?x:void 0,noClick:!0,value:_?[_]:[]})})}})},ui=e=>{const t={};return e.forEach((e=>{t[e.name]=""})),t},_i=e=>"string"==typeof e?!e.trim():!e,mi=function(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const i={};return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).forEach((t=>{const{name:n,label:o,type:r}=t,s=e[n];t.required&&_i(s)?i[n]=(0,l.localize)("{{label}} is required.",{label:o}):"text"===r&&s.length>30?i[n]=(0,l.localize)("{{label}} must be less than 30 characters.",{label:o}):"text"!==r||/^[\w\s-]{0,30}$/g.test(s)||(i[n]=(0,l.localize)("Only letters, numbers, space, underscore, and hyphen are allowed for {{label}}.",{label:o}))})),t.forEach((t=>{var n;const{name:o}=t,r=e[o];_i(r)?i[o]=(0,l.localize)("{{name}} is required.",{name:o}):null!==(n=r.errors)&&void 0!==n&&n.length&&(i[o]=r.errors[0])})),i},fi=[{icon:"IcPoiClearPhoto",text:(0,l.localize)("A clear colour photo or scanned image")},{icon:"IcPoiFileFormat",text:(0,l.localize)("JPEG, JPG, PNG, PDF, or GIF")},{icon:"IcPoiFileSize",text:(0,l.localize)("Less than 8MB")},{icon:"IcPoiDocExpiry",text:(0,l.localize)("Must be valid for at least 6 months")}],pi=e=>{let{data:t}=e;return(0,d.jsxs)("div",{className:`${Yt}__icons-item`,children:[(0,d.jsx)(o.Icon,{icon:t.icon,size:24}),(0,d.jsx)(o.Text,{as:"p",size:"xxxs",align:"center",children:t.text})]})},bi=e=>{let{initial_values:t,is_from_external:i,data:n,goToCards:r,onSubmit:s}=e;const{isDesktop:a}=(0,f.Y)(),{fields:c,documents_title:u,documents:_}=n,p=c.some((e=>e.name===Xt.name)),b=p?(0,d.jsx)(l.Localize,{i18n_default_text:"First, enter your {{label}} and the expiry date.",values:{label:null==c?void 0:c[0].label}}):(0,d.jsx)(l.Localize,{i18n_default_text:"First, enter your {{label}}.",values:{label:null==c?void 0:c[0].label}});return(0,d.jsx)("div",{className:(0,w.A)(Yt,{[`${Yt}--mobile`]:!a}),children:(0,d.jsx)(m.Formik,{initialValues:t||ui([...c||[],..._||[]]),validate:e=>mi(e,c,_),onSubmit:s,children:e=>{let{values:t,isValid:n,touched:s}=e;const f=Object.keys(s).length>0,x=Object.values(t).some(((e,t)=>{var i;return(null===e||""===e)&&(null==c||null===(i=c[t])||void 0===i?void 0:i.required)}));return(0,d.jsxs)(m.Form,{className:`${Yt}__form`,children:[(0,d.jsx)(U,{className:"form-body",scroll_offset:a?"80px":"180px",children:(0,d.jsxs)("div",{className:`${Yt}__fields-content`,children:[(0,d.jsx)(o.Text,{as:"h3",size:"s",color:"prominent",children:b}),(0,d.jsx)("div",{className:`${Yt}__fields-wrap`,children:null==c?void 0:c.map((e=>(0,d.jsx)(ni,{data:e},e.name)))}),(0,d.jsx)("div",{className:`${Yt}__divider`}),(0,d.jsx)(o.Text,{as:"h3",size:"s",color:"prominent",children:u}),(0,d.jsx)("div",{className:`${Yt}__uploaders-wrap`,children:null==_?void 0:_.map((e=>(0,d.jsx)(di,{data:e,value:t[e.name],is_full:1===_.length||i},e.name)))}),(0,d.jsx)("div",{className:`${Yt}__icons`,children:fi.map((e=>"IcPoiDocExpiry"!==e.icon||p?(0,d.jsx)(pi,{data:e},e.icon):null))})]})}),(0,d.jsx)(B,{children:(0,d.jsxs)("div",{className:`${Yt}__btns`,children:[(0,d.jsx)(o.Button,{onClick:r,secondary:!0,large:!0,text:(0,l.localize)("Back")}),(0,d.jsx)(o.Button,{type:"submit",primary:!0,large:!0,is_disabled:!n||!f&&x,text:(0,l.localize)("Next")})]})})]})}})})},xi=e=>{let{initial_values:t,goBack:i,onConfirm:n,onFileDrop:r}=e;const{isDesktop:s}=(0,f.Y)();return(0,d.jsx)("div",{className:(0,w.A)(Yt,{[`${Yt}--mobile`]:!s}),children:(0,d.jsx)(m.Formik,{initialValues:t||ui([Qt]),validate:e=>mi(e,void 0,[Qt]),onSubmit:n,children:e=>{let t,n,{values:a,isValid:c,isSubmitting:u,touched:_}=e;return _&&(t=Object.keys(_).length>0),a&&(n=Object.values(a).some((e=>null===e||""===e))),(0,d.jsxs)(m.Form,{className:`${Yt}__form`,children:[(0,d.jsx)(U,{className:"form-body",scroll_offset:s?"8rem":"18rem",children:(0,d.jsxs)("div",{className:`${Yt}__fields-content`,children:[(0,d.jsx)(o.Text,{as:"h3",size:"s",weight:"bold",color:"prominent",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Upload your selfie"})}),(0,d.jsx)("div",{className:`${Yt}__uploaders-wrap`,children:(0,d.jsx)(di,{data:Qt,value:a?a[Qt.name]:"",is_full:!0,onChange:r,has_frame:!0})}),(0,d.jsx)("div",{className:`${Yt}__notice`,children:(0,d.jsx)(o.Text,{as:"p",size:"xs",color:"general",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Before uploading, please ensure that you’re facing forward in the selfie, your face is within the frame, and your eyes are clearly visible even if you’re wearing glasses."})})})]})}),(0,d.jsx)(B,{children:(0,d.jsxs)("div",{className:`${Yt}__btns`,children:[(0,d.jsx)(o.Button,{onClick:i,secondary:!0,large:!0,text:(0,l.localize)("Back")}),(0,d.jsx)(o.Button,{type:"submit",primary:!0,large:!0,is_disabled:!c||u||!t&&n,text:(0,l.localize)("Confirm and upload")})]})})]})}})})};function hi(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function yi(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?hi(Object(i),!0).forEach((function(t){gi(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):hi(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function gi(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const vi=e=>{let{data:t,goToCards:i,onComplete:o,is_from_external:r}=e;const[s,a]=n.useState(),[l,c]=n.useState(),[u,_]=n.useState(!1);return(0,d.jsx)(n.Fragment,{children:u?(0,d.jsx)(xi,{initial_values:l,goBack:()=>_(!1),onConfirm:e=>{o(yi(yi({},s),e))},onFileDrop:e=>c({[Qt.name]:e})}):(0,d.jsx)(bi,{initial_values:s,is_from_external:r,data:t,goToCards:i,onSubmit:e=>{a(e),_(!0)}})})},ji=["document","onClickBack","root_class","country_code_key","height","handleComplete","is_onfido_supported","is_from_external","is_for_mt5","handlePOIforMT5Complete","needs_poa"];function Oi(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function wi(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Oi(Object(i),!0).forEach((function(t){Si(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Oi(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Si(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Pi={IS_UPLOADING:"IS_UPLOADING",IS_COMPLETED:"IS_COMPLETED",IS_FAILED:"IS_FAILED"},zi=e=>{let{document:t,onClickBack:i,root_class:r,country_code_key:s,height:c,handleComplete:u,is_onfido_supported:_,is_from_external:m,is_for_mt5:f,handlePOIforMT5Complete:p,needs_poa:b}=e,x=function(e,t){if(null==e)return{};var i,n,o=function(e,t){if(null==e)return{};var i={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;i[n]=e[n]}return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)i=r[n],-1===t.indexOf(i)&&{}.propertyIsEnumerable.call(e,i)&&(o[i]=e[i])}return o}(e,ji);const[h,y]=n.useState(""),[g,v]=n.useState("");let O=!1;const w=e=>{var i;y(Pi.IS_UPLOADING),(i=e,new Promise(((e,n)=>{const o=t.details.documents.map((e=>e.name)),r=Object.values(i).filter((e=>[...o,Qt.name].includes(e.name))),c=r.length;let d=0;const u=[],_=()=>{var t;const o=r[d],{file:m,document_type:f,pageType:p,lifetime_valid:b}=o,x="function"==typeof(null===(t=i.expiry_date)||void 0===t?void 0:t.format)?i.expiry_date.format("YYYY-MM-DD"):void 0;bt(m,a.WS.getSocket,{document_type:f,page_type:p,expiration_date:x,document_id:i.document_id||"",lifetime_valid:+(b&&!x),document_issuing_country:s}).then((t=>{d+=1,(null==t?void 0:t.warning)===j.DUPLICATE_DOCUMENT?y(Pi.IS_DUPLICATE_UPLOAD):null!=t&&t.warning||t.error?(O=!0,y(Pi.IS_FAILED),v(t.message||(t.error?t.error.message:(0,l.localize)("Failed"))),d<c&&_()):d<c?(u.push(t),_()):e(u)})).catch((e=>{n(e)}))};_()}))).then((()=>{O||(f?null==p||p():y(Pi.IS_COMPLETED))})).catch((e=>{y(Pi.IS_FAILED),v(e.message)}))};switch(h){case Pi.IS_UPLOADING:return(0,d.jsx)(o.Loading,{is_fullscreen:!1,is_slow_loading:!0,status:[(0,l.localize)("Uploading documents")]});case Pi.IS_COMPLETED:return(0,d.jsx)(ot,{is_from_external:!0,needs_poa:b,is_manual_upload:!0});case Pi.IS_FAILED:return(0,d.jsx)(_t,{error:g});case Pi.IS_DUPLICATE_UPLOAD:return(0,d.jsx)(_t,{error:(0,d.jsx)(l.Localize,{i18n_default_text:"It seems you’ve submitted this document before. Upload a new document."}),children:(0,d.jsx)(o.Button,{onClick:i,large:!0,primary:!0,className:"upload_error_btn",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Try Again"})})});default:return(0,d.jsx)(n.Fragment,{children:_?(0,d.jsxs)(n.Fragment,{children:[(0,d.jsxs)("div",{className:`${r}__detail-header`,onClick:i,children:[(0,d.jsx)(o.Icon,{icon:"IcArrowLeftBold"}),(0,d.jsx)(o.Text,{as:"p",size:"xs",weight:"bold",color:"prominent",className:`${r}__back-title`,children:(0,l.localize)("Back")})]}),(0,d.jsx)(Mt,wi({country_code:s,documents_supported:[t.onfido_name],height:null!=c?c:null,handleComplete:f?p:u,is_default_enabled:!0,handleViewComplete:f?p:u},x))]}):(0,d.jsx)(vi,{data:t.details,onComplete:w,goToCards:i,is_from_external:m})})}},Ni=e=>{let{onClick:t,title:i,description:n,icon:r}=e;const{isDesktop:s}=(0,f.Y)();return(0,d.jsxs)("div",{className:"manual-poi__card",onClick:t,children:[(0,d.jsx)(o.Icon,{className:"manual-poi__card-icon",icon:r,size:64}),(0,d.jsxs)("div",{className:"manual-poi__card-content",children:[(0,d.jsx)(o.Text,{as:"p",size:"xs",weight:"bold",color:"prominent",children:i}),(0,d.jsx)(o.Text,{as:"p",size:s?"xxs":"xxxs",children:n})]}),(0,d.jsx)(o.Icon,{icon:"IcChevronRight",size:s?31:23})]})};function Di(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function ki(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Ai=e=>{let{toggleDetail:t,documents:i}=e;return(0,d.jsx)(n.Fragment,{children:i.map(((e,i)=>{var n;return(0,d.jsx)(o.Card,{renderContent:()=>(0,d.jsx)(Ni,function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Di(Object(i),!0).forEach((function(t){ki(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Di(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({onClick:()=>t(i)},e.card))},null===(n=e.card)||void 0===n?void 0:n.icon)}))})},Ti=["country_code","handlePOIforMT5Complete","manual","redirect_button","needs_poa","handleBack","handleRequireSubmission","allow_poi_resubmission","handleViewComplete","onfido","is_for_mt5","is_resubmission"];function Ii(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Ei(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Ci=e=>{let{country_code:t,handlePOIforMT5Complete:i,manual:r,redirect_button:s,needs_poa:a,handleBack:c,handleRequireSubmission:u,allow_poi_resubmission:_,handleViewComplete:m,onfido:f,is_for_mt5:p,is_resubmission:b}=e,x=function(e,t){if(null==e)return{};var i,n,o=function(e,t){if(null==e)return{};var i={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;i[n]=e[n]}return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)i=r[n],-1===t.indexOf(i)&&{}.propertyIsEnumerable.call(e,i)&&(o[i]=e[i])}return o}(e,Ti);const[h,y]=n.useState(null),g=(e=>{let{country_code:t}=e;return[{onfido_name:"Passport",card:{title:(0,l.localize)("Passport"),description:(0,l.localize)("Upload the page that contains your photo."),icon:"IcPoiPassport"},details:{fields:[{name:"document_id",label:(0,l.localize)("Passport number"),type:"text",required:!0},Vt({},Xt)],documents_title:(0,l.localize)("Next, upload the page of your passport that contains your photo."),documents:[{document_type:Wt,pageType:Jt,name:"passport",icon:"IcPassport",info:(0,l.localize)("Upload the page of your passport that contains your photo.")}]}},{onfido_name:"Driving Licence",card:{title:(0,l.localize)("Driving licence"),description:(0,l.localize)("Upload the front and back of your driving licence."),icon:"IcPoiDrivingLicence"},details:{fields_title:(0,l.localize)("First, enter your driving licence number and the expiry date."),fields:[{name:"document_id",label:(0,l.localize)("Driving licence number"),type:"text",required:!0},Vt({},Xt)],documents_title:(0,l.localize)("Next, upload the front and back of your driving licence."),documents:[{document_type:Ht,pageType:Jt,name:"driving_licence_front",icon:"IcDrivingLicenceFront",info:(0,l.localize)("Upload the front of your driving licence.")},{document_type:Ht,pageType:Zt,name:"driving_licence_back",icon:"IcIdCardBack",info:(0,l.localize)("Upload the back of your driving licence.")}]}},{onfido_name:"National Identity Card",card:{title:(0,l.localize)("Identity card"),description:(0,l.localize)("Upload the front and back of your identity card."),icon:"IcPoiIdentityCard"},details:{fields_title:(0,l.localize)("First, enter your identity card number and the expiry date."),fields:[{name:"document_id",label:(0,l.localize)("Identity card number"),type:"text",required:!0},Vt({},Xt)],documents_title:(0,l.localize)("Next, upload the front and back of your identity card."),documents:[{document_type:qt,pageType:Jt,name:"identity_card_front",icon:"IcIdCardFront",info:(0,l.localize)("Upload the front of your identity card.")},{document_type:qt,pageType:Zt,name:"identity_card_back",icon:"IcIdCardBack",info:(0,l.localize)("Upload the back of your identity card.")}]}},..."ng"===t?[{card:{title:(0,l.localize)("NIMC slip and proof of age"),description:(0,l.localize)("Upload both of these documents to prove your identity."),icon:"IcPoiNimcSlip"},details:{fields:[{name:"document_id",label:(0,l.localize)("NIMC slip number"),type:"text",required:!0}],documents_title:(0,l.localize)("Next, upload both of the following documents."),documents:[{document_type:$t,lifetime_valid:!0,pageType:Jt,name:"nimc_slip",icon:"IcPoiNimcSlipHorizontal",info:(0,l.localize)("Upload your NIMC slip.")},{document_type:Gt,pageType:Kt,name:"birth_certificate_front",icon:"IcDop",info:(0,l.localize)("Upload your proof of age: birth certificate or age declaration document.")}]}}]:[]]})({country_code:t});if(r){if(r.status===Ne.pending)return(0,d.jsx)(rt,{is_manual_upload:!0,needs_poa:a,redirect_button:s});if([Ne.rejected,Ne.suspected].some((e=>e===r.status))){if(!_)return(0,d.jsx)(tt,{})}else{if(r.status===Ne.verified)return(0,d.jsx)(lt,{needs_poa:a,redirect_button:s});if(r.status===Ne.expired)return(0,d.jsx)(Be,{redirect_button:s,handleRequireSubmission:u})}}if(null!==h){const e="ng"===t&&!(e=>{let t=!1;return e.forEach((e=>{e.document_type===$t&&(t=!0)})),t})(g[null!=h?h:0].details.documents)&&f&&f.submissions_left>0;return(0,d.jsx)(zi,function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Ii(Object(i),!0).forEach((function(t){Ei(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Ii(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({is_onfido_supported:e,country_code_key:t,document:g[h],root_class:"manual-poi",onClickBack:()=>y(null),handlePOIforMT5Complete:i,handleComplete:m,is_for_mt5:p,needs_poa:a},x))}return(0,d.jsxs)("div",{className:"manual-poi",children:[(0,d.jsx)(o.Text,{as:"h2",color:"prominent",size:"xs",className:"manual-poi__title",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Please upload one of the following documents:"})}),(0,d.jsx)(Ai,{documents:g,toggleDetail:e=>y(e)}),!p&&!b&&(0,d.jsx)(B,{className:"proof-of-identity__footer",children:(0,d.jsx)(o.Button,{className:"back-btn",onClick:c,type:"button",has_effect:!0,large:!0,secondary:!0,children:(0,d.jsx)(l.Localize,{i18n_default_text:"Back"})})})]})},Li=Ci,Fi=e=>{let{handleRequireSubmission:t,is_from_external:i,needs_poa:n,onfido:o,redirect_button:r,manual:s,country_code:l,handleViewComplete:c}=e;const{status:u,submissions_left:_,last_rejected:m}=o;switch(u){case Ne.pending:return(0,d.jsx)(rt,{is_from_external:i,needs_poa:n,redirect_button:r});case Ne.rejected:case Ne.suspected:case Ne.expired:{const e=(0,a.formatOnfidoError)(u,m);return Number(_)<1?(0,d.jsx)(Li,{manual:s,is_from_external:i,country_code:l,handleViewComplete:c,onfido:o}):(0,d.jsx)(ut,{rejected_reasons:e,handleRequireSubmission:t})}case Ne.verified:return(0,d.jsx)(lt,{is_from_external:i,needs_poa:n,redirect_button:r,service:Ie});default:return null}};var Ri=i(780146);function Mi(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Ui(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Mi(Object(i),!0).forEach((function(t){Vi(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Mi(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Vi(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Bi=e=>{var t,i;let{handleSelectionNext:r,is_from_external:s,mismatch_status:c}=e;const{setSelectedCountry:u}=n.useContext(a.POIContext),{data:_,isLoading:p}=(0,Ri.A)(),{isDesktop:b}=(0,f.Y)(),x=e=>{const t=null==_?void 0:_.find((t=>t.text===e));t&&(null==u||u(t))},h=c&&null!==(t=null===(i=a.IDV_ERROR_STATUS[c])||void 0===i?void 0:i.message)&&void 0!==t?t:null;return(0,d.jsx)(m.Formik,{initialValues:{country_input:""},validate:e=>{const t={},{country_input:i}=e;return i?_.find((e=>e.text===i))||(t.country_input=(0,l.localize)("Please select a valid country of document issuance.")):t.country_input=(0,l.localize)("Please select the country of document issuance."),t},onSubmit:(e,t)=>{let{setSubmitting:i}=t;x(e.country_input),i(!1),null==r||r()},children:e=>{let{dirty:t,errors:i,handleBlur:r,handleChange:a,handleSubmit:c,isSubmitting:u,isValid:f,setFieldValue:y,touched:g,values:v}=e;return(0,d.jsxs)(n.Fragment,{children:[(0,d.jsxs)("div",{className:(0,w.A)("proof-of-identity__container proof-of-identity__country-container",{"min-height":!s}),children:[h?(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(o.Text,{align:"center",weight:"bold",size:b?"s":"xs",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Your identity verification failed because:"})}),(0,d.jsx)(o.HintBox,{className:(0,w.A)("proof-of-identity__failed-message","hint-box-layout"),icon:"IcAlertDanger",message:(0,d.jsx)(o.Text,{as:"p",size:b?"xs":"xxs",children:h}),is_danger:!0})]}):(0,d.jsx)(o.Text,{className:"proof-of-identity__header",align:"center",weight:"bold",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Proof of identity"})}),(0,d.jsx)(o.Text,{className:"proof-of-identity__country-text ",size:"xs",children:(0,d.jsx)(l.Localize,{i18n_default_text:"In which country was your document issued?"})}),(0,d.jsx)("fieldset",{className:"proof-of-identity__fieldset",children:(0,d.jsx)(m.Field,{name:"country_input",children:e=>{let{field:t}=e;return(0,d.jsx)(n.Fragment,{children:b?(0,d.jsx)(o.Autocomplete,Ui(Ui({className:(0,w.A)({"external-dropdown":s})},t),{},{data_testid:"dt_external_dropdown",name:"country_input","data-lpignore":"true",error:g.country_input&&i.country_input,autoComplete:"off",type:"text",label:(0,l.localize)("Country"),list_items:_,value:v.country_input,onBlur:e=>{r(e);const t=e.target.value;_.find((e=>e.text===t))||(y("country_input","",!0),x(""))},onChange:a,onItemSelection:e=>{let{text:t}=e;y("country_input","No results found"!==t&&t?t:"",!0),x(t)},required:!0})):(0,d.jsx)("div",{className:"proof-of-identity__dropdown-container",children:(0,d.jsx)(o.SelectNative,Ui(Ui({},t),{},{name:"country_input",error:g.country_input&&i.country_input,label:(0,l.localize)("Country"),placeholder:(0,l.localize)("Please select"),list_items:_,value:v.country_input,onChange:e=>{a(e),x(e.target.value)},use_text:!0,required:!0}))})})}})})]}),(0,d.jsx)(B,{className:(0,w.A)("proof-of-identity__footer",{"external-footer":s}),children:(0,d.jsx)(o.Button,{className:"proof-of-identity__submit-button",type:"submit",onClick:()=>c(),has_effect:!0,is_disabled:!t||u||!f||p,is_loading:!1,text:(0,l.localize)("Next"),large:!0,primary:!0})})]})}})};var Yi=i(434828);function qi(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function $i(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?qi(Object(i),!0).forEach((function(t){Wi(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):qi(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Wi(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Hi=(0,r.observer)((e=>{let{handleBack:t,handleViewComplete:i,handleSelectionNext:r,selected_country:c}=e;const{client:u}=(0,s.A)(),{account_settings:_,getChangeableFields:p}=u,{isDesktop:b}=(0,f.Y)(),x=n.useMemo((()=>(0,a.getIDVNotApplicableOption)()),[]),h=e=>e===x.id,y=(0,d.jsx)(Ot.A,{height:"195px",width:"285px"}),g=(0,a.filterObjProperties)(_,["first_name","last_name","date_of_birth"]);g.date_of_birth&&(g.date_of_birth=(0,a.toMoment)(g.date_of_birth).format("YYYY-MM-DD"));const O=p(),S=$i($i({document_type:{id:"",text:"",value:"",example_format:""},document_number:""},g),{},{confirmation_checkbox:!1});return(0,d.jsx)(m.Formik,{initialValues:$i({},S),validate:e=>{const t={},{document_type:i,document_number:n,document_additional:o}=e;if(h(i.id))return t;const r=!!i.additional;t.document_type=(0,v.k4)(i),(0,v.DY)(null==i?void 0:i.id)||(r&&(t.document_additional=(0,v.dC)(i,o)),t.document_number=(0,v.Zy)(n,i));return(0,v.tf)(t,e)((e=>e),["first_name","last_name","date_of_birth"],(0,l.localize)("This field is required")),e.first_name&&(t.first_name=(0,v.yS)(e.first_name)),e.last_name&&(t.last_name=(0,v.yS)(e.last_name)),e.confirmation_checkbox||(t.confirmation_checkbox="error"),(0,a.removeEmptyPropertiesFromObject)(t)},onSubmit:async(e,t)=>{var n;let{setSubmitting:o,setStatus:s}=t;if(h(null==e||null===(n=e.document_type)||void 0===n?void 0:n.id))return void(null==r||r(!0));o(!0);const l=(0,v.Di)(e,O),d=await a.WS.setSettings(l);if(null!=d&&d.error){var u;return s({error_message:(null===(u=d.error)||void 0===u?void 0:u.code)===j.DUPLICATE_ACCOUNT?Nt:zt}),void o(!1)}const _=await a.WS.authorized.storage.getSettings();var m,f;if(null!=_&&_.error)return s({error_message:null!==(m=null==_||null===(f=_.error)||void 0===f?void 0:f.message)&&void 0!==m?m:zt}),void o(!1);const p=$i({identity_verification_document_add:1},(0,a.formatIDVFormValues)(e,c.value)),b=await a.WS.send(p);if(null!=b&&b.error){var x,y,g;return s({error_message:(null===(x=b.error)||void 0===x?void 0:x.code)===j.CLAIMED_DOCUMENT?Dt:null!==(y=null===(g=b.error)||void 0===g?void 0:g.message)&&void 0!==y?y:zt}),void o(!1)}o(!1),i()},enableReinitialize:!0,children:e=>{var i,r,s;let{dirty:a,isSubmitting:u,isValid:_,values:f,status:p}=e;const x=h(null==f||null===(i=f.document_type)||void 0===i?void 0:i.id),g=!x&&(!a||u||!_);return(0,d.jsxs)(m.Form,{className:(0,w.A)("proof-of-identity__container proof-of-identity__container--reset",{"min-height":h(null==f||null===(r=f.document_type)||void 0===r?void 0:r.id)}),children:[(null==p?void 0:p.error_message)&&(0,d.jsx)("div",{className:"account-form__poi-confirm-example--generic-error-msg",children:(0,d.jsx)(o.HintBox,{icon:"IcAlertDanger",message:(0,d.jsx)(o.Text,{as:"p",size:"xxxs",children:p.error_message}),is_danger:!0,className:"hint-box-layout"})}),(0,d.jsxs)(U,{className:"form-body",scroll_offset:b?"80px":"180px",children:[(0,d.jsx)(Y.A,{title:(0,l.localize)("Identity verification")}),(0,d.jsx)(Yi.A,{selected_country:c,class_name:"idv-layout"}),!h(null==f||null===(s=f.document_type)||void 0===s?void 0:s.id)&&(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(Y.A,{title:(0,l.localize)("Details")}),(0,d.jsx)(ne.A,{class_name:"account-form__poi-confirm-example_container",is_rendered_for_idv:!0,editable_fields:f.confirmation_checkbox?[]:O,side_note:y,inline_note_text:(0,d.jsx)(l.Localize,{i18n_default_text:"To avoid delays, enter your <0>name</0> and <0>date of birth</0> exactly as they appear on your identity document.",components:[(0,d.jsx)("strong",{},0)]})})]})]}),(0,d.jsxs)(B,{className:"proof-of-identity__footer ",children:[b&&(0,d.jsx)(o.Button,{className:"back-btn",onClick:t,type:"button",has_effect:!0,large:!0,secondary:!0,children:(0,d.jsx)(l.Localize,{i18n_default_text:"Back"})}),(0,d.jsx)(o.Button,{className:"proof-of-identity__submit-button",type:"submit",has_effect:!0,is_disabled:g,large:!0,primary:!0,children:x?(0,d.jsx)(l.Localize,{i18n_default_text:"Next"}):(0,d.jsx)(l.Localize,{i18n_default_text:"Verify"})})]})]})}})}));function Gi(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Ji(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Gi(Object(i),!0).forEach((function(t){Zi(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Gi(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Zi(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Ki=e=>{var t,i;let{getChangeableFields:r,is_from_external:c,residence_list:u,account_settings:_,handleSubmit:p,mismatch_status:x=a.IDV_ERROR_STATUS.Failed.code,latest_status:h,selected_country:y,handleSelectionNext:g}=e;const{client:O}=(0,s.A)(),{setIsAlreadyAttempted:S}=O,{isMobile:P,isDesktop:z}=(0,f.Y)(),[N,D]=n.useState({required_fields:[],side_note_image:(0,d.jsx)(Ot.A,{height:"195px",width:"285px"}),failure_message:null,inline_note_text:null}),[k,A]=n.useState(!0),[T,I]=n.useState({api_error:"",errors:!1,form_initial_values:{},changeable_fields:[]}),E=n.useMemo((()=>![a.IDV_ERROR_STATUS.DobMismatch.code,a.IDV_ERROR_STATUS.NameMismatch.code,a.IDV_ERROR_STATUS.NameDobMismatch.code].includes(x)),[x]),C=n.useMemo((()=>{var e;return E&&!c?null!=y?y:{}:null!==(e=u.find((e=>e.value===(null==h?void 0:h.country_code))))&&void 0!==e?e:{}}),[y,E,null==h?void 0:h.country_code,u,c]),L=n.useMemo((()=>(0,a.getIDVNotApplicableOption)()),[]),F=e=>e===L.id;n.useEffect((()=>{var e;S(!0);const t=kt(E,h,C,x);D(t),(async e=>{await(null===a.WS||void 0===a.WS?void 0:a.WS.wait("get_settings"));const t=(0,a.filterObjProperties)(_,e);t.date_of_birth&&(t.date_of_birth=(0,a.toMoment)(t.date_of_birth).format("YYYY-MM-DD")),t.confirmation_checkbox=!1;let i=t;E&&(i=Ji({document_type:{id:"",text:"",value:"",example_format:"",sample_image:""},document_number:""},i)),I({form_initial_values:Ji({},i),changeable_fields:[...r()],api_error:""}),A(!1)})(null!==(e=null==t?void 0:t.required_fields)&&void 0!==e?e:[]).catch((e=>{var t;I({form_initial_values:{},changeable_fields:[],api_error:null==e||null===(t=e.error)||void 0===t?void 0:t.message})}))}),[x,_,E,r,kt,S]);if(null!=T&&T.api_error)return(0,d.jsx)(b,{error_message:T.api_error});if(k&&0===Object.keys(null!==(t=null==T?void 0:T.form_initial_values)&&void 0!==t?t:{}).length)return(0,d.jsx)(o.Loading,{is_fullscreen:!1,className:"account__initial-loader"});return(0,d.jsx)(m.Formik,{initialValues:null!==(i=null==T?void 0:T.form_initial_values)&&void 0!==i?i:{},onSubmit:async(e,t)=>{var i;let{setStatus:n,setSubmitting:o}=t;if(F(null==e||null===(i=e.document_type)||void 0===i?void 0:i.id))return void(null==g||g(!0));delete e.confirmation_checkbox,o(!0),n({error_msg:null});const{document_number:r,document_type:s}=e,l=(0,v.Di)(e,null!=T&&T.changeable_fields?[...T.changeable_fields]:[]),c=await a.WS.setSettings(l);if(c.error){var d;n({error_msg:(null===(d=c.error)||void 0===d?void 0:d.code)===j.DUPLICATE_ACCOUNT?Nt:zt}),o(!1)}else{const e=await a.WS.authorized.storage.getSettings();if(e.error)return I((t=>Ji(Ji({},t),{},{api_error:e.error.message}))),void o(!1);const t={identity_verification_document_add:1,document_number:r,document_type:null==s?void 0:s.id,issuing_country:C.value};if(!t.document_type||F(t.document_type))return o(!1),void p();const i=await a.WS.send(t);if(null!=i&&i.error){var u,_,m;return n({error_msg:(null===(u=i.error)||void 0===u?void 0:u.code)===j.CLAIMED_DOCUMENT?Dt:null!==(_=null==i||null===(m=i.error)||void 0===m?void 0:m.message)&&void 0!==_?_:zt}),void o(!1)}o(!1),p()}},validate:e=>{var t;const i={};if(E){const{document_type:t,document_number:n,document_additional:o}=e;if(F(null==t?void 0:t.id))return i;const r=!(null==t||!t.additional);i.document_type=(0,v.k4)(t),(0,v.DY)(null==t?void 0:t.id)||(r&&(i.document_additional=(0,v.dC)(t,o)),i.document_number=(0,v.Zy)(null!=n?n:"",t))}return(0,v.tf)(i,e)((e=>e),null!==(t=null==N?void 0:N.required_fields)&&void 0!==t?t:[],(0,l.localize)("This field is required")),e.first_name&&(i.first_name=(0,v.yS)(e.first_name)),e.last_name&&(i.last_name=(0,v.yS)(e.last_name)),e.confirmation_checkbox||(i.confirmation_checkbox="error"),I((e=>Ji(Ji({},e),{},{errors:!(0,a.isEmptyObject)((0,a.removeEmptyPropertiesFromObject)(i))}))),(0,a.removeEmptyPropertiesFromObject)(i)},className:"proof-of-identity__container",children:e=>{var t,i,n,r,s;let{isSubmitting:a,isValid:u,dirty:_,status:f,values:p}=e;return(0,d.jsxs)(m.Form,{className:(0,w.A)("proof-of-identity__mismatch-container",{"upload-layout":E,"min-height":F(null==p||null===(t=p.document_type)||void 0===t?void 0:t.id)}),children:[(0,d.jsxs)(U,{className:"form-body",scroll_offset:z?"80px":c?"140px":"180px",children:[(0,d.jsx)(o.Text,{size:P?"xs":"s",weight:"bold",align:"center",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Your identity verification failed because:"})}),((null==f?void 0:f.error_msg)||(null==N?void 0:N.failure_message))&&(0,d.jsx)(o.HintBox,{className:(0,w.A)("proof-of-identity__failed-message","hint-box-layout"),icon:"IcAlertDanger",message:(0,d.jsx)(o.Text,{as:"p",size:P?"xxs":"xs","data-testid":x,children:null!==(i=null==f?void 0:f.error_msg)&&void 0!==i?i:null==N?void 0:N.failure_message}),is_danger:!0}),E&&(0,d.jsxs)("div",{children:[(0,d.jsx)(o.Text,{size:"xs",align:P?"left":"center",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Let’s try again. Choose another document and enter the corresponding details."})}),(0,d.jsx)(Y.A,{title:(0,l.localize)("Identity verification")}),(0,d.jsx)(Yi.A,{selected_country:C,class_name:"idv-layout idv-resubmit"}),!F(null==p||null===(n=p.document_type)||void 0===n?void 0:n.id)&&(0,d.jsx)(Y.A,{title:(0,l.localize)("Details")})]}),!F(null==p||null===(r=p.document_type)||void 0===r?void 0:r.id)&&(0,d.jsx)(ne.A,{class_name:"account-form__poi-confirm-example_container",editable_fields:p.confirmation_checkbox?[]:null==T?void 0:T.changeable_fields,is_rendered_for_idv:!0,side_note:null==N?void 0:N.side_note_image,inline_note_text:null==N?void 0:N.inline_note_text,mismatch_status:x})]}),(0,d.jsx)(B,{className:"proof-of-identity__footer",children:(0,d.jsx)(o.Button,{className:"proof-of-identity__submit-button",type:"submit",has_effect:!0,is_disabled:!_||a||!u,text:(b=F(null==p||null===(s=p.document_type)||void 0===s?void 0:s.id),b?(0,l.localize)("Next"):E?(0,l.localize)("Verify"):(0,l.localize)("Update profile")),large:!0,primary:!0})})]});var b}})},Qi=(0,r.observer)((e=>{let{allow_poi_resubmission:t,has_require_submission:i,height:o,identity_last_attempt:r,idv:l,is_from_external:c,is_idv_disallowed:u,needs_poa:_,onfido:m,onStateChange:f,redirect_button:p,residence_list:b,should_show_mismatch_form:x}=e;const{submission_service:h,setSubmissionService:y,submission_status:g,setSubmissionStatus:v,selected_country:j,setSelectedCountry:O}=n.useContext(a.POIContext),{client:w,notifications:S}=(0,s.A)(),{account_settings:P,getChangeableFields:z,account_status:N}=w,{refreshNotifications:D}=S,k="high"===N.risk_classification,A=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(Object.keys(j).length){const{submissions_left:t}=l,{submissions_left:i}=m,n=j.identity.services.idv.is_country_supported,o=j.identity.services.onfido.is_country_supported&&"ng"!==j.value;!e&&n&&Number(t)>0&&!u?y(Te):!e&&Number(i)>0&&o?y(Ie):y(Ee),v(ke)}},T=()=>{f&&"function"==typeof f&&f(Ne.pending),v(Ae),a.WS.authorized.getAccountStatus().then((()=>{D()}))},I=()=>v(De),E=n.useCallback((e=>b.find((t=>t.value===e))),[b]),C=i||t,L=(0,a.isIDVReportNotAvailable)(l),F=(0,a.formatIDVError)(l.last_rejected,l.status,k,L),R=n.useCallback((e=>{const{service:t,country_code:i}=e;switch(O(E(i)),t){case Te:case Ie:Number(l.submissions_left)>0||Number(m.submissions_left)>0?v(De):(y(Ee),v(ke));break;case Ee:y(Ee),v(ke)}}),[E,l.submissions_left,m.submissions_left,O,y,v,u]);switch(n.useEffect((()=>{g==De&&(C&&r?R(r):F&&[a.IDV_ERROR_STATUS.DobMismatch.code,a.IDV_ERROR_STATUS.NameMismatch.code,a.IDV_ERROR_STATUS.NameDobMismatch.code].includes(F)&&l.submissions_left>0?(y(Te),v(ke)):v(De))}),[t,r,C,R,g,l,F,y,v]),g){case De:return(0,d.jsx)(Bi,{handleSelectionNext:A,is_from_external:c,mismatch_status:F});case ke:switch(h){case Te:return x?(0,d.jsx)(Ki,{account_settings:P,getChangeableFields:z,mismatch_status:F,residence_list:b,handleSubmit:T,latest_status:r,selected_country:j,handleSelectionNext:A,report_available:!(null==l||!l.report_available)}):(0,d.jsx)(Hi,{handleSelectionNext:A,handleViewComplete:T,handleBack:I,selected_country:j});case Ie:{const e=j.value,t=j.identity.services.onfido.documents_supported,i=Object.keys(t).map((e=>t[e].display_name));return(0,d.jsx)(Mt,{country_code:e,documents_supported:i,getChangeableFields:z,handleViewComplete:T,height:o})}case Ee:return(0,d.jsx)(Li,{country_code:j.value,is_from_external:c,allow_poi_resubmission:t,handleViewComplete:T,onfido:m,handleBack:I,is_resubmission:C});default:return null}case Ae:switch(h){case Te:return(0,d.jsx)(Ze,{is_from_external:c,mismatch_status:F,needs_poa:_,redirect_button:p});case Ee:return(0,d.jsx)(rt,{is_from_external:c,needs_poa:_,redirect_button:p,is_manual_upload:!0});case Ie:return(0,d.jsx)(rt,{is_from_external:c,needs_poa:_,redirect_button:p});default:return null}default:return null}})),Xi=Qi,en=(0,r.observer)((e=>{let{height:t,is_from_external:i,onStateChange:r,getChangeableFields:c,updateAccountStatus:u}=e;const _=(0,x.useHistory)(),[m,f]=n.useState(),[p,b]=n.useState(!1),[h,y]=n.useState([]),[g,v]=n.useState(!0),{client:j,common:O,notifications:w}=(0,s.A)(),{account_settings:S,account_status:P,fetchResidenceList:z,is_switching:N,is_high_risk:D,is_withdrawal_lock:k,should_allow_authentication:A,is_virtual:T}=j,{app_routing_history:I,routeBackInApp:E,is_language_changing:C}=O,{refreshNotifications:L}=w,F=(0,a.getPlatformRedirect)(I),R=Object.keys(a.platforms).includes(null==F?void 0:F.ref),M=()=>b(!0),U=(null==S?void 0:S.citizen)||(null==S?void 0:S.country_code),V=()=>{a.WS.authorized.getAccountStatus().then((()=>{L()}))},B=n.useCallback((()=>{z().then((e=>{e.error?f(e.error):y(e.residence_list)}))}),[z]);if(n.useEffect((()=>{C&&B()}),[C,B]),n.useEffect((()=>{N||(f(null),a.WS.authorized.getAccountStatus().then((e=>{if(e.error)return f(e.error),void v(!1);B(),v(!1)})))}),[B,N]),m)return(0,d.jsx)(Ve,{error_message:(null==m?void 0:m.message)||m});if(g||N||(0,a.isEmptyObject)(P)||0===h.length)return(0,d.jsx)(o.Loading,{is_fullscreen:!1});if(T)return(0,d.jsx)(Le,{});const Y=Oe(P),{identity:q,idv:$,allow_poi_resubmission:W,identity_last_attempt:H,identity_status:G,is_age_verified:J,is_idv_disallowed:Z,manual:K,needs_poa:Q,onfido:X,poi_expiring_soon:ee}=Y,te=D&&k;if(!A&&!J&&!ee)return(0,d.jsx)(it,{});const ie=R&&(0,d.jsx)(o.Button,{primary:!0,className:"proof-of-identity__redirect",onClick:()=>{const e=a.platforms[F.ref],{is_hard_redirect:t=!1,url:i=""}=null!=e?e:{};var n;t?(window.location.href=i,window.sessionStorage.removeItem("config.platform")):(n=F.route,E(_,[n]))},children:(0,d.jsx)(l.Localize,{i18n_default_text:"Back to {{platform_name}}",values:{platform_name:F.name}})}),ne=G!=Ne.verified&&$.submissions_left>0&&[Ne.rejected,Ne.suspected,Ne.expired].includes($.status);if(G===Ne.none||p||W||ne||ee)return(0,d.jsx)(Xi,{account_settings:S,allow_poi_resubmission:W,has_require_submission:p,height:null!=t?t:null,getChangeableFields:c,identity_last_attempt:H,idv:$,is_from_external:!!i,is_idv_disallowed:Z||te,manual:K,needs_poa:Q,onfido:X,onStateChange:r,redirect_button:ie,refreshNotifications:L,residence_list:h,updateAccountStatus:u,should_show_mismatch_form:ne});if(!H||G===Ne.verified&&G!==(null==q?void 0:q.services[null==H?void 0:H.service].status))switch(G){case Ne.pending:return(0,d.jsx)(rt,{is_from_external:!!i,needs_poa:Q,redirect_button:ie,is_manual_upload:"pending"===(null==K?void 0:K.status)});case Ne.verified:return(0,d.jsx)(lt,{is_from_external:!!i,needs_poa:Q,redirect_button:ie,service:null==H?void 0:H.service});case Ne.expired:return(0,d.jsx)(Be,{is_from_external:!!i,redirect_button:ie,handleRequireSubmission:M});case Ne.rejected:case Ne.suspected:return(0,d.jsx)(tt,{handleRequireSubmission:M})}switch(H.service){case Te:return(0,d.jsx)(Xe,{account_settings:S,handleRequireSubmission:M,getChangeableFields:c,idv:$,is_from_external:!!i,needs_poa:Q,redirect_button:ie,residence_list:h});case Ie:return(0,d.jsx)(Fi,{handleRequireSubmission:M,is_from_external:!!i,needs_poa:Q,onfido:X,manual:K,redirect_button:ie,country_code:U,handleViewComplete:V});case Ee:return(0,d.jsx)(Li,{manual:K,country_code:U,is_from_external:i,needs_poa:Q,redirect_button:ie,handleRequireSubmission:M,handleViewComplete:V,onfido:X});default:return null}})),tn=en,nn=(0,r.observer)((e=>{const[t,i]=n.useState(0),[r,l]=n.useState(""),c=t;let u=n.useRef(!0).current;const{client:_,notifications:m}=(0,s.A)(),{authentication_status:f,fetchStatesList:p}=_,{refreshNotifications:b}=m,x={body:tn},h={body:ze},y=[...!["pending","verified"].includes(f.identity_status)?[x]:[],...!["pending","verified"].includes(f.document_status)?[h]:[]],[g,v]=n.useState(y);n.useEffect((()=>{b()}),[g,b]),n.useEffect((()=>{p()}),[p]);const j=()=>{u=!1,e.onFinish()},O=()=>{if(!u)return;const e=[...g];v(e)},w=()=>{l(""),t+1<g.length?(O(),i(t+1)):j()},S=(P="body")?g[c][P]:g[c];var P;return(0,d.jsx)(o.Div100vhContainer,{className:"proof-of-identity",id:"verification_modal_content",is_disabled:(0,a.isDesktop)(),height_offset:"40px",children:(0,d.jsx)("div",{className:"proof-of-identity__main-container","data-testid":"dt_verification_modal_body",children:(0,d.jsx)(S,{index:c,onSubmit:w,onStateChange:()=>{O(),w()},height:"auto",onCancel:()=>{t-1>=0?(i(t-1),l("")):j()},onSave:O,form_error:r})})})})),on=(0,r.observer)((()=>{const{ui:e,client:t}=(0,s.A)(),{authentication_status:i}=t,{is_verification_modal_visible:r,setIsVerificationModalVisible:a,setIsVerificationSubmitted:c}=e,u=!["pending","verified"].includes(i.identity_status),_=!["pending","verified"].includes(i.document_status);let m;return m=u&&_?(0,l.localize)("Submit your proof of identity and address"):u&&!_?(0,l.localize)("Submit your proof of identity"):(0,l.localize)("Submit your proof of address"),(0,d.jsxs)(n.Suspense,{fallback:(0,d.jsx)(o.UILoader,{}),children:[(0,d.jsx)(o.DesktopWrapper,{children:(0,d.jsx)(o.Modal,{className:"verification-modal",is_open:r,title:m,toggleModal:()=>a(!1),height:"70rem",width:"99.6rem",exit_classname:"verification-modal--custom-exit",children:(0,d.jsx)(nn,{onFinish:()=>{a(!1),c(!0)}})})}),(0,d.jsx)(o.MobileWrapper,{children:(0,d.jsx)(o.MobileDialog,{portal_element_id:"deriv_app",title:m,wrapper_classname:"verification-modal",visible:r,onClose:()=>a(!1),children:(0,d.jsx)(nn,{onFinish:()=>{a(!1),c(!0)}})})})]})}))},205007:(e,t,i)=>{i.d(t,{A:()=>l});var n=i(649524),o=i.n(n),r=i(189137),s=i(286326);const a=e=>`Unable to read file ${e}`,l=()=>{const[e,t]=(0,s.useState)(null),i=(0,s.useMemo)((()=>new(o())({connection:r.WS.getSocket()})),[]),n=(0,s.useCallback)((async(e,n,o)=>null!=e&&e.length?new Promise(((s,l)=>{let c=!1,d=null;(async()=>{try{const t=await(0,r.compressImageFiles)(e),u=await(0,r.readFiles)(t,a,null!=n?n:{});if(u.forEach((e=>{e&&"message"in e&&(c=!0,d=e.message,l(e.message))})),c||!u.length)return null==o||o(),l(new Error(null!=d?d:"Something went wrong!"));const _=await i.upload(u[0]);s(_)}catch(e){t(e),l(e)}})()})):Promise.reject(new Error("No files selected"))),[i]);return{error:e,upload:n,uploader_instance:i}}},751506:(e,t,i)=>{i.d(t,{A:()=>l});var n=i(286326),o=i(108340);const r=["data","mutate"];function s(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function a(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const l=()=>{const e=(0,o.A)("notification_event"),{data:t,mutate:i}=e,l=function(e,t){if(null==e)return{};var i,n,o=function(e,t){if(null==e)return{};var i={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;i[n]=e[n]}return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)i=r[n],-1===t.indexOf(i)&&{}.propertyIsEnumerable.call(e,i)&&(o[i]=e[i])}return o}(e,r),c=n.useCallback((e=>i({payload:e})),[i]);return function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?s(Object(i),!0).forEach((function(t){a(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({notification_event:null==t?void 0:t.notification_event,send:c},l)}},539943:(e,t,i)=>{i.d(t,{A:()=>a});var n=i(773835);const o=["data"];function r(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function s(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const a=e=>{const t=(0,n.A)("service_token",{payload:e,options:{retry:3,enabled:Boolean(e)}}),{data:i}=t,a=function(e,t){if(null==e)return{};var i,n,o=function(e,t){if(null==e)return{};var i={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;i[n]=e[n]}return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)i=r[n],-1===t.indexOf(i)&&{}.propertyIsEnumerable.call(e,i)&&(o[i]=e[i])}return o}(t,o);return function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach((function(t){s(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({service_token:null==i?void 0:i.service_token},a)}}}]);
//# sourceMappingURL=core.verification-modal.0b232a694f3ef83c665a.js.map