"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3317],{289295:(e,t,s)=>{s.r(t),s.d(t,{default:()=>H});var i=s(286326),n=s(291218),r=s(255530),o=s.n(r),a=s(189137),c=s(679955),l=s(414646),u=s(919796),_=s(121096),d=s(766475),p=s(811361),h=s(592353),m=s(461297),g=s(647620),b=s(763782),f=s(594269),x=s(526248),A=s(788624),v=s(413568),j=s(33118),y=s(281476),w=s(699429),N=s(47699),T=s(836870);const S=(0,c.observer)((()=>{const{ui:e,client:t,modules:s}=(0,l.A)(),{disableApp:r,enableApp:o,is_mobile:c,is_mobile_language_menu_open:u,setMobileLanguageMenuOpen:_,setIsForcedToExitPnv:d}=e,{account_status:p,has_wallet:S,is_authorize:C,is_logged_in:E,is_virtual:k,logout:O,should_allow_authentication:D,should_allow_poinc_authentication:I,landing_company_shortcode:U,is_proof_of_ownership_enabled:L,is_passkey_supported:M}=t,{cashier:P}=s,{payment_agent:F}=P,{is_payment_agent_visible:z}=F,B=(0,m.A)(),{isSuccess:G}=(0,g.A)(),R=(0,b.A)(),{data:W}=(0,f.A)(),{is_p2p_enabled:V}=(0,x.A)(),{pathname:H}=(0,n.useLocation)(),$=H===a.routes.traders_hub||H.startsWith(a.routes.cashier)||H.startsWith(a.routes.account),[q,K]=i.useState(!1),[X,Y]=i.useState(!1),[J,Q]=i.useState([]),Z=i.useRef(),ee=(0,n.useHistory)(),{subscribe:te,rest:{isSubscribed:se},p2p_settings:ie}=(0,A.A)();i.useEffect((()=>{G&&!se&&C&&te()}),[G,ie,te,se,C]),i.useEffect((()=>()=>{Z.current&&(clearTimeout(Z.current),Y(!1),K(!1))}),[H]),i.useEffect((()=>((p||D)&&(()=>{const e=(0,w.A)();Q(ce(e,[a.routes.account]))})(),()=>clearTimeout(Z.current))),[p,D,S,$,c,M,V]);const ne=i.useCallback((()=>{u&&_(!1),q?(Y(!0),Z.current=setTimeout((()=>{K(!1),Y(!1)}),400)):K(!q)}),[q,u,_]),re=i.useCallback((async()=>{ne(),window.location.pathname.startsWith(a.routes.phone_verification)&&(d(!0),await new Promise((e=>setTimeout(e,0)))),ee.push(a.routes.traders_hub),await O()}),[ee,O,ne]),{oAuthLogout:oe}=(0,v.A)({handleLogout:re}),ae=i.useCallback((()=>{y.Analytics.trackEvent("ce_passkey_account_settings_form",{action:"open",form_name:"ce_passkey_account_settings_form",operating_system:(0,a.getOSNameWithUAParser)()})}),[]),ce=(e,t)=>{const s=e.flatMap((e=>e.routes||[]));return t.map((t=>e.find((e=>e.path===t))||s.find((e=>e.path===t)))).filter((e=>e))};return(0,T.jsxs)(i.Fragment,{children:[(0,T.jsx)("a",{id:"dt_mobile_drawer_toggle",onClick:ne,className:"header__mobile-drawer-toggle",children:(0,T.jsx)(h.Icon,{icon:"IcHamburger",width:"16px",height:"16px",className:"header__mobile-drawer-icon"})}),(0,T.jsx)(h.MobileDrawer,{alignment:"left",icon_class:"header__menu-toggle",is_open:q,transitionExit:X,toggle:ne,id:"dt_mobile_drawer",enableApp:o,disableApp:r,title:(0,T.jsx)("div",{children:(0,j.localize)("Account settings")}),height:"100vh",width:"295px",className:"pre-appstore",children:(0,T.jsx)(h.Div100vhContainer,{height_offset:"40px",children:(0,T.jsx)("div",{className:"header__menu-mobile-body-wrapper",children:(0,T.jsx)(i.Fragment,{children:(0,T.jsxs)(h.MobileDrawer.Body,{className:"tradershub-os-header",children:[(0,T.jsx)("div",{className:"header__menu-mobile-platform-switcher",id:"mobile_platform_switcher"}),J.map(((e,t)=>((e,t)=>{if(e.is_authenticated&&!E)return null;if(!e.routes)return(0,T.jsx)(h.MobileDrawer.Item,{children:(0,T.jsx)(N.A,{link_to:e.path,icon:e.icon_component,text:e.getTitle(),onClickLink:ne})},t);const s=e.routes.some((e=>e.subroutes)),n=!c||!M,r=e=>/passkeys/.test(e)?n:!!/languages/.test(e)&&S;return(0,T.jsxs)(i.Fragment,{children:[!s&&e.routes.map(((e,t)=>{if(!e.is_invisible&&(e.path!==a.routes.cashier_pa||z)&&(e.path!==a.routes.cashier_pa_transfer||W)&&(e.path!==a.routes.cashier_p2p||V)&&(e.path!==a.routes.cashier_onramp||R)&&(e.path!==a.routes.cashier_acc_transfer||B))return(0,T.jsx)(h.MobileDrawer.Item,{children:(0,T.jsx)(N.A,{link_to:e.path,icon:e.icon_component,text:e.getTitle(),onClickLink:ne})},t)})),s&&e.routes.map(((e,t)=>e.subroutes?(0,T.jsx)(h.MobileDrawer.SubMenuSection,{section_icon:e.icon,section_title:e.getTitle(),children:e.subroutes.map(((e,t)=>{return(0,T.jsx)(N.A,{is_disabled:(s=e.path,(/financial-assessment/.test(s)?k:/trading-assessment/.test(s)?k||"maltainvest"!==U:/proof-of-address/.test(s)||/proof-of-identity/.test(s)?!D:/proof-of-income/.test(s)?!I:!!/proof-of-ownership/.test(s)&&(k||!L))||e.is_disabled),link_to:e.path,text:e.getTitle(),onClickLink:()=>{ne(),e.path===a.routes.passkeys&&ae()},is_hidden:r(e.path)},t);var s}))},t):(0,T.jsx)(h.MobileDrawer.Item,{children:(0,T.jsx)(N.A,{link_to:e.path,icon:e.icon_component,text:e.getTitle(),onClickLink:ne})},t)))]},t)})(e,t))),E&&(0,T.jsx)(h.MobileDrawer.Item,{onClick:oe,className:"dc-mobile-drawer__item",children:(0,T.jsx)(N.A,{icon:"IcLogout",text:(0,j.localize)("Log out")})})]})})})})})]})}));S.displayName="ToggleMenuDrawerAccountsOS";const C=S;var E=s(976327),k=s(203117),O=s(652997),D=s(596176);const I=e=>{const t=(0,T.jsx)(h.Text,{weight:"bold",size:"xxxs",color:"warning"},0);switch(e){case a.ACCOUNT_BADGE_STATUS.PENDING:return{text:(0,T.jsx)(D.Localize,{i18n_default_text:"In review"}),icon:"IcMt5Pending"};case a.ACCOUNT_BADGE_STATUS.FAILED:return{text:(0,T.jsx)(D.Localize,{i18n_default_text:"Failed"}),icon:"IcMt5Failed",icon_size:"18"};case a.ACCOUNT_BADGE_STATUS.NEEDS_VERIFICATION:return{text:(0,T.jsx)(D.Localize,{i18n_default_text:"Needs Verification"}),icon:"IcMt5Verification",icon_size:"18"};case a.MT5_ACCOUNT_STATUS.UNDER_MAINTENANCE:return{text:(0,T.jsx)(D.Localize,{i18n_default_text:"<0>Server maintenance</0>",components:[t]}),icon:"IcAlertWarning"};case a.TRADING_PLATFORM_STATUS.UNAVAILABLE:return{text:(0,T.jsx)(D.Localize,{i18n_default_text:"<0>Temporarily unavailable</0>",components:[t]}),icon:"IcAlertWarning"};default:return{text:"",icon:""}}},U=["icon"];function L(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function M(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const P=e=>{let{icon:t}=e,s=function(e,t){if(null==e)return{};var s,i,n=function(e,t){if(null==e)return{};var s={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(-1!==t.indexOf(i))continue;s[i]=e[i]}return s}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)s=r[i],-1===t.indexOf(s)&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}(e,U);return(0,T.jsx)(h.Icon,function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?L(Object(s),!0).forEach((function(t){M(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):L(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({icon:`IcCurrency${(0,a.capitalizeFirstLetter)(t.toLowerCase())}`},s))};var F=s(263851),z=s(478784);const B=(0,c.observer)((e=>{let{is_visible:t}=e;const{client:s,traders_hub:i,ui:n}=(0,l.A)(),{account_list:r,accounts:c,switchAccount:u,has_any_real_account:_,account_status:d,loginid:p}=s,{closeModal:m,selected_region:g}=i,{openRealAccountSignup:b,toggleSetCurrencyModal:f}=n,x=(0,F.A)(),{text:A,icon:v}=I(x),y=(0,z.A)();let w;return(0,T.jsxs)(h.Modal,{is_open:t,toggleModal:m,width:"422px",height:"422px",children:[(0,T.jsxs)("div",{className:"currency-selection-modal__header",children:[(0,T.jsx)(h.Text,{"line-height":"m",weight:"bold",children:(0,j.localize)("Select account")}),(0,T.jsx)(h.Icon,{className:"close-icon",icon:"IcCross",onClick:()=>m()})]}),(0,T.jsx)("div",{className:"currency-selection-modal__body",children:r.filter((e=>!1==!!e.is_disabled&&(!e.is_virtual&&"Non-EU"===g&&e.loginid.startsWith("CR")||"EU"===g&&e.loginid.startsWith("MF")))).map((e=>{let{icon:t,loginid:s}=e;const{balance:i,currency:n}=c[s],r=p===s;return(0,T.jsxs)("div",{className:o()("currency-item-card",{"currency-item-card--active":r}),onClick:async()=>{s!==p&&((0,a.startPerformanceEventTimer)("switch_currency_accounts_time"),await u(s)),m()},children:[(0,T.jsx)(P,{className:"currency-item-card__icons",icon:n?t:"UNKNOWN",size:32}),(0,T.jsxs)("div",{className:"currency-item-card__details",children:[(0,T.jsx)(h.Text,{size:"xs",children:(0,a.getCurrencyName)(n)}),(0,T.jsx)(h.Text,{color:r?"prominent":"less-prominent",size:"xxs",children:s})]}),(0,T.jsx)("div",{className:"currency-item-card__balance",children:x?(0,T.jsx)(h.StatusBadge,{account_status:x,icon:v,text:A}):(0,T.jsx)(h.Text,{size:"xs",color:"prominent",children:(0,T.jsx)(h.Money,{amount:i,currency:n,show_currency:!0})})})]},s)}))}),(0,T.jsx)("div",{className:"currency-selection-modal__bottom-controls",children:(0,T.jsx)(h.Button,{className:"block-button",onClick:()=>{clearTimeout(w),w=setTimeout((()=>{_&&!y?f():b("manage")}),500),m()},secondary:!0,large:!0,children:(0,j.localize)("Add or manage account")})})]})}));var G=s(878262),R=s(674764);const W=(0,c.observer)((e=>{let{onClickDeposit:t,is_traders_hub_routes:s}=e;const{client:i,ui:n,notifications:r}=(0,l.A)(),{account_type:o,balance:a,currency:c,is_eu:u,is_logged_in:d,is_virtual:p}=i,{account_switcher_disabled_message:h,disableApp:m,enableApp:g,is_account_switcher_disabled:b,is_accounts_switcher_on:f,openRealAccountSignup:x,toggleAccountsDialog:A}=n,{is_notifications_visible:v,notifications:j,toggleNotificationsModal:y}=r,w=j.filter((e=>!e.only_toast_message));return(0,T.jsx)("div",{id:"dt_core_header_acc-info-container",className:"acc-info__container",children:(0,T.jsx)(_.Xw,{acc_switcher_disabled_message:h,account_type:o,balance:a,currency:c,disableApp:m,enableApp:g,is_acc_switcher_on:f,is_acc_switcher_disabled:b,is_eu:u,is_notifications_visible:v,is_logged_in:d,is_traders_hub_routes:s,is_virtual:p,onClickDeposit:t,notifications_count:w.length,toggleAccountsDialog:A,toggleNotifications:y,openRealAccountSignup:x})})}));var V=s(838549);const H=(0,c.observer)((()=>{const{client:e,common:t,ui:s,notifications:r,traders_hub:c}=(0,l.A)(),{currency:h,has_any_real_account:m,is_bot_allowed:g,is_dxtrade_allowed:b,is_logged_in:f,is_logging_in:x,is_single_logging_in:A,is_mt5_allowed:v,is_virtual:j,is_switching:y}=e,{app_routing_history:w,current_language:N,platform:S,is_from_tradershub_os:D}=t,{header_extension:I,is_app_disabled:U,is_route_modal_on:L,toggleReadyToDepositModal:M,is_real_acc_signup_on:P}=s,{addNotificationMessage:F,client_notifications:z,removeNotificationMessage:H}=r,{setTogglePlatformType:$,modal_data:q}=c,{isDesktop:K}=(0,u.Y)(),X=(0,n.useHistory)(),{pathname:Y}=(0,n.useLocation)(),J=[a.routes.traders_hub].includes(Y)||[a.routes.account,a.routes.settings,a.routes.wallets_compare_accounts,a.routes.compare_cfds].some((e=>Y.startsWith(e))),Q=i.useCallback((()=>H({key:"new_version_available"})),[H]);i.useEffect((()=>(document.addEventListener("IgnorePWAUpdate",Q),()=>document.removeEventListener("IgnorePWAUpdate",Q))),[Q]);const Z=e=>e.filter((e=>e.link_to===a.routes.mt5?!f||v:e.link_to===a.routes.dxtrade?b:e.link_to!==a.routes.bot&&e.href!==a.routes.smarttrader||g));return(0,T.jsxs)("header",{className:o()("header",{"header--is-disabled":U||L,"header--is-hidden":a.platforms[S]&&!D,"header--tradershub_os_mobile":f&&D&&!K,"header--tradershub_os_desktop":f&&D&&K}),children:[(0,T.jsxs)("div",{className:"header__menu-items",children:[(0,T.jsxs)("div",{className:"header__menu-left",children:[K?(0,T.jsxs)(i.Fragment,{children:[(0,T.jsx)(R.A,{}),(0,T.jsx)("div",{className:"header__divider"}),(0,T.jsx)(V.A,{})]}):(0,T.jsx)(i.Fragment,{children:D?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(C,{platform_config:Z(E.A)}),(0,T.jsx)(R.A,{})]}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(p.A,{platform_config:Z(E.A)}),(0,T.jsx)(R.A,{}),I&&f&&(0,T.jsx)("div",{className:"header__menu-left-extensions",children:I})]})}),(0,T.jsx)(_.$2,{is_traders_hub_routes:J}),K&&!J&&!location.pathname.includes(a.routes.cashier)&&(0,T.jsx)(_.ft,{app_routing_history:w,platform_config:Z(E.A),setTogglePlatformType:$,current_language:N})]}),(0,T.jsx)("div",{className:o()("header__menu-right",{"header__menu-right--hidden":!K&&x}),children:x||A||y?(0,T.jsx)("div",{id:"dt_core_header_acc-info-preloader",className:o()("acc-info__preloader",{"acc-info__preloader--no-currency":!h}),children:(0,T.jsx)(d.sk,{is_logged_in:f,is_desktop:K,speed:3,is_traders_hub_routes:J})}):!D&&(0,T.jsx)(W,{onClickDeposit:()=>{!m&&j?M():X.push(a.routes.cashier_deposit)},is_traders_hub_routes:J})})]}),P&&(0,T.jsx)(O.A,{}),(0,T.jsx)(G.A,{}),(0,T.jsx)(B,{is_visible:"currency_selection"===q.active_modal}),(0,T.jsx)(k.A,{onUpdate:()=>F(null==z?void 0:z.new_version_available)})]})}))},471879:(e,t,s)=>{s.d(t,{A:()=>o});var i=s(286326),n=s(189137),r=s(414646);const o=()=>{var e,t,s,o;const{client:a}=(0,r.A)(),{account_status:c,is_logged_in:l,updateAccountStatus:u}=a||{};(0,i.useEffect)((()=>{!async function(){!l||c&&window.location.pathname.startsWith(n.routes.trade)||await u()}()}),[]);const _=null==c?void 0:c.authentication,d=null==_||null===(e=_.identity)||void 0===e?void 0:e.status,p=null==_||null===(t=_.identity)||void 0===t||null===(t=t.services)||void 0===t||null===(t=t.onfido)||void 0===t?void 0:t.status,h=null==_||null===(s=_.identity)||void 0===s||null===(s=s.services)||void 0===s||null===(s=s.manual)||void 0===s?void 0:s.status,m=null==_||null===(o=_.document)||void 0===o?void 0:o.status,g="none",b="verified",f="pending",x=m&&["rejected","expired","suspected"].includes(m),A=m===f,v=m===g,j=[p,h].includes(b),y=[p,h].includes(f)&&!j,w=[p,h].every((e=>e===g)),N=d===b&&m===b;return{mf_account_status:m&&p&&h?!w&&(!y&&!j)||x?n.ACCOUNT_BADGE_STATUS.FAILED:w||v?n.ACCOUNT_BADGE_STATUS.NEEDS_VERIFICATION:y||A?n.ACCOUNT_BADGE_STATUS.PENDING:null:null,kyc_status:N?{}:{poi_status:d,poa_status:m,valid_tin:1,required_tin:1}}}},526248:(e,t,s)=>{s.d(t,{A:()=>l});var i=s(286326),n=s(394559),r=s.n(n),o=s(189137),a=s(414646),c=s(788624);const l=()=>{var e;const{p2p_settings:t,rest:{isLoading:s,isSubscribed:n}}=(0,c.A)(),{client:l,traders_hub:u}=(0,a.A)(),{currency:_,email:d,is_virtual:p,loginid:h,setIsP2PEnabled:m}=l,{is_low_risk_cr_eu_real:g}=u,b=Boolean(null==t||null===(e=t.supported_currencies)||void 0===e?void 0:e.includes(_.toLocaleLowerCase()))&&!p&&!g;return i.useEffect((()=>{if(m(b),d&&h){const e=/deriv\.(com|me|be)/.test(window.location.hostname)?o.deriv_urls.DERIV_HOST_NAME:window.location.hostname;r().set("is_p2p_disabled",(!b).toString(),{domain:e,secure:!0,sameSite:"none"})}}),[d,b,h,m]),{is_p2p_enabled:b,is_p2p_enabled_loading:s,is_p2p_enabled_success:n}}},263851:(e,t,s)=>{s.d(t,{A:()=>a});var i=s(189137),n=s(56752),r=s(471879),o=s(414646);const a=()=>{const{client:{is_eu:e}}=(0,o.A)(),t=(0,n.A)(),{mf_account_status:s}=(0,r.A)();return e&&t&&s&&[i.ACCOUNT_BADGE_STATUS.PENDING,i.ACCOUNT_BADGE_STATUS.FAILED,i.ACCOUNT_BADGE_STATUS.NEEDS_VERIFICATION].includes(s)?s:null}}}]);
//# sourceMappingURL=core.dtrader-header.b4f14bb9ba6db15ece45.js.map