/*! For license information please see trader.trader-app-v2.1699943f8f05fe4ee1dc.js.LICENSE.txt */
"use strict";(self.webpackChunk_deriv_trader=self.webpackChunk_deriv_trader||[]).push([["trader-app-v2"],{"./src/AppV2/Utils/contract-description-utils.tsx":(e,t,r)=>{r.d(t,{ts:()=>S,gl:()=>A,H5:()=>g,OG:()=>E});var n=r("react"),o=r.n(n),a=r("@deriv/translations"),i=r("../../node_modules/@deriv-com/quill-ui/dist/components/Typography/text/index.js"),l=r("../../node_modules/classnames/index.js"),c=r.n(l),s=r("@deriv/components"),u=r("../../node_modules/@deriv-com/ui/dist/hooks/useDevice.js"),d=r("@deriv/shared"),f=r("./src/AppV2/Utils/trade-types-utils.tsx"),m=r("../../node_modules/@lottiefiles/dotlottie-react/dist/index.js");function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return y(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?y(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const _=function(e){var t=e.contract_type,r=p(o().useState(!0),2),n=r[0],a=r[1],i=p(o().useState(null),2),l=i[0],y=i[1],_=(0,u.Y)().isMobile,v=o().useCallback((function(e){return(0,d.getUrlBase)("/public/videos/".concat(t.toLowerCase(),"_").concat(_?"mobile":"desktop",".").concat(e))}),[t,_]),h=o().useMemo((function(){return v("lottie")}),[v]);return o().useEffect((function(){var e=function(){return a(!1)};return l&&l.addEventListener("load",e),function(){l&&l.removeEventListener("load",e)}}),[l]),o().createElement("div",{className:c()("video-fragment__wrapper",{"video-fragment__wrapper--accumulator":t.toLowerCase()===f.OA.ACCUMULATORS.toLowerCase()})},n&&o().createElement(s.Skeleton,{width:248,height:161,className:"skeleton-video-loader"}),o().createElement(m.GL,{autoplay:!0,dotLottieRefCallback:function(e){return y(e)},src:h,loop:!0}))};var v=r("./src/Modules/Trading/Helpers/video-config.ts");function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function b(e,t,r){return(t=function(e){var t=function(e){if("object"!=h(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=h(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==h(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var g=function(){return{BARRIER:(0,a.localize)("Barrier"),CONTRACT_VALUE:(0,a.localize)("Contract value"),DEAL_CANCELLATION:(0,a.localize)("Deal cancellation"),ENTRY_SPOT:(0,a.localize)("Entry spot"),EXIT_SPOT:(0,a.localize)("Exit spot"),EXPIRY:(0,a.localize)("Expiry"),FINAL_PRICE:(0,a.localize)("Final price"),GROWTH_RATE:(0,a.localize)("Growth rate"),PAYOUT:(0,a.localize)("Payout"),PAYOUT_PER_POINT:(0,a.localize)("Payout per point"),PREVIOUS_SPOT_PRICE:(0,a.localize)("Previous spot price"),RANGE:(0,a.localize)("Range"),SLIPPAGE_RISK:(0,a.localize)("Slippage risk"),STOP_OUT_LEVEL:(0,a.localize)("Stop out level"),STOP_LOSS:(0,a.localize)("Stop loss"),STRIKE_PRICE:(0,a.localize)("Strike price"),TAKE_PROFIT:(0,a.localize)("Take profit")}},E=function(e){var t=e.contract_type,r=e.term;if(t&&r){var n,l,c,s,u,d,m,p,y,_,v,h,E,S,w,A,O,k,x,C=(l=g(),c=l.BARRIER,s=l.CONTRACT_VALUE,u=l.DEAL_CANCELLATION,d=l.ENTRY_SPOT,m=l.EXIT_SPOT,p=l.EXPIRY,y=l.FINAL_PRICE,_=l.GROWTH_RATE,v=l.PAYOUT,h=l.PAYOUT_PER_POINT,E=l.PREVIOUS_SPOT_PRICE,S=l.RANGE,w=l.SLIPPAGE_RISK,A=l.STOP_OUT_LEVEL,O=l.STOP_LOSS,k=l.STRIKE_PRICE,x=l.TAKE_PROFIT,b(b(b(b(b(b(b(b(b(b(n={},c,o().createElement(a.Localize,{i18n_default_text:"This is the corresponding price level based on the payout per point you’ve selected. If this barrier is ever breached, your contract would be terminated."})),s,(function(e){return e===f.OA.VANILLAS?o().createElement(a.Localize,{i18n_default_text:"We’ll offer to buy your contract at this price should you choose to sell it before its expiry. This is based on several factors, such as the current spot price, duration, etc. However, we won’t offer a contract value if the remaining duration is below 60 seconds."}):o().createElement(a.Localize,{i18n_default_text:"This is the resale value of your contract, based on the prevailing market conditions (e.g, the current spot), including additional commissions if any."})})),u,o().createElement(a.Localize,{i18n_default_text:"If you select this feature, you can cancel your trade within a chosen time frame if the asset price moves against your favour. You will get your stake back without profit/loss. We charge a small fee for this. Take profit and stop loss are disabled when deal cancellation is active."})),d,o().createElement(a.Localize,{i18n_default_text:"We use current-tick-execution mechanism, which is the latest asset price when the trade opening is processed by our servers for Volatility Index, Basket Indices, Jump Indices and Crash/Boom Indices."})),m,o().createElement(a.Localize,{i18n_default_text:"The latest asset price when the trade closure is processed by our servers."})),p,o().createElement(o().Fragment,null,o().createElement(i.E,{className:"definition__paragraph"},o().createElement(a.Localize,{i18n_default_text:"This is when your contract will expire based on the duration or end time you’ve selected. If the duration is more than 24 hours, the cut-off time and expiry date will apply instead."})),o().createElement(i.E,null,o().createElement(a.Localize,{i18n_default_text:"Cut off time:"})),o().createElement(i.E,{className:"definition__paragraph"},o().createElement(a.Localize,{i18n_default_text:"Contracts will expire at exactly 23:59:59 GMT on your selected expiry date."})),o().createElement(i.E,null,o().createElement(a.Localize,{i18n_default_text:"Expiry date:"})),o().createElement(i.E,null,o().createElement(a.Localize,{i18n_default_text:"Your contract will expire on this date (in GMT), based on the end time you’ve selected."})))),y,o().createElement(a.Localize,{i18n_default_text:"This is the spot price of the last tick at expiry."})),_,o().createElement(a.Localize,{i18n_default_text:"You can choose a growth rate with values of 1%, 2%, 3%, 4%, and 5%."})),v,(function(e){return e===f.OA.VANILLAS?o().createElement(a.Localize,{i18n_default_text:"Your payout is equal to the payout per point multiplied by the difference between the final price and the strike price."}):e===f.OA.TURBOS?o().createElement(a.Localize,{i18n_default_text:"The payout at expiry is equal to the payout per point multiplied by the distance between the final price and the barrier."}):o().createElement(a.Localize,{i18n_default_text:"Payout is the sum of your initial stake and profit."})})),h,(function(e){return e===f.OA.VANILLAS?o().createElement(a.Localize,{i18n_default_text:"We calculate this based on the strike price and duration you’ve selected."}):o().createElement(a.Localize,{i18n_default_text:"The amount you choose to receive at expiry for every point of change between the final price and the barrier. "})})),b(b(b(b(b(b(b(n,E,o().createElement(a.Localize,{i18n_default_text:"Spot price on the previous tick."})),S,o().createElement(a.Localize,{i18n_default_text:"It is a percentage of the previous spot price. The percentage rate is based on your choice of the index and the growth rate."})),w,(function(e){return e===f.OA.ACCUMULATORS?o().createElement(a.Localize,{i18n_default_text:"The spot price may change by the time your order reaches our servers. When this happens, your payout may be affected."}):o().createElement(a.Localize,{i18n_default_text:"Slippage happens when the asset price changes by the time it reaches our servers."})})),A,o().createElement(a.Localize,{i18n_default_text:"Your trade will be closed automatically at the nearest available asset price when your loss reaches a certain percentage of your stake, but your loss never exceeds your stake. This percentage depends on the chosen underlying asset and the Multiplier."})),O,o().createElement(a.Localize,{i18n_default_text:"If you select this feature, your trade will be closed automatically at the nearest available asset price when your loss reaches or exceeds the stop loss amount. Your loss may be more than the amount you entered depending on the market price at closing."})),k,o().createElement(o().Fragment,null,o().createElement(i.E,{className:"definition__paragraph"},o().createElement(a.Localize,{i18n_default_text:"You must select the strike price before entering the contract."})),o().createElement(i.E,{className:"definition__paragraph"},o().createElement(a.Localize,{i18n_default_text:"If you select “Call”, you’ll earn a payout if the final price is above the strike price at expiry. Otherwise, you won’t receive a payout."})),o().createElement(i.E,null,o().createElement(a.Localize,{i18n_default_text:"If you select ‘Put”, you’ll earn a payout if the final price is below the strike price at expiry. Otherwise, you won’t receive a payout."})))),x,o().createElement(a.Localize,{i18n_default_text:"If you select this feature, your trade will be closed automatically at the nearest available asset price when your profit reaches or exceeds the take profit amount. Your profit may be more than the amount you entered depending on the market price at closing."})))[r];return"function"==typeof C?C(t):null!=C?C:""}},S=function(e){return e.map((function(e,t){var r=e.type,n=e.text;return"heading"===r&&"string"!=typeof n?o().createElement(i.E,{key:n.props.i18n_default_text,bold:!0,size:"md",className:"description__heading"},n):"paragraph"!==r&&"general"!==r||"string"==typeof n?"video"===r&&"string"==typeof n?o().createElement(_,{contract_type:n,key:n+t}):void 0:o().createElement(i.E,{as:"p",key:n.props.i18n_default_text,size:"sm",className:"description__".concat(r),color:"quill-typography__color--default"},n)}))},w=b(b(b(b(b(b(b(b(b(b({},f.OA.ACCUMULATORS,v.fm.accumulator),f.OA.EVEN_ODD,v.fm.even_odd),f.OA.HIGHER_LOWER,v.fm.high_low),f.OA.MATCHES_DIFFERS,v.fm.match_diff),f.OA.MULTIPLIERS,v.fm.multiplier),f.OA.OVER_UNDER,v.fm.over_under),f.OA.RISE_FALL,v.fm.rise_fall),f.OA.TOUCH_NO_TOUCH,v.fm.touch),f.OA.VANILLAS,v.fm.vanilla),f.OA.TURBOS,v.fm.turbos),A=function(){var e,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return null===(e=w[arguments.length>0&&void 0!==arguments[0]?arguments[0]:""])||void 0===e?void 0:e[t?"dark":"light"]}},"./src/AppV2/index.tsx":(e,t,r)=>{r.r(t),r.d(t,{default:()=>pf});var n=r("react"),o=r.n(n),a=r("./src/App/init-store.ts"),i=r("@deriv/shared"),l=r("./src/Stores/Providers/modules-providers.tsx"),c=r("./src/trader-providers.tsx"),s=r("../stores/src/useStore.ts"),u=r("../../node_modules/lodash.debounce/index.js"),d=r.n(u),f=r("mobx");function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){_(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _(e,t,r){return(t=function(e){var t=function(e){if("object"!=m(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==m(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var v=function(e){var t=(0,i.toMoment)().startOf("day").unix();return e&&t>e?e:(0,i.epochToMoment)(t).add(1,"d").subtract(1,"s").unix()},h=function(e,t,r,n){var o=(0,i.toMoment)().startOf("day").unix();return n&&o>n?r:e&&t?t:r};const b=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return y(y({},function(e,t,r,n){var o=(0,i.toMoment)().startOf("day").unix();return n&&o>n?!!e||t:t?r||e:!!e||!1}(e,n,r,t)&&{date_from:h(n,r,e,t)}),(t||n)&&{date_to:v(t)})};function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach((function(t){w(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function w(e,t,r){return(t=function(e){var t=function(e){if("object"!=g(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=g(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==g(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function A(e){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A(e)}function O(){O=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),l=new P(n||[]);return o(i,"_invoke",{value:C(e,r,l)}),i}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",m="suspendedYield",p="executing",y="completed",_={};function v(){}function h(){}function b(){}var g={};s(g,i,(function(){return this}));var E=Object.getPrototypeOf,S=E&&E(E(I([])));S&&S!==r&&n.call(S,i)&&(g=S);var w=b.prototype=v.prototype=Object.create(g);function k(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function r(o,a,i,l){var c=d(e[o],e,a);if("throw"!==c.type){var s=c.arg,u=s.value;return u&&"object"==A(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,i,l)}),(function(e){r("throw",e,i,l)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return r("throw",e,i,l)}))}l(c.arg)}var a;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function C(t,r,n){var o=f;return function(a,i){if(o===p)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var l=n.delegate;if(l){var c=T(l,n);if(c){if(c===_)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var s=d(t,r,n);if("normal"===s.type){if(o=n.done?y:m,s.arg===_)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=y,n.method="throw",n.arg=s.arg)}}}function T(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,T(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),_;var a=d(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,_;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,_):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,_)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function I(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(A(t)+" is not iterable")}return h.prototype=b,o(w,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:h,configurable:!0}),h.displayName=s(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,s(e,c,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},k(x.prototype),s(x.prototype,l,(function(){return this})),t.AsyncIterator=x,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new x(u(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},k(w),s(w,c,"Generator"),s(w,i,(function(){return this})),s(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=I,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(L),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return l.type="throw",l.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],l=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(c&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,_):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),L(r),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;L(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:I(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),_}},t}function k(e,t,r,n,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,o)}function x(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){k(a,n,o,i,l,"next",e)}function l(e){k(a,n,o,i,l,"throw",e)}i(void 0)}))}}function C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(Object(r),!0).forEach((function(t){j(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function j(e,t,r){return(t=P(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function L(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,P(n.key),n)}}function P(e){var t=function(e){if("object"!=A(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=A(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==A(t)?t:t+""}var I=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.validation_errors={},this.validation_rules={},this.preSwitchAccountDisposer=null,this.pre_switch_account_listener=null,this.switchAccountDisposer=null,this.switch_account_listener=null,this.logoutDisposer=null,this.logout_listener=null,this.clientInitDisposer=null,this.client_init_listener=null,this.networkStatusChangeDisposer=null,this.network_status_change_listener=null,this.themeChangeDisposer=null,this.theme_change_listener=null,this.realAccountSignupEndedDisposer=null,this.real_account_signup_ended_listener=null,this.partial_fetch_time=0,(0,f.makeObservable)(this,{validation_errors:f.observable,validation_rules:f.observable,partial_fetch_time:f.observable,retrieveFromStorage:f.action,setValidationErrorMessages:f.action,setValidationRules:f.action,addRule:f.action,validateProperty:f.action,validateAllProperties:f.action,onSwitchAccount:f.action.bound,onPreSwitchAccount:f.action.bound,onLogout:f.action.bound,onClientInit:f.action.bound,onNetworkStatusChange:f.action.bound,onThemeChange:f.action.bound,onRealAccountSignupEnd:f.action.bound,disposePreSwitchAccount:f.action.bound,disposeSwitchAccount:f.action.bound,disposeLogout:f.action.bound,disposeClientInit:f.action.bound,disposeNetworkStatusChange:f.action.bound,disposeThemeChange:f.action.bound,disposeRealAccountSignupEnd:f.action.bound,onUnmount:f.action.bound,assertHasValidCache:f.action.bound});var n=r.root_store,o=r.local_storage_properties,a=r.session_storage_properties,i=r.validation_rules,l=r.store_name;if(Object.defineProperty(this,"root_store",{enumerable:!1,writable:!0}),Object.defineProperty(this,"local_storage_properties",{enumerable:!1,writable:!0}),Object.defineProperty(this,"session_storage_properties",{enumerable:!1,writable:!0}),o&&o.length||a&&a.length){if(!l)throw new Error("store_name is required for local/session storage");Object.defineProperty(this,"store_name",{value:l,enumerable:!1,writable:!1})}this.root_store=n,this.local_storage_properties=o||[],this.session_storage_properties=a||[],setTimeout((function(){t.setValidationRules(i),t.setupReactionForLocalStorage(),t.setupReactionForSessionStorage(),t.retrieveFromStorage()}),0)}return t=e,r=[{key:"getSnapshot",value:function(e){var t=(0,f.toJS)(this);return(0,i.isEmptyObject)(this.root_store)||(t.root_store=this.root_store),e&&e.length&&(t=e.reduce((function(e,r){return Object.assign(e,j({},r,t[r]))}),{})),t}},{key:"setupReactionForLocalStorage",value:function(){var t=this;this.local_storage_properties.length&&(0,f.reaction)((function(){return t.local_storage_properties.map((function(e){return t[e]}))}),(function(){return t.saveToStorage(t.local_storage_properties,e.STORAGES.LOCAL_STORAGE)}))}},{key:"setupReactionForSessionStorage",value:function(){var t=this;this.session_storage_properties.length&&(0,f.reaction)((function(){return t.session_storage_properties.map((function(e){return t[e]}))}),(function(){return t.saveToStorage(t.session_storage_properties,e.STORAGES.SESSION_STORAGE)}))}},{key:"saveToStorage",value:function(t,r){var n=JSON.stringify(this.getSnapshot(t),(function(e,t){if(null!==t)return t}));r===e.STORAGES.LOCAL_STORAGE?localStorage.setItem(this.store_name,n):r===e.STORAGES.SESSION_STORAGE&&sessionStorage.setItem(this.store_name,n)}},{key:"retrieveFromStorage",value:function(){var e=this,t=JSON.parse(localStorage.getItem(this.store_name,{})),r=JSON.parse(sessionStorage.getItem(this.store_name,{})),n=T(T({},t),r);Object.keys(n).forEach((function(t){return e[t]=n[t]}))}},{key:"setValidationErrorMessages",value:function(e,t){var r=this;this.validation_errors[e]&&!r.validation_errors[e].filter((function(e){return!t.includes(e)})).concat(t.filter((function(t){return!r.validation_errors[e].includes(t)}))).length||(this.validation_errors[e]=t)}},{key:"setValidationRules",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.keys(t).forEach((function(r){e.addRule(r,t[r])}))}},{key:"addRule",value:function(e,t){var r=this;this.validation_rules[e]=t,(0,f.intercept)(this,e,(function(t){return r.validateProperty(e,t.newValue),t}))}},{key:"validateProperty",value:function(e,t){var r=this,n=this.validation_rules[e].trigger,o=j({},e,void 0!==t?t:this[e]),a=j({},e,this.validation_rules[e].rules||[]);n&&Object.hasOwnProperty.call(this,n)&&(o[n]=this[n],a[n]=this.validation_rules[n].rules||[]);var l=new i.Validator(o,a,this);l.isPassed(),Object.keys(o).forEach((function(e){r.setValidationErrorMessages(e,l.errors.get(e))}))}},{key:"validateAllProperties",value:function(){var e=this,t=Object.keys(this.validation_rules),r=Object.keys(this.validation_errors);t.forEach((function(t){e.validateProperty(t,e[t])})),r.forEach((function(r){t.includes(r)||delete e.validation_errors[r]}))}},{key:"onSwitchAccount",value:function(e){var t=this;e&&(this.switch_account_listener=e,this.switchAccountDisposer=(0,f.when)((function(){return t.root_store.client.switch_broadcast}),(function(){try{var e=t.switch_account_listener();if(!e||!e.then||"function"!=typeof e.then)throw new Error("Switching account listeners are required to return a promise.");e.then((function(){t.root_store.client.switchEndSignal(),t.onSwitchAccount(t.switch_account_listener)}))}catch(e){(0,i.isProduction)()||console.error(e)}})))}},{key:"onPreSwitchAccount",value:function(e){var t=this;e&&(this.pre_switch_account_listener=e,this.preSwitchAccountDisposer=(0,f.when)((function(){return t.root_store.client.pre_switch_broadcast}),(function(){try{var e,r=null===(e=t.pre_switch_account_listener)||void 0===e?void 0:e.call(t);if(!r||!r.then||"function"!=typeof r.then)throw new Error("Pre-switch account listeners are required to return a promise.");r.then((function(){t.root_store.client.setPreSwitchAccount(!1),t.onPreSwitchAccount(t.pre_switch_account_listener)}))}catch(e){(0,i.isProduction)()||console.error(e)}})))}},{key:"onLogout",value:function(e){var t=this;this.logoutDisposer=(0,f.when)((function(){return t.root_store.client.has_logged_out}),x(O().mark((function e(){var r;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(r=t.logout_listener())||!r.then||"function"!=typeof r.then){e.next=6;break}r.then((function(){t.root_store.client.setLogout(!1),t.onLogout(t.logout_listener)})),e.next=7;break;case 6:throw new Error("Logout listeners are required to return a promise.");case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),(0,i.isProduction)()||console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))),this.logout_listener=e}},{key:"onClientInit",value:function(e){var t=this;this.clientInitDisposer=(0,f.when)((function(){return t.root_store.client.initialized_broadcast}),x(O().mark((function e(){var r;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(r=t.client_init_listener())||!r.then||"function"!=typeof r.then){e.next=6;break}r.then((function(){t.root_store.client.setInitialized(!1),t.onClientInit(t.client_init_listener)})),e.next=7;break;case 6:throw new Error("Client init listeners are required to return a promise.");case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),(0,i.isProduction)()||console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))),this.client_init_listener=e}},{key:"onNetworkStatusChange",value:function(e){var t=this;this.networkStatusChangeDisposer=(0,f.reaction)((function(){return t.root_store.common.is_network_online}),(function(e){try{t.network_status_change_listener(e)}catch(e){(0,i.isProduction)()||console.error(e)}})),this.network_status_change_listener=e}},{key:"onThemeChange",value:function(e){var t=this;this.themeChangeDisposer=(0,f.reaction)((function(){return t.root_store.ui.is_dark_mode_on}),(function(e){try{t.theme_change_listener(e)}catch(e){(0,i.isProduction)()||console.error(e)}})),this.theme_change_listener=e}},{key:"onRealAccountSignupEnd",value:function(e){var t=this;this.realAccountSignupEndedDisposer=(0,f.when)((function(){return t.root_store.ui.has_real_account_signup_ended}),(function(){try{var e=t.real_account_signup_ended_listener();if(!e||!e.then||"function"!=typeof e.then)throw new Error("Real account signup listeners are required to return a promise.");e.then((function(){t.root_store.ui.setRealAccountSignupEnd(!1),t.onRealAccountSignupEnd(t.real_account_signup_ended_listener)}))}catch(e){(0,i.isProduction)()||console.error(e)}})),this.real_account_signup_ended_listener=e}},{key:"disposePreSwitchAccount",value:function(){"function"==typeof this.preSwitchAccountDisposer&&this.preSwitchAccountDisposer(),this.pre_switch_account_listener=null}},{key:"disposeSwitchAccount",value:function(){"function"==typeof this.switchAccountDisposer&&this.switchAccountDisposer(),this.switch_account_listener=null}},{key:"disposeLogout",value:function(){"function"==typeof this.logoutDisposer&&this.logoutDisposer(),this.logout_listener=null}},{key:"disposeClientInit",value:function(){"function"==typeof this.clientInitDisposer&&this.clientInitDisposer(),this.client_init_listener=null}},{key:"disposeNetworkStatusChange",value:function(){"function"==typeof this.networkStatusChangeDisposer&&this.networkStatusChangeDisposer(),this.network_status_change_listener=null}},{key:"disposeThemeChange",value:function(){"function"==typeof this.themeChangeDisposer&&this.themeChangeDisposer(),this.theme_change_listener=null}},{key:"disposeRealAccountSignupEnd",value:function(){"function"==typeof this.realAccountSignupEndedDisposer&&this.realAccountSignupEndedDisposer(),this.real_account_signup_ended_listener=null}},{key:"onUnmount",value:function(){this.disposePreSwitchAccount(),this.disposeSwitchAccount(),this.disposeLogout(),this.disposeClientInit(),this.disposeNetworkStatusChange(),this.disposeThemeChange(),this.disposeRealAccountSignupEnd()}},{key:"assertHasValidCache",value:function(e){if(this.root_store.client.loginid!==e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];r.forEach((function(e){return e()})),this.partial_fetch_time=!1}}}],r&&L(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r}();function N(e){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N(e)}function D(e){return function(e){if(Array.isArray(e))return M(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return M(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?M(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function z(){z=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),l=new j(n||[]);return o(i,"_invoke",{value:k(e,r,l)}),i}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",m="suspendedYield",p="executing",y="completed",_={};function v(){}function h(){}function b(){}var g={};s(g,i,(function(){return this}));var E=Object.getPrototypeOf,S=E&&E(E(L([])));S&&S!==r&&n.call(S,i)&&(g=S);var w=b.prototype=v.prototype=Object.create(g);function A(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function r(o,a,i,l){var c=d(e[o],e,a);if("throw"!==c.type){var s=c.arg,u=s.value;return u&&"object"==N(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,i,l)}),(function(e){r("throw",e,i,l)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return r("throw",e,i,l)}))}l(c.arg)}var a;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function k(t,r,n){var o=f;return function(a,i){if(o===p)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var l=n.delegate;if(l){var c=x(l,n);if(c){if(c===_)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var s=d(t,r,n);if("normal"===s.type){if(o=n.done?y:m,s.arg===_)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=y,n.method="throw",n.arg=s.arg)}}}function x(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),_;var a=d(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,_;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,_):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,_)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(N(t)+" is not iterable")}return h.prototype=b,o(w,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:h,configurable:!0}),h.displayName=s(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,s(e,c,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},A(O.prototype),s(O.prototype,l,(function(){return this})),t.AsyncIterator=O,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new O(u(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},A(w),s(w,c,"Generator"),s(w,i,(function(){return this})),s(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return l.type="throw",l.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],l=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(c&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,_):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),_}},t}function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function F(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){U(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function U(e,t,r){return(t=H(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function q(e,t,r,n,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,o)}function V(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){q(a,n,o,i,l,"next",e)}function l(e){q(a,n,o,i,l,"throw",e)}i(void 0)}))}}function B(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,H(n.key),n)}}function H(e){var t=function(e){if("object"!=N(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=N(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==N(t)?t:t+""}function G(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(G=function(){return!!e})()}function Y(e){return Y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Y(e)}function W(e,t){return W=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},W(e,t)}I.STORAGES=Object.freeze({LOCAL_STORAGE:Symbol("LOCAL_STORAGE"),SESSION_STORAGE:Symbol("SESSION_STORAGE")});var $=function(e){function t(e){var r,n=e.root_store;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=function(e,t,r){return t=Y(t),function(e,t){if(t&&("object"==N(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,G()?Reflect.construct(t,r||[],Y(e).constructor):t.apply(e,r))}(this,t,[{root_store:n}])).data=[],r.date_from=null,r.date_to=(0,i.toMoment)().startOf("day").add(1,"d").subtract(1,"s").unix(),r.error="",r.has_loaded_all=!1,r.is_loading=!0,r.filtered_date_range=void 0,r.client_loginid="",r.fetchOnScroll=d()((function(e,t){e<1500&&r.fetchNextBatch(t)}),150),(0,f.makeObservable)(r,{data:f.observable,date_from:f.observable,date_to:f.observable,error:f.observable,has_loaded_all:f.observable,is_loading:f.observable,filtered_date_range:f.observable,client_loginid:f.observable,is_empty:f.computed,has_selected_date:f.computed,fetchNextBatch:f.action.bound,profitTableResponseHandler:f.action.bound,handleScroll:f.action.bound,networkStatusChangeListener:f.action.bound,onMount:f.action.bound,onUnmount:f.override,totals:f.computed,accountSwitcherListener:f.action.bound,clearTable:f.action.bound,clearDateFilter:f.action.bound,handleDateChange:f.action.bound}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&W(e,t)}(t,e),r=t,n=[{key:"is_empty",get:function(){return!this.is_loading&&0===this.data.length}},{key:"has_selected_date",get:function(){return!(!this.date_from&&!this.date_to)}},{key:"shouldFetchNextBatch",value:function(e){return!!e||!this.has_loaded_all&&!this.is_loading}},{key:"fetchNextBatch",value:(a=V(z().mark((function e(t,r){var n,o,a,l,c;return z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.shouldFetchNextBatch(r)){e.next=2;break}return e.abrupt("return");case 2:return this.is_loading=!0,a=b(this.date_from,this.date_to,0,!1),l=t?F(F({},b(null===(n=this.root_store.modules.positions)||void 0===n?void 0:n.dateFrom,null===(o=this.root_store.modules.positions)||void 0===o?void 0:o.dateTo,0,!1)),{},{contract_type:this.root_store.modules.positions.filteredContractTypes}):a,e.next=7,i.WS.profitTable(50,this.data.length,l);case 7:c=e.sent,this.profitTableResponseHandler(c);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"profitTableResponseHandler",value:function(e){var t=this;if("error"in e)this.error=e.error.message;else{var r=e.profit_table.transactions.map((function(e){return function(e,t){var r,n,o,a,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],c="DD MMM YYYY HH:mm:ss",s=e.purchase_time&&"".concat((0,i.toMoment)(Number(e.purchase_time)).format(c)),u=e.purchase_time,d=e.sell_time&&"".concat((0,i.toMoment)(Number(e.sell_time)).format(c)),f=null!==(r=e.payout)&&void 0!==r?r:NaN,m=null!==(n=e.sell_price)&&void 0!==n?n:NaN,p=null!==(o=e.buy_price)&&void 0!==o?o:NaN,y=(0,i.formatMoney)(t,Number(m-p),!0),_=(0,i.getSymbolDisplayName)(l,(0,i.getMarketInformation)(null!==(a=e.shortcode)&&void 0!==a?a:"").underlying);return S(S({},e),{payout:f,sell_price:m,buy_price:p,profit_loss:y,sell_time:d,purchase_time:s,display_name:_,purchase_time_unix:u})}(e,t.root_store.client.currency,t.root_store.active_symbols.active_symbols)})).filter(i.filterDisabledPositions);this.data=[].concat(D(this.data),D(r)),this.has_loaded_all=r.length<50,this.is_loading=!1}}},{key:"handleScroll",value:function(e,t){var r=e.target,n=r.scrollTop,o=r.scrollHeight-(n+r.clientHeight);this.fetchOnScroll(o,t)}},{key:"networkStatusChangeListener",value:function(e){this.is_loading=this.is_loading||!e}},{key:"onMount",value:(o=V(z().mark((function e(t){return z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.assertHasValidCache(this.client_loginid,this.clearDateFilter,i.WS.forgetAll.bind(null,"proposal")),this.client_loginid=this.root_store.client.loginid,this.onSwitchAccount(this.accountSwitcherListener),this.onNetworkStatusChange(this.networkStatusChangeListener),e.next=6,i.WS.wait("authorize");case 6:this.fetchNextBatch(t,!0);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"onUnmount",value:function(){this.disposeSwitchAccount(),i.WS.forgetAll("proposal")}},{key:"totals",get:function(){var e=0;return this.data.forEach((function(t){e+=parseFloat(t.profit_loss.replace(/,/g,""))})),{profit_loss:e.toString()}}},{key:"accountSwitcherListener",value:function(){var e=this;return new Promise((function(t){return e.clearTable(),e.clearDateFilter(),t(e.fetchNextBatch())}))}},{key:"clearTable",value:function(){this.data=[],this.has_loaded_all=!1,this.is_loading=!1}},{key:"clearDateFilter",value:function(){this.date_from=null,this.date_to=(0,i.toMoment)().startOf("day").add(1,"d").subtract(1,"s").unix()}},{key:"handleDateChange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.date_range,n=t.shouldFilterContractTypes,o=e.from,a=e.to,l=e.is_batch;this.filtered_date_range=r,o?this.date_from=(0,i.toMoment)(o).unix():l&&(this.date_from=null),a&&(this.date_to=(0,i.toMoment)(a).unix()),n&&(this.root_store.modules.positions.setDateFrom(this.date_from),this.root_store.modules.positions.setDateTo(this.date_to)),this.clearTable(),this.fetchNextBatch(n)}}],n&&B(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o,a}(I),K=r("@deriv/translations");function J(e){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},J(e)}function X(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Z(e,t,r){return(t=function(e){var t=function(e){if("object"!=J(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=J(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==J(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Q(e){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Q(e)}function ee(e){return function(e){if(Array.isArray(e))return te(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return te(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?te(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function te(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function re(){re=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),l=new j(n||[]);return o(i,"_invoke",{value:k(e,r,l)}),i}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",m="suspendedYield",p="executing",y="completed",_={};function v(){}function h(){}function b(){}var g={};s(g,i,(function(){return this}));var E=Object.getPrototypeOf,S=E&&E(E(L([])));S&&S!==r&&n.call(S,i)&&(g=S);var w=b.prototype=v.prototype=Object.create(g);function A(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function r(o,a,i,l){var c=d(e[o],e,a);if("throw"!==c.type){var s=c.arg,u=s.value;return u&&"object"==Q(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,i,l)}),(function(e){r("throw",e,i,l)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return r("throw",e,i,l)}))}l(c.arg)}var a;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function k(t,r,n){var o=f;return function(a,i){if(o===p)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var l=n.delegate;if(l){var c=x(l,n);if(c){if(c===_)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var s=d(t,r,n);if("normal"===s.type){if(o=n.done?y:m,s.arg===_)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=y,n.method="throw",n.arg=s.arg)}}}function x(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),_;var a=d(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,_;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,_):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,_)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(Q(t)+" is not iterable")}return h.prototype=b,o(w,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:h,configurable:!0}),h.displayName=s(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,s(e,c,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},A(O.prototype),s(O.prototype,l,(function(){return this})),t.AsyncIterator=O,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new O(u(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},A(w),s(w,c,"Generator"),s(w,i,(function(){return this})),s(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return l.type="throw",l.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],l=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(c&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,_):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),_}},t}function ne(e,t,r,n,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,o)}function oe(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){ne(a,n,o,i,l,"next",e)}function l(e){ne(a,n,o,i,l,"throw",e)}i(void 0)}))}}function ae(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ie(n.key),n)}}function ie(e){var t=function(e){if("object"!=Q(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Q(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Q(t)?t:t+""}function le(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(le=function(){return!!e})()}function ce(e){return ce=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ce(e)}function se(e,t){return se=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},se(e,t)}var ue=function(e){function t(e){var r,n=e.root_store;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=function(e,t,r){return t=ce(t),function(e,t){if(t&&("object"==Q(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,le()?Reflect.construct(t,r||[],ce(e).constructor):t.apply(e,r))}(this,t,[{root_store:n}])).data=[],r.is_loading=!0,r.has_loaded_all=!1,r.date_from=null,r.date_to=(0,i.toMoment)().startOf("day").add(1,"d").subtract(1,"s").unix(),r.error="",r.action_type="all",r.filtered_date_range=void 0,r.client_loginid="",r.account_statistics={},r.fetchOnScroll=d()((function(e){e<1500&&r.fetchNextBatch()}),150),(0,f.makeObservable)(r,{data:f.observable,is_loading:f.observable,has_loaded_all:f.observable,date_from:f.observable,date_to:f.observable,error:f.observable,action_type:f.observable,filtered_date_range:f.observable,client_loginid:f.observable,account_statistics:f.observable,is_empty:f.computed,has_selected_date:f.computed,clearTable:f.action.bound,clearDateFilter:f.action.bound,fetchNextBatch:f.action.bound,statementHandler:f.action.bound,handleDateChange:f.action.bound,handleFilterChange:f.action.bound,handleScroll:f.action.bound,accountSwitcherListener:f.action.bound,networkStatusChangeListener:f.action.bound,onMount:f.action.bound,onUnmount:f.override}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&se(e,t)}(t,e),r=t,n=[{key:"is_empty",get:function(){return!this.is_loading&&0===this.data.length}},{key:"has_selected_date",get:function(){return!(!this.date_from&&!this.date_to)}},{key:"clearTable",value:function(){this.data=[],this.has_loaded_all=!1,this.is_loading=!1}},{key:"clearDateFilter",value:function(){this.date_from=null,this.date_to=(0,i.toMoment)().startOf("day").add(1,"d").subtract(1,"s").unix(),this.partial_fetch_time=0}},{key:"shouldFetchNextBatch",value:function(e){if(!e&&(this.has_loaded_all||this.is_loading))return!1;var t=(0,i.toMoment)().startOf("day").add(1,"d").subtract(1,"s").unix();return!(this.date_to<t)||!e&&this.partial_fetch_time}},{key:"fetchNextBatch",value:(a=oe(re().mark((function e(){var t,r,n,o=arguments;return re().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o.length>0&&void 0!==o[0]&&o[0],this.shouldFetchNextBatch(t)){e.next=3;break}return e.abrupt("return");case 3:return this.is_loading=!0,r=b(this.date_from,this.date_to,this.partial_fetch_time,t),"all"!==this.action_type&&(r.action_type=this.action_type),e.next=8,i.WS.statement(100,t?void 0:this.data.length,r);case 8:n=e.sent,this.statementHandler(n,t);case 10:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"statementHandler",value:function(e,t){var r=this;if("error"in e)this.error=e.error.message;else{var n=e.statement.transactions.map((function(e){return function(e,t){var r,n,o,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],l=e.action_type,c=e.app_id,s=e.contract_id,u=e.longcode,d=e.purchase_time,f=e.withdrawal_details,m=(0,i.toMoment)(e.transaction_time).format("DD MMM YYYY HH:mm:ss"),p=null!==(r=e.payout)&&void 0!==r?r:NaN,y=null!==(n=e.amount)&&void 0!==n?n:NaN,_=null!==(o=e.balance_after)&&void 0!==o?o:NaN,v=!0,h=["buy","sell"].includes(null!=l?l:"")?e.shortcode:null,b=h?(0,i.getSymbolDisplayName)(a,(0,i.getMarketInformation)(h).underlying):"";return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?X(Object(r),!0).forEach((function(t){Z(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({action:(0,K.localize)((0,i.toTitleCase)(null!=l?l:"")),date:m,display_name:b,refid:e.transaction_id,payout:isNaN(p)?"-":(0,i.formatMoney)(t,p,v),amount:isNaN(y)?"-":(0,i.formatMoney)(t,y,v),balance:isNaN(_)?"-":(0,i.formatMoney)(t,_,v),desc:null==u?void 0:u.replace(/\n/g,"<br />"),id:s,app_id:c,shortcode:h,action_type:l,purchase_time:d,transaction_time:e.transaction_time},f&&{withdrawal_details:f,longcode:u})}(e,r.root_store.client.currency,r.root_store.active_symbols.active_symbols)})).filter(i.filterDisabledPositions);this.data=t?[].concat(ee(n),ee(this.data)):[].concat(ee(this.data),ee(n)),this.has_loaded_all=!t&&n.length<100,this.is_loading=!1,n.length>0&&(this.partial_fetch_time=(0,i.toMoment)().unix())}}},{key:"handleDateChange",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).date_range,r=e.from,n=e.to,o=e.is_batch;this.filtered_date_range=t,r?this.date_from=(0,i.toMoment)(r).unix():o&&(this.date_from=null),n&&(this.date_to=(0,i.toMoment)(n).unix()),this.clearTable(),this.fetchNextBatch()}},{key:"handleFilterChange",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action_type=e,this.clearTable(),this.fetchNextBatch()}},{key:"handleScroll",value:function(e){var t=e.target,r=t.scrollTop,n=t.scrollHeight-(r+t.clientHeight);this.fetchOnScroll(n)}},{key:"accountSwitcherListener",value:function(){var e=this;return new Promise((function(t){return e.clearTable(),e.clearDateFilter(),t(e.fetchNextBatch())}))}},{key:"networkStatusChangeListener",value:function(e){this.is_loading=this.is_loading||!e}},{key:"onMount",value:(o=oe(re().mark((function e(){return re().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.assertHasValidCache(this.client_loginid,this.clearDateFilter,this.client_loginid?this.clearTable:function(){return null},i.WS.forgetAll.bind(null,"proposal")),this.client_loginid=this.root_store.client.loginid,this.onSwitchAccount(this.accountSwitcherListener),this.onNetworkStatusChange(this.networkStatusChangeListener),e.next=6,i.WS.wait("authorize");case 6:this.fetchNextBatch(!0);case 7:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"onUnmount",value:function(){this.disposeSwitchAccount(),i.WS.forgetAll("proposal")}}],n&&ae(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o,a}(I),de=o().createContext(null),fe=function(e){var t=e.children,r=(0,s.A)(),n=o().useMemo((function(){return{profit_table:new $({root_store:r}),statement:new ue({root_store:r})}}),[r]);return o().createElement(de.Provider,{value:n},t)},me=r("../../node_modules/@deriv-com/quill-ui/dist/providers/notification/notificationsProvider.js"),pe=r("../../node_modules/@deriv-com/quill-ui/dist/providers/snackbar/snackbarProvider.js"),ye=r("mobx-react-lite"),_e=r("../../node_modules/@deriv-com/quill-ui/dist/hooks/useNotifications/index.js"),ve=r("../../node_modules/@deriv-com/quill-ui/dist/components/Notification/banners/index.js"),he=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Standalone/StandaloneFlagCheckeredFillIcon.js"),be=r("react-router-dom");function ge(e){return ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ge(e)}function Ee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Se(e,t,r){return(t=function(e){var t=function(e){if("object"!=ge(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=ge(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ge(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var we=(0,ye.observer)((function(){var e=(0,_e.E)(),t=e.addBanner,r=e.banners,n=e.removeBanner,a=(0,s.A)().portfolio.setAddNotificationBannerCallback,l=(0,be.useLocation)().pathname;return o().useEffect((function(){r.length>1&&n(r[0].id),l!==i.routes.trade&&r.forEach((function(e){var t=e.type,r=e.id;t||n(r)}))}),[r,l]),o().useEffect((function(){return a((function(e,r){return t(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(r),!0).forEach((function(t){Se(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ee(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({icon:o().createElement(he.A,{iconSize:"sm",className:"trade-notification--".concat(r),key:"contract-closed"})},e))})),function(){return a()}}),[]),o().createElement(ve.$,{autohideTimeout:4e3,banners:r,className:"trade-notification",isMobile:!0,onClose:n,zIndex:100})}));const Ae=we;var Oe=r("@deriv/components"),ke=r("../../node_modules/clsx/dist/clsx.mjs"),xe=r("../utils/src/index.ts");function Ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Te=function(e,t){var r,n,a=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ce(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ce(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o().useState(null!==(r=null!==(n=(0,xe.Lg)(e))&&void 0!==n?n:t)&&void 0!==r?r:null),2),i=a[0],l=a[1];return o().useEffect((function(){localStorage.setItem(e,JSON.stringify(i))}),[e,i]),[i,l,function(){localStorage.removeItem(e),l(null!=t?t:null)}]};var je=r("../../node_modules/@deriv-com/quill-ui/dist/components/Typography/text/index.js"),Le=r("../../node_modules/@deriv-com/quill-ui/dist/snackbar-controller-ChcV5SXl.js"),Pe=r("../../node_modules/@deriv/quill-icons/dist/esm/react/LabelPaired/LabelPairedChevronUpSmBoldIcon.js"),Ie=r("./src/Stores/useTraderStores.tsx");function Ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const De=function(e){var t,r=e.rows,a=e.animation_class,i=e.is_moving_transaction,l=e.className,c=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ne(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ne(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,n.useState)(0),2),s=c[0],u=c[1];return(0,n.useEffect)((function(){u((function(e){return e+1}))}),[a]),o().createElement(o().Fragment,null,o().createElement("div",{className:"".concat(l,"__stat")},o().createElement(je.E,{size:"sm",bold:!0,className:a,"data-testid":"accumulator-first-stat",color:"quill-typography__color--prominent",key:s},r[0])),null===(t=r.slice(1))||void 0===t?void 0:t.map((function(e,t){return o().createElement("div",{key:t+1,className:(0,ke.A)("".concat(l,"__stat"),{"slide-right":i&&0==t})},o().createElement(je.E,{size:"sm"},e))})))};var Me=r("./src/Modules/Trading/Helpers/video-config.ts"),ze=r("../../node_modules/@deriv-com/quill-ui/dist/components/Loader/skeleton/index.js"),Re=r("./src/AppV2/Utils/trade-params-utils.tsx"),Fe=.5625,Ue=function(e){var t,r,n=e.component_key,o=e.contract_type,a=e.has_cancellation,i=e.symbol;return n in(null!==(t=null===(r=(0,Re.LL)(i,a))||void 0===r?void 0:r[o])&&void 0!==t?t:{})},qe=function(e){var t=e.contract_type,r=e.has_cancellation,n=e.is_accumulator,o=e.symbol,a=window.innerHeight-40-56-136-24,i=function(e){return Ue({component_key:e,symbol:o,has_cancellation:r,contract_type:t})};return n?a-56:i("expiration")||i("mult_info_display")||i("payout_per_point_info")||i("allow_equals")||i("payout")?a-30:a},Ve="InsufficientBalance",Be="AuthorizationRequired",He="PleaseAuthenticate",Ge="PendingVerification",Ye=function(e){var t=e.services_error,r=e.is_mf_verification_pending_modal_visible,n=t||{},o=n.code,a=n.type;return o===Ve||o===Be&&"buy"===a||o===He||!!r},We=["autoplay","controls","letterbox_color","loop","muted","preload","src","test_id","title"];function $e(){return $e=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$e.apply(null,arguments)}function Ke(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Je=function(e){var t=e.autoplay,r=void 0===t||t,n=e.controls,a=void 0!==n&&n,i=e.letterbox_color,l=void 0===i?"transparent":i,c=e.loop,s=void 0===c||c,u=e.muted,d=void 0===u||u,f=e.preload,m=void 0===f?"auto":f,p=e.src,y=e.test_id,_=e.title,v=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,We),h=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ke(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ke(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o().useState(!0),2),b=h[0],g=h[1],E=["letterboxColor=".concat(encodeURIComponent(l)),"muted=".concat(d),"preload=".concat(m),"loop=".concat(s),"autoplay=".concat(r),"controls=".concat(a)].join("&");return o().createElement("div",{className:(0,ke.A)("stream__wrapper",b&&"stream__wrapper--is-loading")},b&&o().createElement(ze.E.Square,{height:"calc(100vw * ".concat(Fe,")")}),o().createElement("iframe",$e({allowFullScreen:!1,className:"stream__iframe",width:"100%",height:"100%",src:"https://iframe.cloudflarestream.com/".concat(p,"?").concat(E),"data-testid":y,title:_,onLoad:function(){return g(!1)}},v)))},Xe=function(e){var t=e.onActionSheetClose;return o().createElement(Le.A.Portal,{showHandlebar:!0,shouldCloseOnDrag:!0,handleBarPosition:"absolute"},o().createElement("div",{className:"stats-description"},o().createElement(Je,{src:Me.Jz.accumulator_stats,title:"accumulator_stats"}),o().createElement("div",{className:"stats-description__content"},o().createElement("div",{className:"stats-description__content__title"},o().createElement(je.E,{size:"lg",bold:!0,color:"quill-typography__color--prominent"},o().createElement(K.Localize,{i18n_default_text:"Stats"}))),o().createElement("div",{className:"stats-description__content__description"},o().createElement(je.E,null,o().createElement(K.Localize,{i18n_default_text:"Stats show the history of consecutive tick counts, i.e. the number of ticks the price remained within range continuously."}))))),o().createElement(Le.A.Footer,{alignment:"vertical",primaryAction:{content:o().createElement(K.Localize,{i18n_default_text:"Got it"}),onAction:t}}))},Ze=function(e){var t=e.rows,r=e.animation_class,n=e.is_moving_transaction;return o().createElement(Le.A.Portal,{shouldCloseOnDrag:!0},o().createElement("div",{className:"stats-sheet"},o().createElement("div",{className:"stats-sheet__title"},o().createElement(je.E,{size:"lg",bold:!0,color:"quill-typography__color--prominent"},o().createElement(K.Localize,{i18n_default_text:"Stats"}))),o().createElement(je.E,null,o().createElement(K.Localize,{i18n_default_text:"History of tick counts"}))),o().createElement(Le.A.Content,null,o().createElement("div",{className:"stats-sheet__stats"},o().createElement(De,{rows:t[0],animation_class:r,is_moving_transaction:n,className:"stats-sheet__stats"})),t.slice(1).map((function(e,t){return o().createElement("div",{key:t,className:"stats-sheet__stats"},e.map((function(e,r){return o().createElement("div",{key:"".concat(t,"-").concat(r),className:"stats-sheet__stats__number"},o().createElement(je.E,{size:"sm"},e))})))}))))};function Qe(e){return function(e){if(Array.isArray(e))return rt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||tt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function et(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||tt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tt(e,t){if(e){if("string"==typeof e)return rt(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?rt(e,t):void 0}}function rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const nt=(0,ye.observer)((function(){var e,t=(0,Ie.P)().ticks_history_stats,r=void 0===t?{}:t,a=et((0,n.useState)(!1),2),i=a[0],l=a[1],c=et((0,n.useState)(!1),2),s=c[0],u=c[1],d=et((0,n.useState)(""),2),f=d[0],m=d[1],p=et((0,n.useState)(null),2),y=p[0],_=p[1],v=et((0,n.useState)(!1),2),h=v[0],b=v[1],g=(0,n.useMemo)((function(){var e;return null!==(e=null==r?void 0:r.ticks_stayed_in)&&void 0!==e?e:[]}),[r]),E=(0,n.useMemo)((function(){return g.reduce((function(e,t,r){return r%5==0&&e.push(g.slice(r,r+5)),e}),[])}),[g]),S=function(){l(!1),u(!1)};return(0,n.useEffect)((function(){var e,t,r;if(E[0]&&E[0].length>0){m(""),clearTimeout(e),clearTimeout(t),clearTimeout(r);var n=y===E[0][1];n?t=setTimeout((function(){return m("animate-error")}),0):e=setTimeout((function(){return m("animate-success")}),0),b(n),n&&(r=setTimeout((function(){return b(!1)}),600)),_(E[0][0])}return function(){clearTimeout(e),clearTimeout(t),clearTimeout(r)}}),[null===(e=E[0])||void 0===e?void 0:e[0],g]),0===E.length?null:o().createElement("div",null,o().createElement("div",{className:"accumulators-stats-v2"},o().createElement("div",{className:"accumulators-stats-v2__container"},o().createElement("button",{className:"accumulators-stats-v2__container__heading",onClick:function(){return u(!0)}},o().createElement(je.E,{size:"sm"},o().createElement(K.Localize,{i18n_default_text:"Stats"}))),o().createElement("div",{className:"accumulators-stats-v2__container__divider"}),o().createElement("div",{className:"accumulators-stats-v2__container__stats"},o().createElement(De,{rows:[].concat(Qe(E[0]),Qe(E[1]||[])),animation_class:f,is_moving_transaction:h,className:"accumulators-stats-v2__container__stats"})),o().createElement("button",{className:"accumulators-stats-v2__container__expand",onClick:function(){return l(!0)}},o().createElement(Pe.A,{"data-testid":"expand-stats-icon",fill:"var(--semantic-color-monochrome-textIcon-normal-high)"})))),o().createElement(Le.A.Root,{isOpen:i||s,onClose:S,position:"left",className:"accumulator-stats-sheet-wrapper",expandable:!1},i&&o().createElement(Ze,{rows:E,is_moving_transaction:h,animation_class:f}),s&&o().createElement(Xe,{onActionSheetClose:S})))}));var ot=r("../../node_modules/classnames/index.js"),at=r.n(ot),it=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Standalone/StandaloneChartAreaRegularIcon.js"),lt=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Standalone/StandaloneChartAreaFillIcon.js"),ct=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Standalone/StandaloneClockThreeRegularIcon.js"),st=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Standalone/StandaloneClockThreeFillIcon.js"),ut=r("../../node_modules/@deriv-com/quill-ui/dist/components/Badge/index.js"),dt=r("../../node_modules/@deriv-com/quill-ui/dist/components/Navigation/index.js"),ft=r("react-router");function mt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const pt=(0,ye.observer)((function(e){var t=e.children,r=e.className,n=e.onScroll,a=(0,ft.useHistory)(),l=(0,ft.useLocation)(),c=(0,s.A)(),u=c.client,d=c.portfolio.active_positions_count,f=u.is_logged_in,m=[{icon:o().createElement(it.A,{iconSize:"sm"}),activeIcon:o().createElement(lt.A,{iconSize:"sm"}),label:o().createElement(K.Localize,{i18n_default_text:"Trade"}),path:i.routes.trade},{icon:d>0?o().createElement(ut.E,{variant:"notification",position:"top-right",label:d.toString(),color:"danger",size:"sm",contentSize:"sm",className:"bottom-nav-item__position-badge"},o().createElement(ct.A,{iconSize:"sm"})):o().createElement(ct.A,{iconSize:"sm"}),activeIcon:d>0?o().createElement(ut.E,{variant:"notification",position:"top-right",label:d.toString(),color:"danger",size:"sm",contentSize:"sm",className:"bottom-nav-item__position-badge"},o().createElement(st.A,{iconSize:"sm"})):o().createElement(st.A,{iconSize:"sm"}),label:o().createElement(o().Fragment,null,o().createElement("span",{className:"user-guide__anchor"}),o().createElement(K.Localize,{i18n_default_text:"Positions"})),path:i.routes.trader_positions}],p=m.findIndex((function(e){return e.path===l.pathname})),y=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return mt(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?mt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o().useState(p>-1?p:0),2),_=y[0],v=y[1];return o().createElement("div",{className:at()("bottom-nav",r)},o().createElement("div",{className:"bottom-nav-selection",onScroll:n},t),f?o().createElement(dt.V.Bottom,{className:"bottom-nav-container",onChange:function(e,t){return function(e){v(e),a.push(m[e].path)}(t)}},m.map((function(e,t){return o().createElement(dt.V.BottomAction,{key:t,index:t,activeIcon:o().createElement(o().Fragment,null),icon:t===_?e.activeIcon:e.icon,label:e.label,selected:t===_,showLabel:!0,className:(0,ke.A)("bottom-nav-item",t===_&&"bottom-nav-item--active",e.path===i.routes.trader_positions&&"bottom-nav-item--positions")})}))):o().createElement(o().Fragment,null))}));function yt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return _t(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_t(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _t(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var vt={},ht={},bt=function(e){return Array.isArray(e)?e.join("-"):e},gt=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=bt(e),a=r.enabled,l=void 0===a||a,c=yt((0,n.useState)(vt[o]||null),2),s=c[0],u=c[1],d=yt((0,n.useState)(null),2),f=d[0],m=d[1],p=yt((0,n.useState)(!vt[o]&&l),2),y=p[0],_=p[1],v=(0,n.useRef)(!1),h=JSON.stringify(t),b=r.wait_for_authorize,g=void 0===b||b;(0,n.useEffect)((function(){return v.current=!0,function(){v.current=!1}}),[]);var E=(0,n.useCallback)((function(){var e,t;if(_(!0),ht[o])t=ht[o];else{var r=JSON.parse(h);t=g?i.WS.authorized.send(r):i.WS.send(r),ht[o]=t}null===(e=t)||void 0===e||e.then((function(e){v.current&&(vt[o]=e,u(e),_(!1))})).catch((function(e){v.current&&(m(e),_(!1))})).finally((function(){delete ht[o]}))}),[o,h,g]);(0,n.useEffect)((function(){l&&!vt[o]&&E()}),[o,E,l]),(0,n.useEffect)((function(){l&&s!==vt[o]&&u(vt[o])}),[l,o,s]);var S=(0,n.useCallback)((function(){vt[o]=null,E()}),[E,o]);return{data:s,error:f,is_fetching:y,refetch:S}},Et=r("./src/AppV2/Utils/trade-types-utils.tsx"),St=function(e){return[i.isVanillaContract,i.isTurbosContract,i.isRiseFallContract].some((function(t){return e.every((function(e){return t(e)}))}))};function wt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return At(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?At(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function At(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Ot=function(){var e=wt(o().useState([]),2),t=e[0],r=e[1],a=wt(o().useState([]),2),l=a[0],c=a[1],u=(0,Ie.P)(),d=u.contract_type,f=u.onChange,m=u.setContractTypesListV2,p=u.setDefaultStake,y=u.processContractsForV2,_=u.symbol,v=(0,s.A)().client,h=v.loginid,b=v.is_switching,g=v.landing_company_shortcode,E=o().useRef(g),S=(0,n.useCallback)((function(){return!(function(e){return e&&"null"!==e}(h)&&!g||b)}),[h,b,g]),w=gt(["contracts_for_company",null!=h?h:"",g],{contracts_for_company:1,landing_company:g},{enabled:S()}),A=w.data,O=w.error,k=w.is_fetching,x=(0,i.getContractCategoriesConfig)(),C=(0,i.cloneObject)(x),T=(0,i.getContractTypesConfig)(),j=wt(o().useState(),2),L=j[0],P=j[1],I=(0,n.useRef)(k),N=(0,n.useCallback)((function(e){return e.some((function(e){return St([d,e.value])||d===e.value}))}),[d]),D=(0,n.useCallback)((function(e){return Array.isArray(e)&&0===e.length?[]:(0,Et.ae)(e)}),[]),M=(0,n.useCallback)((function(e){return!N(e)&&e.length>0?e[0].value:d}),[d,N]),z=(0,n.useCallback)((function(e){d!=e&&e&&f({target:{name:"contract_type",value:e}}),(0,i.setTradeURLParams)({contractType:e})}),[d,f]);return(0,n.useEffect)((function(){P(void 0),r([]),I.current=!0}),[h]),(0,n.useEffect)((function(){try{var e=(A||{}).contracts_for_company,t={};if(I.current=!1,!O&&null!=e&&e.available.length){e.available.forEach((function(e){var r=Object.keys(T).find((function(t){return-1!==T[t].trade_types.indexOf(e.contract_type)&&("PUT"!==e.contract_type||1===T[t].barrier_count)}));if(r){if(!t[r]){var n,o,a=null!==(n=Object.keys(C).find((function(e){return-1!==C[e].categories.indexOf(r)})))&&void 0!==n?n:"",l=null===(o=C[a])||void 0===o?void 0:o.categories;if(!l)return;l[l.indexOf(r)]={value:r,text:T[r].title,barrier_category:e.barrier_category},t[r]=(0,i.cloneObject)(T[r])}var c=t[r].config||{};c.barrier_category=0===T[r].barrier_count?"euro_atm":e.barrier_category,c.default_stake=e.default_stake,r===d&&p(e.default_stake),t[r].config=c}})),m(C),r(C),P(t);var n=D(C);c(n);var o=M(n);z(o),g!==E.current&&f({target:{name:"symbol",value:_}}).then((function(){y(),E.current=g}))}}catch(e){console.error(e)}}),[A]),{trade_types:l,contract_types_list:t,available_contract_types:L,is_fetching_ref:I,resetTradeTypes:function(){c([])}}};function kt(e){return kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kt(e)}function xt(){xt=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),l=new j(n||[]);return o(i,"_invoke",{value:k(e,r,l)}),i}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",m="suspendedYield",p="executing",y="completed",_={};function v(){}function h(){}function b(){}var g={};s(g,i,(function(){return this}));var E=Object.getPrototypeOf,S=E&&E(E(L([])));S&&S!==r&&n.call(S,i)&&(g=S);var w=b.prototype=v.prototype=Object.create(g);function A(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function r(o,a,i,l){var c=d(e[o],e,a);if("throw"!==c.type){var s=c.arg,u=s.value;return u&&"object"==kt(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,i,l)}),(function(e){r("throw",e,i,l)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return r("throw",e,i,l)}))}l(c.arg)}var a;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function k(t,r,n){var o=f;return function(a,i){if(o===p)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var l=n.delegate;if(l){var c=x(l,n);if(c){if(c===_)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var s=d(t,r,n);if("normal"===s.type){if(o=n.done?y:m,s.arg===_)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=y,n.method="throw",n.arg=s.arg)}}}function x(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),_;var a=d(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,_;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,_):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,_)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(kt(t)+" is not iterable")}return h.prototype=b,o(w,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:h,configurable:!0}),h.displayName=s(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,s(e,c,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},A(O.prototype),s(O.prototype,l,(function(){return this})),t.AsyncIterator=O,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new O(u(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},A(w),s(w,c,"Generator"),s(w,i,(function(){return this})),s(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return l.type="throw",l.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],l=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(c&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,_):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),_}},t}function Ct(e,t,r,n,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,o)}function Tt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function jt(e,t,r){return(t=function(e){var t=function(e){if("object"!=kt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=kt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==kt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Pt=function(){var e,t,r,o=(0,s.A)(),a=o.client,l=o.common,c=a.loginid,u=a.is_switching,d=l.showError,f=l.current_language,m=(0,Ie.P)(),p=m.active_symbols,y=m.contract_type,_=m.is_vanilla,v=m.is_turbos,h=m.setActiveSymbolsV2,b=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Lt(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Lt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,n.useState)(p),2),g=b[0],E=b[1],S=Ot(),w=S.available_contract_types,A=S.is_fetching_ref,O=[i.TRADE_TYPES.RISE_FALL,i.TRADE_TYPES.RISE_FALL_EQUAL,i.TRADE_TYPES.HIGH_LOW],k=((null==w||null===(e=w[y])||void 0===e?void 0:e.config)||{}).barrier_category,x=(0,n.useCallback)((function(){return!(!w||A.current||u)}),[w,u,A]),C=gt(["active_symbols",null!=c?c:"",(0,i.isTurbosContract)(y)?"turbos":(0,i.isVanillaContract)(y)?"vanilla":y,f],function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Tt(Object(r),!0).forEach((function(t){jt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({active_symbols:"brief",contract_type:v?[i.CONTRACT_TYPES.TURBOS.LONG,i.CONTRACT_TYPES.TURBOS.SHORT]:_?[i.CONTRACT_TYPES.VANILLA.CALL,i.CONTRACT_TYPES.VANILLA.PUT]:null!==(t=null===(r=(0,i.getContractTypesConfig)()[y])||void 0===r?void 0:r.trade_types)&&void 0!==t?t:[]},O.includes(y)&&k?{barrier_category:[k]}:{}),{enabled:x()}),T=C.data;return(0,n.useEffect)((function(){var e=function(){var e,t=(e=xt().mark((function e(){var t,r;return xt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(T){e.next=2;break}return e.abrupt("return");case 2:t=T.active_symbols,r=void 0===t?[]:t,T.error?d({message:(0,K.localize)("Trading is unavailable at this time.")}):null!=r&&r.length?(E(r),h(r)):E([]);case 4:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){Ct(a,n,o,i,l,"next",e)}function l(e){Ct(a,n,o,i,l,"throw",e)}i(void 0)}))});return function(){return t.apply(this,arguments)}}();e()}),[T]),{activeSymbols:g}};var It=r("../../node_modules/@deriv-com/quill-ui/dist/components/Typography/caption/index.js");const Nt=function(e){var t=e.opening_time,r=e.days_offset,n=e.current_language,a=(0,i.convertTimeFormat)(t),l=(0,i.toMoment)(new Date).locale(n.toLowerCase()).add(r,"days").format("DD MMM YYYY");return o().createElement(It.O,{bold:!0,className:"market-opening-time-banner"},o().createElement(K.Localize,{i18n_default_text:"{{formatted_opening_time}} (GMT), {{opening_date}}",values:{formatted_opening_time:a,opening_date:l}}))};var Dt=r("../../node_modules/@deriv/quill-icons/dist/esm/react/LabelPaired/LabelPairedStopwatchMdBoldIcon.js");const Mt=function(e){var t=e.time_left,r="";if(Object.keys(t).length){var n=(24*Number(t.days)+Number(t.hours)).toString().padStart(2,"0"),a=Number(t.minutes).toString().padStart(2,"0"),i=Number(t.seconds).toString().padStart(2,"0");r="".concat(n,":").concat(a,":").concat(i)}return o().createElement("div",{className:"market-countdown-timer"},o().createElement(Dt.A,{fill:"var(--component-textIcon-static-prominentDark)"}),o().createElement(je.E,{bold:!0,size:"md",className:"market-countdown-timer-text"},r))};var zt=function(e){var t=e-Date.now();return t>0?{days:Math.floor(t/864e5),hours:Math.floor(t/36e5%24),minutes:Math.floor(t/1e3/60%60),seconds:Math.floor(t/1e3%60)}:{}},Rt=function(e,t){for(var r,n=t.markets,o=0;o<n.length;o++){var a=n[o].submarkets;if(a)for(var i=0;i<a.length;i++){var l=a[i].symbols;if(void 0!==(r=null==l?void 0:l.find((function(t){return t.symbol===e}))))return r}}};function Ft(e){return Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ft(e)}function Ut(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return qt(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?qt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Vt(){Vt=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),l=new j(n||[]);return o(i,"_invoke",{value:k(e,r,l)}),i}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",m="suspendedYield",p="executing",y="completed",_={};function v(){}function h(){}function b(){}var g={};s(g,i,(function(){return this}));var E=Object.getPrototypeOf,S=E&&E(E(L([])));S&&S!==r&&n.call(S,i)&&(g=S);var w=b.prototype=v.prototype=Object.create(g);function A(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function r(o,a,i,l){var c=d(e[o],e,a);if("throw"!==c.type){var s=c.arg,u=s.value;return u&&"object"==Ft(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,i,l)}),(function(e){r("throw",e,i,l)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return r("throw",e,i,l)}))}l(c.arg)}var a;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function k(t,r,n){var o=f;return function(a,i){if(o===p)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var l=n.delegate;if(l){var c=x(l,n);if(c){if(c===_)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var s=d(t,r,n);if("normal"===s.type){if(o=n.done?y:m,s.arg===_)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=y,n.method="throw",n.arg=s.arg)}}}function x(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),_;var a=d(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,_;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,_):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,_)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(Ft(t)+" is not iterable")}return h.prototype=b,o(w,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:h,configurable:!0}),h.displayName=s(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,s(e,c,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},A(O.prototype),s(O.prototype,l,(function(){return this})),t.AsyncIterator=O,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new O(u(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},A(w),s(w,c,"Generator"),s(w,i,(function(){return this})),s(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return l.type="throw",l.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],l=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(c&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,_):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),_}},t}function Bt(e,t,r,n,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,o)}function Ht(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){Bt(a,n,o,i,l,"next",e)}function l(e){Bt(a,n,o,i,l,"throw",e)}i(void 0)}))}}var Gt=function(){var e=Ht(Vt().mark((function e(t){var r;return Vt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.WS.tradingTimes(t);case 2:if(!(r=e.sent).error){e.next=5;break}return e.abrupt("return",{api_initial_load_error:r.error.message});case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();const Yt=(0,ye.observer)((function(){var e=(0,s.A)().common.current_language,t=(0,Ie.P)(),r=t.symbol,n=t.prepareTradeStore,a=t.is_market_closed,l=Pt().activeSymbols,c=(0,i.useIsMounted)(),u=Ut(o().useState({}),2),d=u[0],f=u[1],m=Ut(o().useState(zt(null==d?void 0:d.remaining_time_to_open)),2),p=m[0],y=m[1],_=Ut(o().useState(!0),2),v=_[0],h=_[1];if(o().useEffect((function(){if(a){h(!0);var e=function(){var t=Ht(Vt().mark((function t(n,o){var a,l,s,u,d,m,p,y,_;return Vt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n>7)){t.next=2;break}return t.abrupt("return",{});case 2:return l=(0,i.toMoment)(new Date).add(n,"days"),t.next=5,Gt(l.format("YYYY-MM-DD"));case 5:if((s=t.sent).api_initial_load_error){t.next=26;break}if(u=Rt(o,s.trading_times),d=null==u?void 0:u.times.open,m=null==u?void 0:u.times.close,1!==(null==d?void 0:d.length)||"--"!==d[0]||"--"!==m[0]){t.next=13;break}return t.abrupt("return",e(n+1,o));case 13:p=l.toISOString().substring(0,11),y=function(e){return new Date("".concat(p).concat(e,"Z"))},_=0;case 16:if(!(_<(null==d?void 0:d.length))){t.next=25;break}if(!(+y(d[_])-Date.now()>0)){t.next=22;break}if(a=+y(d[_]),!c()||o!==r){t.next=22;break}return t.abrupt("return",f({days_offset:n,opening_time:d[_],remaining_time_to_open:a}));case 22:_++,t.next=16;break;case 25:e(n+1,o);case 26:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}();e(0,r)}y({}),f({})}),[l,r]),o().useEffect((function(){var e;return null!=d&&d.remaining_time_to_open&&(e=setTimeout((function(){y(zt(d.remaining_time_to_open)),+new Date(d.remaining_time_to_open)-+new Date<1e3&&(h(!0),n(!1))}),1e3)),function(){e&&clearTimeout(e)}}),[p,d,n]),!d||!Object.keys(p).length||!a)return null;var b=d.opening_time,g=d.days_offset;return v&&h(!1),o().createElement("div",{className:(0,ke.A)("closed-market-message--container",{"closed-market-message--loading":v})},o().createElement("div",{className:"closed-market-message--left"},o().createElement(It.O,{className:"closed-market-message--left-message"},o().createElement(K.Localize,{i18n_default_text:"This market will reopen at"})),o().createElement(Nt,{opening_time:b,days_offset:g,current_language:e})),o().createElement(Mt,{time_left:p}))}));var Wt=r("../../node_modules/@deriv-com/quill-ui/dist/components/Typography/heading/index.js");function $t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Kt(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Kt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Kt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Jt="increment",Xt="decrement",Zt="add10";const Qt=o().memo((function(e){var t=e.has_tick_count,r=e.spot,n=e.tick,a=Number(null==r?void 0:r.slice(-1)),i=(0,Oe.usePrevious)(r),l=Number(null==i?void 0:i.slice(-1)),c=$t(o().useState(!1),2),s=c[0],u=c[1],d=$t(o().useState(!1),2),f=d[0],m=d[1],p=$t(o().useState(a),2),y=p[0],_=p[1],v=$t(o().useState(a),2),h=v[0],b=v[1],g=o().useRef(l),E=o().useRef(),S=o().useRef(),w=o().useRef(null);return o().useEffect((function(){var e;if(!isNaN(l)&&!isNaN(a)&&r){var t,n=Math.abs(Number(l)-a),o=n>0?Math.floor(80/n):80,i=Number(l)<=a;return null===(e=w.current)||void 0===e||e.style.setProperty("--animation-time","".concat(o,"ms")),i?u(!0):m(!0),S.current=setTimeout((function(){u(!1),m(!1),b(g.current%10)}),80),g.current=Number(l),function(e,t,r,n){clearInterval(E.current);var o=setInterval((function(){e===Jt&&g.current<n?g.current=(g.current+1)%10:e===Xt&&g.current>n?g.current=Math.abs(g.current-1)%10:e===Zt&&g.current<r+10?g.current+=1:(e===Zt?g.current===r+10:g.current===n)&&clearInterval(o),_(g.current%10)}),t);E.current=o}((t=Zt,Number(l)<a?t=Jt:Number(l)>a&&(t=Xt),t),o,Number(l),a),function(){clearTimeout(S.current),clearInterval(E.current)}}}),[r,l,a]),r?o().createElement("div",{className:"current-spot__display"},t&&o().createElement(je.E,{size:"xl",color:"quill-typography__color--prominent"},o().createElement(K.Localize,{i18n_default_text:"Tick {{current_tick}}",values:{current_tick:n}})),o().createElement("div",{className:"current-spot"},o().createElement(je.E,{size:"xl",bold:!0,color:"quill-typography__color--prominent"},r.slice(0,-1)),o().createElement("div",{className:"current-spot__last-digit-container"},o().createElement("div",{ref:w,className:(0,ke.A)("current-spot__last-digit-wrapper",s&&"current-spot__last-digit-wrapper--enter-from-top",f&&"current-spot__last-digit-wrapper--enter-from-bottom")},s&&o().createElement(Wt.D.H2,{color:"quill-typography__color--prominent",className:"current-spot__last-digit"},y),o().createElement(Wt.D.H2,{color:"quill-typography__color--prominent",className:"current-spot__last-digit"},h),f&&o().createElement(Wt.D.H2,{color:"quill-typography__color--prominent",className:"current-spot__last-digit"},y))))):null}));function er(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return tr(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?tr(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var rr=(0,ye.observer)((function(){var e,t,r,n,a=o().useRef(),l=(0,s.A)().contract_trade,c=l.last_contract,u=l.prev_contract,d=null!==(e=c.contract_info)&&void 0!==e&&e.entry_tick||!u?c:u,m=d.contract_info,p=void 0===m?{}:m,y=d.digits_info,_=void 0===y?{}:y,v=d.display_status,h=d.is_digit_contract,b=d.is_ended,g=(0,Ie.P)(),E=g.tick_data,S=g.symbol,w=p.contract_id,A=p.entry_tick,O=p.date_start,k=p.contract_type,x=p.tick_stream,C=p.underlying,T=(0,Oe.usePrevious)(w),j=null===(t=c.contract_info)||void 0===t||null===(r=t.tick_stream)||void 0===r?void 0:r.length,L=(0,Oe.usePrevious)(j),P=E,I=(0,i.isContractElapsed)(p,P),N=(0,i.isContractElapsed)(null==u?void 0:u.contract_info,P),D=!I&&P?v:null;if(O&&!I&&null!=x&&x.length){var M=(0,f.toJS)(x.slice(-1)[0]),z=M.epoch,R=M.tick,F=M.tick_display_value;P={ask:R,bid:R,epoch:z,pip_size:null==F?void 0:F.split(".")[1].length,quote:R,current_tick:x.length}}var U=P&&"current_tick"in P?P.current_tick:null,q=b&&h,V=q&&"won"===D,B=q&&"lost"===D,H=Object.keys(_).sort((function(e,t){return+e-+t})).map((function(e){return _[+e]})),G=o().useMemo((function(){return H.slice(-1)[0]||{}}),[H]),Y=P?+P.pip_size:null,W=null!==(n=P)&&void 0!==n&&n.quote&&Y?P.quote.toFixed(Y):null,$=W?+(W.split("").pop()||""):null,K=o().useMemo((function(){return V||B?G:{digit:$,spot:W}}),[V,B,$,W,G]),J=er(o().useState(U),2),X=J[0],Z=J[1],Q=er(o().useState(K.spot),2),ee=Q[0],te=Q[1],re=er(o().useState(!1),2),ne=re[0],oe=re[1],ae=!I&&P?Number(p.barrier):null,ie=(0,Re.yk)(k,ae,K.digit),le=h&&D&&K.spot&&!!A,ce=le&&!b,se=C===S||!C,ue=le&&se,de=!(null!=u&&u.contract_info&&(!N||1!==j||L)),fe=o().useCallback((function(){Z(U),te(K.spot)}),[U,K.spot]);return o().useEffect((function(){var e;(null==u?void 0:u.contract_info)&&!N&&(null===(e=c.contract_info)||void 0===e?void 0:e.entry_tick)&&T&&w&&T!==w?(oe(!0),a.current=setTimeout((function(){oe(!1),fe()}),240)):ne||fe()}),[w,N,c,u,T,fe,ne]),o().useEffect((function(){return function(){clearTimeout(a.current)}}),[]),o().createElement("div",{className:(0,ke.A)("trade__current-spot",ue&&"trade__current-spot--has-contract",ue&&de&&"trade__current-spot--enter-from-left",!ue&&I&&"trade__current-spot--enter-from-right",ce&&ie&&"trade__current-spot--winning",V&&"trade__current-spot--won",ce&&!ie&&"trade__current-spot--losing",B&&"trade__current-spot--lost")},P&&se&&ee?o().createElement("div",{className:(0,ke.A)("current-spot__wrapper",ne&&"current-spot__wrapper--enter-from-top")},ne&&o().createElement(Qt,{has_tick_count:!!le,spot:K.spot,tick:U}),o().createElement(Qt,{has_tick_count:!!le,spot:ee,tick:X})):o().createElement(Oe.Skeleton,{width:128,height:32}))}));const nr=rr;var or=r("../../node_modules/@deriv-com/quill-ui/dist/components/Tab/index.js"),ar=r("../../node_modules/@deriv-com/quill-ui/dist/components/Input/search-field/index.js"),ir=r("../../node_modules/@deriv-com/quill-ui/dist/components/Button/base/index.js"),lr=(0,ye.observer)((function(e){var t,r=e.isSearching,a=e.setIsSearching,l=e.searchValue,c=e.setSearchValue,u=(0,s.A)().ui.is_dark_mode_on,d=(0,Ie.P)().contract_type,f=null===(t=(0,i.getContractTypesConfig)()[d])||void 0===t?void 0:t.title,m=(0,n.useRef)(null);return(0,n.useEffect)((function(){var e=m.current;if(e){var t=function(){return a(!0)};return e.addEventListener("focus",t),function(){e.removeEventListener("focus",t)}}}),[]),o().createElement("div",{className:(0,ke.A)("symbols-search-field__container",{"symbols-search-field--is-focused":r})},o().createElement(ar.L,{inputSize:"sm",placeholder:(0,K.localize)("Search markets on ")+f,variant:"fill",ref:m,value:l,onChange:function(e){c(e.target.value)}}),r&&o().createElement(ir.$n,{variant:"tertiary",label:o().createElement(K.Localize,{i18n_default_text:"Cancel"}),size:"sm",color:u?"white":"black",onClick:function(){c(""),a(!1)}}))}));const cr=lr,sr=function(e){var t=["synthetic_index","forex","indices","cryptocurrency","commodities"].reduce((function(e,t,r){return e[t]=r,e}),{});return e.slice().sort((function(r,n){var o=void 0!==t[r.market]?t[r.market]:e.length,a=void 0!==t[n.market]?t[n.market]:e.length;return o!==a?o-a:r.submarket_display_name.localeCompare(n.submarket_display_name)}))};function ur(e){return ur="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ur(e)}function dr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function fr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?dr(Object(r),!0).forEach((function(t){mr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function mr(e,t,r){return(t=function(e){var t=function(e){if("object"!=ur(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=ur(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ur(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return yr(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?yr(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var _r=r("../../node_modules/@deriv-com/quill-ui/dist/hooks/useSnackbar.js"),vr=r("../../node_modules/@deriv-com/quill-ui/dist/components/Tag/index.js"),hr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Standalone/StandaloneStarRegularIcon.js"),br=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Standalone/StandaloneStarFillIcon.js"),gr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexAudcadIcon.js"),Er=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexAudchfIcon.js"),Sr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexAudjpyIcon.js"),wr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexAudnzdIcon.js"),Ar=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexAudusdIcon.js"),Or=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedAudBasketIcon.js"),kr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedBearIcon.js"),xr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedBoom1000Icon.js"),Cr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedBoom600Icon.js"),Tr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedBoom900Icon.js"),jr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedBoom300Icon.js"),Lr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedBoom500Icon.js"),Pr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedBullIcon.js"),Ir=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedCrash1000Icon.js"),Nr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedCrash600Icon.js"),Dr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedCrash900Icon.js"),Mr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedCrash300Icon.js"),zr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedCrash500Icon.js"),Rr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketCommoditySilverusdIcon.js"),Fr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketCommodityGoldusdIcon.js"),Ur=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketCommodityPalladiumusdIcon.js"),qr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketCommodityPlatinumusdIcon.js"),Vr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketCryptocurrencyBtcusdIcon.js"),Br=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketCryptocurrencyEthusdIcon.js"),Hr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedEurBasketIcon.js"),Gr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedGbpBasketIcon.js"),Yr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedGoldBasketIcon.js"),Wr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedJump10Icon.js"),$r=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedJump100Icon.js"),Kr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedJump25Icon.js"),Jr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedJump50Icon.js"),Xr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedJump75Icon.js"),Zr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedStepIndices100Icon.js"),Qr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedStepIndices200Icon.js"),en=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedStepIndices300Icon.js"),tn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedStepIndices400Icon.js"),rn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedStepIndices500Icon.js"),nn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedRangeBreak100Icon.js"),on=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedRangeBreak200Icon.js"),an=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedUsdBasketIcon.js"),ln=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedVolatility101sIcon.js"),cn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedVolatility1001sIcon.js"),sn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedVolatility1501sIcon.js"),un=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedVolatility2501sIcon.js"),dn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedVolatility251sIcon.js"),fn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedVolatility501sIcon.js"),mn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedVolatility751sIcon.js"),pn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedVolatility151sIcon.js"),yn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedVolatility301sIcon.js"),_n=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedVolatility901sIcon.js"),vn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexEuraudIcon.js"),hn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexEurcadIcon.js"),bn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexEurchfIcon.js"),gn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexEurgbpIcon.js"),En=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexEurjpyIcon.js"),Sn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexEurnzdIcon.js"),wn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexEurusdIcon.js"),An=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexGbpaudIcon.js"),On=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexGbpcadIcon.js"),kn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexGbpchfIcon.js"),xn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexGbpjpyIcon.js"),Cn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexGbpnokIcon.js"),Tn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexGbpnzdIcon.js"),jn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexGbpusdIcon.js"),Ln=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexNzdjpnIcon.js"),Pn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexNzdusdIcon.js"),In=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexUsdcadIcon.js"),Nn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexUsdchfIcon.js"),Dn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexUsdjpyIcon.js"),Mn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexUsdmxnIcon.js"),zn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexUsdnokIcon.js"),Rn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexUsdplnIcon.js"),Fn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexUsdsekIcon.js"),Un=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketIndicesAustralia200Icon.js"),qn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketIndicesEuro50Icon.js"),Vn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketIndicesFrance40Icon.js"),Bn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketIndicesGerman40Icon.js"),Hn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketIndicesHongKong50Icon.js"),Gn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketIndicesJapan225Icon.js"),Yn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketIndicesNetherlands25Icon.js"),Wn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketIndicesSwiss20Icon.js"),$n=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketIndicesUk100Icon.js"),Kn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketIndicesUs500Icon.js"),Jn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketIndicesUsTech100Icon.js"),Xn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketIndicesWallStreet30Icon.js"),Zn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedVolatility10Icon.js"),Qn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedVolatility100Icon.js"),eo=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedVolatility25Icon.js"),to=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedVolatility50Icon.js"),ro=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedVolatility75Icon.js"),no={frxAUDCAD:gr.A,frxAUDCHF:Er.A,frxAUDJPY:Sr.A,frxAUDNZD:wr.A,frxAUDUSD:Ar.A,WLDAUD:Or.A,RDBEAR:kr.A,BOOM1000:xr.A,BOOM600:Cr.A,BOOM900:Tr.A,BOOM300N:jr.A,BOOM500:Lr.A,RDBULL:Pr.A,CRASH1000:Ir.A,CRASH600:Nr.A,CRASH900:Dr.A,CRASH300N:Mr.A,CRASH500:zr.A,frxXAGUSD:Rr.A,frxXAUUSD:Fr.A,frxXPDUSD:Ur.A,frxXPTUSD:qr.A,cryBTCUSD:Vr.A,cryETHUSD:Br.A,WLDEUR:Hr.A,WLDGBP:Gr.A,WLDXAU:Yr.A,JD10:Wr.A,JD100:$r.A,JD25:Kr.A,JD50:Jr.A,JD75:Xr.A,stpRNG:Zr.A,stpRNG2:Qr.A,stpRNG3:en.A,stpRNG4:tn.A,stpRNG5:rn.A,RB100:nn.A,RB200:on.A,WLDUSD:an.A,"1HZ10V":ln.A,"1HZ100V":cn.A,"1HZ150V":sn.A,"1HZ250V":un.A,"1HZ25V":dn.A,"1HZ50V":fn.A,"1HZ75V":mn.h,"1HZ15V":pn.A,"1HZ30V":yn.A,"1HZ90V":_n.A,frxEURAUD:vn.A,frxEURCAD:hn.A,frxEURCHF:bn.A,frxEURGBP:gn.A,frxEURJPY:En.A,frxEURNZD:Sn.A,frxEURUSD:wn.A,frxGBPAUD:An.A,frxGBPCAD:On.A,frxGBPCHF:kn.A,frxGBPJPY:xn.A,frxGBPNOK:Cn.A,frxGBPNZD:Tn.A,frxGBPUSD:jn.A,frxNZDJPY:Ln.A,frxNZDUSD:Pn.A,frxUSDCAD:In.A,frxUSDCHF:Nn.A,frxUSDJPY:Dn.A,frxUSDMXN:Mn.A,frxUSDNOK:zn.A,frxUSDPLN:Rn.A,frxUSDSEK:Fn.A,OTC_AS51:Un.A,OTC_SX5E:qn.A,OTC_FCHI:Vn.A,OTC_GDAXI:Bn.A,OTC_HSI:Hn.A,OTC_N225:Gn.A,OTC_AEX:Yn.A,OTC_SSMI:Wn.A,OTC_FTSE:$n.A,OTC_SPC:Kn.A,OTC_NDX:Jn.A,OTC_DJI:Xn.A,R_10:Zn.A,R_100:Qn.A,R_25:eo.A,R_50:to.A,R_75:ro.A};const oo=function(e){var t=e.symbol,r=no[t];return r?o().createElement(r,{iconSize:"md"}):null};var ao=r("./src/Stores/useModulesStores.tsx");function io(e){return io="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},io(e)}function lo(){lo=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),l=new j(n||[]);return o(i,"_invoke",{value:k(e,r,l)}),i}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",m="suspendedYield",p="executing",y="completed",_={};function v(){}function h(){}function b(){}var g={};s(g,i,(function(){return this}));var E=Object.getPrototypeOf,S=E&&E(E(L([])));S&&S!==r&&n.call(S,i)&&(g=S);var w=b.prototype=v.prototype=Object.create(g);function A(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function r(o,a,i,l){var c=d(e[o],e,a);if("throw"!==c.type){var s=c.arg,u=s.value;return u&&"object"==io(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,i,l)}),(function(e){r("throw",e,i,l)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return r("throw",e,i,l)}))}l(c.arg)}var a;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function k(t,r,n){var o=f;return function(a,i){if(o===p)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var l=n.delegate;if(l){var c=x(l,n);if(c){if(c===_)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var s=d(t,r,n);if("normal"===s.type){if(o=n.done?y:m,s.arg===_)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=y,n.method="throw",n.arg=s.arg)}}}function x(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),_;var a=d(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,_;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,_):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,_)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(io(t)+" is not iterable")}return h.prototype=b,o(w,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:h,configurable:!0}),h.displayName=s(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,s(e,c,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},A(O.prototype),s(O.prototype,l,(function(){return this})),t.AsyncIterator=O,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new O(u(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},A(w),s(w,c,"Generator"),s(w,i,(function(){return this})),s(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return l.type="throw",l.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],l=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(c&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,_):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),_}},t}function co(e,t,r,n,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,o)}function so(e,t){if(e){if("string"==typeof e)return uo(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?uo(e,t):void 0}}function uo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var fo=(0,n.forwardRef)((function(e,t){var r=e.item,a=e.selectedSymbol,l=e.setSelectedSymbol,c=e.setIsOpen,s=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||so(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,n.useState)(!1),2),u=s[0],d=s[1],f=(0,Ie.P)().onChange,m=(0,ao.q)().markets,p=m.favoriteSymbols,y=m.setFavoriteSymbols,_=m.removeFavoriteSymbol,v=(0,_r.d)().addSnackbar;(0,n.useEffect)((function(){d(p.includes(r.symbol))}),[p,r.symbol]);var h=function(){var e,t=(e=lo().mark((function e(t){return lo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(t),e.next=3,f({target:{name:"symbol",value:t}});case 3:c(!1);case 4:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){co(a,n,o,i,l,"next",e)}function l(e){co(a,n,o,i,l,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}(),b=function(e){var t=(null==e?void 0:e.currentTarget).getAttribute("data-symbol")||"";(0,i.clickAndKeyEventHandler)((function(){return h(t)}),e)},g=function(e){var t=(null==e?void 0:e.currentTarget).getAttribute("data-symbol")||"";(0,i.clickAndKeyEventHandler)((function(){return function(e){e&&(-1!==p.indexOf(e)?(_(e),v({icon:o().createElement(hr.A,{fill:"var(--component-snackbar-icon-neutral)",iconSize:"sm"}),message:o().createElement(K.Localize,{i18n_default_text:"Removed from favourites"}),hasCloseButton:!1})):(y([].concat(function(e){return function(e){if(Array.isArray(e))return uo(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||so(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(p),[e])),v({icon:o().createElement(br.A,{fill:"var(--core-color-solid-mustard-700)",iconSize:"sm"}),message:o().createElement(K.Localize,{i18n_default_text:"Added to favourites"}),hasCloseButton:!1})),d(p.includes(e)))}(t)}),e)};return o().createElement("div",{className:(0,ke.A)("market-category-item",{"market-category-item--selected":a===r.symbol}),ref:t},o().createElement("span",{className:"market-category-item-left","data-symbol":r.symbol,onClick:b,onKeyDown:b},o().createElement(oo,{symbol:r.symbol}),o().createElement(je.E,{size:"sm",className:(0,ke.A)("market-category-item-symbol",{"market-category-item-symbol--selected":a===r.symbol})},o().createElement("span",null,r.display_name)),!r.exchange_is_open&&o().createElement(vr.v,{label:o().createElement(K.Localize,{key:"exchange-closed",i18n_default_text:"CLOSED"}),color:"error",variant:a===r.symbol?"outline":"fill",showIcon:!1})),o().createElement("span",{onClick:g,onKeyDown:g,"data-symbol":r.symbol},u?o().createElement(br.A,{fill:"var(--core-color-solid-mustard-700)",iconSize:"sm"}):o().createElement(hr.A,{fill:a===r.symbol?"var(--semantic-color-slate-solid-textIcon-inverse-highest)":"var(--semantic-color-monochrome-textIcon-normal-mid)",iconSize:"sm"})))}));fo.displayName="MarketCategoryItem";const mo=(0,ye.observer)(fo),po=function(){return o().createElement("div",{className:"favorite-symbols--no-fav"},o().createElement(br.A,{fill:"var(--semantic-color-slate-solid-surface-static-midLowest)",iconSize:"2xl"}),o().createElement(je.E,{size:"lg",bold:!0,color:"quill-typography__color--subtle"},o().createElement(K.Localize,{i18n_default_text:"No favourites"})),o().createElement(je.E,{size:"sm",color:"quill-typography__color--subtle"},o().createElement(K.Localize,{i18n_default_text:"Your favourite markets will appear here."})))},yo=(0,ye.observer)((function(e){var t=e.selectedSymbol,r=e.setSelectedSymbol,a=e.setIsOpen,i=function(){var e=Pt().activeSymbols,t=(0,ao.q)().markets.favoriteSymbols,r=(0,n.useMemo)((function(){return null==t?void 0:t.map((function(t){return e.find((function(e){return e.symbol===t}))})).filter((function(e){return void 0!==e}))}),[e,t]);return(0,n.useMemo)((function(){return sr(r)}),[r])}();return o().createElement(o().Fragment,null,i.length>0?o().createElement("div",{className:"favorite-symbols__container"},i.map((function(e){return o().createElement(mo,{key:null==e?void 0:e.display_name,item:e,selectedSymbol:t,setSelectedSymbol:r,setIsOpen:a})}))):o().createElement(po,null))}));function _o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return vo(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?vo(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const ho=function(e){var t=e.category,r=e.selectedSymbol,a=e.setSelectedSymbol,i=e.setIsOpen,l=e.isOpen,c=(0,n.useRef)({}),s=(0,Oe.usePrevious)(r);return(0,n.useEffect)((function(){var e;l&&"all"===t.market&&r&&c.current[r]&&!s&&(null===(e=c.current[r])||void 0===e||e.scrollIntoView({block:"center"}))}),[l,t.market,r,s]),o().createElement(or.o.Panel,{key:t.market_display_name},"favorites"!==t.market?Object.entries(t.subgroups).map((function(e){var n=_o(e,2),l=n[0],s=n[1];return o().createElement("div",{key:l,className:"market-category-content__container"},"none"!==l&&o().createElement("div",{className:"market-category-title__container"},o().createElement(je.E,{size:"sm",className:"market-category-title"},t.subgroups[l].subgroup_display_name)),Object.entries(s.submarkets).map((function(e){var t=_o(e,2),n=t[0],l=t[1];return o().createElement("div",{className:"market-category-body",key:n},o().createElement(It.O,{size:"sm",className:"market-category-subtitle"},l.submarket_display_name),o().createElement("div",{className:"market-category-items"},l.items.map((function(e){return o().createElement(mo,{key:e.display_name,ref:e.symbol===r?function(t){return c.current[e.symbol]=t}:void 0,item:e,selectedSymbol:r,setSelectedSymbol:a,setIsOpen:i})}))))})))})):o().createElement("div",null,o().createElement(yo,{selectedSymbol:r,setSelectedSymbol:a,setIsOpen:i})))},bo=function(e){var t=e.category;return o().createElement(or.o.Trigger,{key:t.market_display_name},"indices"===t.market?o().createElement(K.Localize,{i18n_default_text:"Stocks & indices"}):t.market_display_name)},go=(0,ye.observer)((function(e){var t=e.selectedSymbol,r=e.setSelectedSymbol,n=e.setIsOpen,a=e.isOpen,i=e.marketCategoriesRef,l=function(e){if(0===e.length)return{};var t=sr(e).reduce((function(e,t){var r,n,o,a,i,l=t.market,c=t.market_display_name,s=t.subgroup,u=t.subgroup_display_name,d=t.submarket,f=t.submarket_display_name;return null!==(r=e[l])&&void 0!==r||(e[l]={market:l,market_display_name:c,subgroups:{}}),null!==(o=(n=e[l].subgroups)[s])&&void 0!==o||(n[s]={subgroup_display_name:u,submarkets:{}}),null!==(i=(a=e[l].subgroups[s].submarkets)[d])&&void 0!==i||(a[d]={submarket_display_name:f,items:[]}),e[l].subgroups[s].submarkets[d].items.push(t),e}),{});Object.keys(t).forEach((function(e){Object.keys(t[e].subgroups).forEach((function(r){var n=t[e].subgroups[r].submarkets,o=Object.entries(n).sort((function(e,t){var r=pr(e,2)[1],n=pr(t,2)[1];return r.submarket_display_name.localeCompare(n.submarket_display_name)})).reduce((function(e,t){var r=pr(t,2),n=r[0],o=r[1];return e[n]=o,e}),{});t[e].subgroups[r].submarkets=o}))}));var r=Object.values(t).reduce((function(e,t){return Object.keys(t.subgroups).forEach((function(r){var n="none"===r?t.market:r,o="none"===r?t.market_display_name:t.subgroups[r].subgroup_display_name;e[n]={subgroup_display_name:o,submarkets:t.subgroups[r].submarkets}})),e}),{});return t=fr({favorites:{market:"favorites",market_display_name:(0,K.localize)("Favourites"),subgroups:{}},all:{market:"all",market_display_name:(0,K.localize)("All"),subgroups:fr({},r)}},t)}(Pt().activeSymbols);return o().createElement(o().Fragment,null,o().createElement(or.o.List,null,Object.values(l).map((function(e){return o().createElement(bo,{key:e.market,category:e})}))),o().createElement(or.o.Content,{className:"market-categories__list",ref:i},Object.values(l).map((function(e){return o().createElement(ho,{key:e.market,category:e,selectedSymbol:t,setSelectedSymbol:r,setIsOpen:n,isOpen:a})}))))})),Eo=function(e){var t=e.searchTerm;return o().createElement("div",{className:"symbol-not-found__container"},o().createElement("div",{className:"symbol-not-found__content"},o().createElement(je.E,{size:"lg",bold:!0,color:"quill-typography__color--subtle"},(0,K.localize)("No results for {{searchTerm}}",{searchTerm:t,interpolation:{escapeValue:!1}})),o().createElement(je.E,{size:"sm",color:"quill-typography__color--subtle"},o().createElement(K.Localize,{i18n_default_text:"Try searching for something else."}))))},So=(0,ye.observer)((function(e){var t=e.searchValue,r=e.setIsOpen,a=e.setSelectedSymbol,i=function(e){var t=Pt().activeSymbols,r=(0,n.useMemo)((function(){return""===e.trim()?[]:t.filter((function(t){return t.display_name.toLowerCase().includes(e.toLowerCase())}))}),[e,t]);return(0,n.useMemo)((function(){return sr(r)}),[r])}(t);return o().createElement("div",{className:"symbol-search-results__container"},""===t&&o().createElement(je.E,{size:"sm",color:"quill-typography__color--subtle",className:"symbol-search-results--suggestion"},o().createElement(K.Localize,{i18n_default_text:"Try searching for markets or keywords"})),""!==t&&(i.length>0?i.map((function(e){return o().createElement(mo,{key:null==e?void 0:e.display_name,item:e,selectedSymbol:"",setSelectedSymbol:a,setIsOpen:r})})):o().createElement(Eo,{searchTerm:t})))}));var wo=r("./src/Analytics/index.ts");function Ao(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Oo(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Oo(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Oo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var ko=(0,ye.observer)((function(e){var t=e.isOpen,r=e.setIsOpen,a=(0,Ie.P)(),i=a.setTickData,l=a.setDigitStats,c=a.symbol,s=a.contract_type,u=Ao((0,n.useState)(!1),2),d=u[0],f=u[1],m=Ao((0,n.useState)(c),2),p=m[0],y=m[1],_=Ao((0,n.useState)(""),2),v=_[0],h=_[1],b=(0,n.useRef)(null);return(0,n.useEffect)((function(){y(c),i(null),l([])}),[l,i,c]),o().createElement(o().Fragment,null,o().createElement(Le.A.Root,{isOpen:t,onClose:function(){return r(!1)}},o().createElement(Le.A.Portal,{shouldCloseOnDrag:!0,fullHeightOnOpen:!0},o().createElement(cr,{searchValue:v,setSearchValue:h,isSearching:d,setIsSearching:f}),o().createElement(or.o.Container,{contentStyle:"hug",size:"md",className:"active-symbols-list__content",selectedTabIndex:1,onChangeTab:function(e){var t;1!==e&&(null===(t=b.current)||void 0===t||t.scrollTo({top:0}))}},d?o().createElement(So,{searchValue:v,setSearchValue:h,setIsOpen:r,setSelectedSymbol:function(e){(0,wo.iN)(e,s),y(e)}}):o().createElement(go,{selectedSymbol:p,setSelectedSymbol:function(e){(0,wo.iN)(e,s),y(e)},setIsOpen:r,isOpen:t,marketCategoriesRef:b})))))}));const xo=ko;var Co=r("../../node_modules/@deriv/quill-icons/dist/esm/react/LabelPaired/LabelPairedChevronDownMdRegularIcon.js");function To(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var jo=(0,ye.observer)((function(){var e,t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return To(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?To(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,n.useState)(!1),2),r=t[0],a=t[1],l=Pt().activeSymbols,c=(0,Ie.P)(),s=c.symbol,u=c.tick_data,d=c.is_market_closed,f=c.contract_type,m=(0,_r.d)().addSnackbar,p=Ot().trade_types,y=l.find((function(e){return e.symbol===s})),_=null==p||null===(e=p.find((function(e){return e.value===f})))||void 0===e?void 0:e.text;(0,n.useEffect)((function(){if(!y){var e=(0,i.getMarketNamesMap)()[s]||s,t=_?o().createElement(K.Localize,{i18n_default_text:"".concat(e," is unavailable for ").concat(_,"."),values:{symbol_name:e,contract_name:_}}):o().createElement(K.Localize,{i18n_default_text:"".concat(e," is unavailable."),values:{symbol_name:e}});e&&m({message:t,status:"neutral",hasCloseButton:!0,hasFixedHeight:!1,style:{marginBottom:"0",width:"calc(100% - var(--core-spacing-800)"}})}}),[y,s,_]);var v=null!=u?u:{},h=v.pip_size,b=v.quote,g=null==b?void 0:b.toFixed(h),E=d?o().createElement(je.E,null,"-"):o().createElement(ze.E.Square,{height:18,width:64,rounded:!0});return void 0===(null==y?void 0:y.exchange_is_open)?o().createElement(ze.E.Square,{height:42,width:240,rounded:!0}):o().createElement(o().Fragment,null,o().createElement("div",{className:"market-selector__container",onClick:function(){return a(!0)}},o().createElement("div",{className:"market-selector"},o().createElement(oo,{symbol:s}),o().createElement("div",{className:"market-selector-info"},o().createElement("div",{className:"market-selector-info__label"},o().createElement(je.E,{bold:!0},null==y?void 0:y.display_name),!(null!=y&&y.exchange_is_open)&&o().createElement(vr.v,{label:o().createElement(K.Localize,{key:"closed",i18n_default_text:"CLOSED"}),color:"error",variant:"fill",showIcon:!1,size:"sm"}),o().createElement(Co.A,{fill:"var(--component-textIcon-normal-default"})),g?o().createElement(It.O,{className:"market-selector-info__price"},g):E))),o().createElement(xo,{isOpen:r,setIsOpen:a}))}));const Lo=jo;var Po=r("../../node_modules/react-joyride/dist/index.mjs"),Io=r("../../node_modules/@deriv-com/quill-ui/dist/components/Button/icon-button/index.js"),No=r("../../node_modules/@deriv/quill-icons/dist/esm/react/LabelPaired/LabelPairedChevronsUpXlBoldIcon.js"),Do=r("../../node_modules/@deriv/quill-icons/dist/esm/react/LabelPaired/LabelPairedXmarkSmBoldIcon.js"),Mo=r("../../node_modules/react-swipeable/dist/react-swipeable.umd.js");function zo(){return zo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zo.apply(null,arguments)}const Ro=function(e){var t=e.isLastStep,r=e.primaryProps,n=e.skipProps,a=e.step,i=e.tooltipProps,l=e.setStepIndex,c=(0,Mo.useSwipeable)({onSwipedUp:function(){var e;null===(e=document.querySelector(".trade__chart"))||void 0===e||e.scrollIntoView(),l((function(e){return e+1}))},preventDefaultTouchmoveEvent:!0,trackTouch:!0,trackMouse:!0});return"scroll-icon"===a.title?o().createElement("div",zo({},c,{className:"guide-tooltip__wrapper-scroll"}),o().createElement(No.A,{className:"guide-tooltip--bounce"}),o().createElement(je.E,{size:"sm",bold:!0,className:"guide-tooltip__wrapper-scroll-text"},o().createElement(K.Localize,{i18n_default_text:"Swipe up to see the chart"}))):o().createElement("div",zo({},i,{className:"guide-tooltip__wrapper"}),o().createElement("div",null,a.title&&o().createElement("div",{className:"guide-tooltip__header"},o().createElement(It.O,{bold:!0,className:"guide-tooltip__header__title"},a.title),o().createElement(Io.K,{onClick:n.onClick,icon:o().createElement(Do.A,{fill:"var(--component-textIcon-inverse-prominent)",key:"close-button"}),className:"guide-tooltip__close",size:"sm",color:"white-black",variant:"tertiary"})),a.content&&o().createElement(It.O,{className:"guide-tooltip__content"},a.content)),o().createElement(ir.$n,{onClick:function(e){l((function(e){return e+1})),r.onClick(e)},color:"white-black",className:"guide-tooltip__button",variant:"secondary",size:"sm",label:t?o().createElement(K.Localize,{i18n_default_text:"Done"}):o().createElement(K.Localize,{i18n_default_text:"Next"})}))},Fo=[{content:o().createElement(K.Localize,{i18n_default_text:"Scroll left or right to explore trade types."}),offset:0,spotlightPadding:2,target:".trade__trade-types",title:o().createElement(K.Localize,{i18n_default_text:"Explore trade types (1/6)"})},{content:o().createElement(K.Localize,{i18n_default_text:"View available markets here."}),offset:4,placement:"bottom-start",spotlightPadding:8,target:".market-selector__container",title:o().createElement(K.Localize,{i18n_default_text:"Choose a market (2/6)"})},{content:o().createElement(K.Localize,{i18n_default_text:"Specify your trade parameters."}),offset:4,spotlightPadding:8,target:".trade-params",title:o().createElement(K.Localize,{i18n_default_text:"Open your trade (3/6)"})},{content:"",disableBeacon:!1,offset:0,spotlightPadding:0,styles:{spotlight:{display:"none"},arrow:{display:"none"}},target:"#react-joyride-portal",title:"scroll-icon"},{content:o().createElement(K.Localize,{i18n_default_text:"Track market trends with our interactive charts."}),spotlightPadding:8,offset:4,target:".trade__chart-tooltip",title:o().createElement(K.Localize,{i18n_default_text:"Analyse with charts (4/6)"}),placement:"bottom"},{content:o().createElement(K.Localize,{i18n_default_text:"Scroll left or right to adjust your trade parameters."}),disableScrolling:!1,offset:-4,target:".trade__parameter",title:o().createElement(K.Localize,{i18n_default_text:"Make quick adjustments (5/6)"})},{content:o().createElement(K.Localize,{i18n_default_text:"View your positions here."}),offset:-4,target:".user-guide__anchor",title:o().createElement(K.Localize,{i18n_default_text:"Check your positions (6/6)"})}];function Uo(){return Uo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Uo.apply(null,arguments)}function qo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Vo=o().memo((function(e){var t=e.should_run,r=e.onFinishGuide,n=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return qo(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?qo(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o().useState(0),2),a=n[0],i=n[1];return o().createElement(Po.Ay,{continuous:!0,callback:function(e){var t=e.status,n=e.step;0===e.index&&(n.disableBeacon=!0),[Po.XQ.FINISHED,Po.XQ.SKIPPED].includes(t)&&r()},disableCloseOnEsc:!0,disableOverlayClose:!0,disableScrolling:!0,floaterProps:{styles:{arrow:{length:4,spread:8,display:3===a?"none":"inline-flex"}}},run:t,showSkipButton:!0,steps:Fo,spotlightPadding:0,scrollToFirstStep:!0,styles:{options:{arrowColor:"var(--component-textIcon-normal-prominent)",overlayColor:"var(--core-color-opacity-black-600)"},spotlight:{borderRadius:"unset"}},stepIndex:a,tooltipComponent:function(e){return o().createElement(Ro,Uo({},e,{setStepIndex:i}))}})}));function Bo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Ho=function(e){var t=e.type,r=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Bo(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Bo(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o().useState(!0),2),n=r[0],a=r[1],l=o().useCallback((function(e){return(0,i.getUrlBase)("/public/videos/user-onboarding-guide-".concat(t.replaceAll("_","-"),".").concat(e))}),[t]),c=o().useMemo((function(){return l("mp4")}),[l]);return o().createElement("div",{className:(0,ke.A)("guide__player__wrapper",n&&"guide__player__wrapper--is-loading")},n&&o().createElement(ze.E.Square,{height:"calc(100vw * ".concat(Fe,")")}),o().createElement("video",{autoPlay:!0,className:"guide__player","data-testid":"dt_onboarding_guide_video",muted:!0,loop:!0,onLoadedData:function(){return a(!1)},playsInline:!0,preload:"auto"},o().createElement("source",{src:c,type:"video/mp4"}),o().createElement(K.Localize,{i18n_default_text:"Unfortunately, your browser does not support the video."})))};function Go(e){return Go="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Go(e)}function Yo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Wo(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Yo(Object(r),!0).forEach((function(t){$o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yo(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function $o(e,t,r){return(t=function(e){var t=function(e){if("object"!=Go(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Go(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Go(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ko(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Jo(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Jo(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Xo=o().memo((function(e){var t=e.type,r=void 0===t?"trade_page":t,n=e.is_dark_mode_on,a=e.callback,i=Ko(o().useState(!1),2),l=i[0],c=i[1],s=Ko(o().useState(!1),2),u=s[0],d=s[1],f=o().useRef(),m=o().useRef(!1),p=Ko(Te("guide_dtrader_v2",{trade_types_selection:!1,trade_page:!1,positions_page:!1}),2),y=p[0],_=p[1],v="trade_page"===r,h=o().useCallback((function(){d(!1),_(Wo(Wo({},y),{},$o({},r,!0))),null==a||a()}),[_]),b=function(){m.current||(h(),c(!1))},g=Wo({image:o().createElement(Ho,{type:n?"".concat(r,"_dark"):r}),title:o().createElement(K.Localize,{i18n_default_text:"View your positions"}),content:o().createElement(K.Localize,{i18n_default_text:"You can view your open and closed positions here. Tap an item for more details."}),button_label:o().createElement(K.Localize,{i18n_default_text:"Got it"}),primaryButtonCallback:b},v?{title:o().createElement(K.Localize,{i18n_default_text:"Welcome to the new Deriv Trader"}),content:o().createElement(K.Localize,{i18n_default_text:"Enjoy a smoother, more intuitive trading experience. Here’s a quick tour to get you started."}),button_label:o().createElement(K.Localize,{i18n_default_text:"Let's begin"}),primaryButtonCallback:function(){m.current=!0,d(!0),c(!1)}}:{});return o().useEffect((function(){return null!=y&&y[r]||(f.current=setTimeout((function(){return c(!0)}),800)),function(){return clearTimeout(f.current)}}),[null==y?void 0:y[r]]),o().createElement(o().Fragment,null,o().createElement(Le.M,{isOpened:l,isNonExpandable:!0,isMobile:!0,showHandleBar:!0,shouldCloseModalOnSwipeDown:!0,toggleModal:b,primaryButtonLabel:g.button_label,primaryButtonCallback:g.primaryButtonCallback},o().createElement(Le.M.Header,{image:g.image,title:g.title}),o().createElement(Le.M.Body,null,g.content)),v&&o().createElement(Vo,{should_run:u,onFinishGuide:h}))}));var Zo=r("../../node_modules/@deriv-com/ui/dist/hooks/useDevice.js"),Qo=r("../hooks/src/useMFAccountStatus.ts");const ea=function(e){var t=e.currency,r=e.has_open_accu_contract,n=e.has_no_button_content,a=e.info,l=e.is_multiplier,c=e.is_turbos,s=e.is_vanilla,u=e.is_reverse;if(n)return null;var d=(0,i.getLocalizedBasis)(),f=d.payout,m=d.stake,p=l?m:f,y=function(){var e=a.stake,t=a.obj_contract_basis;return l?e:null==t?void 0:t.value}(),_=!p||!y;return o().createElement(It.O,{size:"sm",className:(0,ke.A)("purchase-button__information__wrapper",u&&"purchase-button__information__wrapper--reverse",_&&"purchase-button__information__wrapper--disabled-placeholder"),"data-testid":"dt_purchase_button_wrapper"},!_&&o().createElement(o().Fragment,null,o().createElement(It.O,{as:"span",size:"sm",className:(0,ke.A)(!r&&"purchase-button__information__item"),color:"quill-typography__color--prominent"},p),o().createElement(It.O,{as:"span",size:"sm",className:(0,ke.A)(!r&&"purchase-button__information__item"),color:"quill-typography__color--prominent"},o().createElement(Oe.Money,{amount:y,currency:t,should_format:!c&&!s,show_currency:!0}))))};var ta=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Standalone/StandaloneStopwatchRegularIcon.js"),ra=r("../../node_modules/react-transition-group/esm/CSSTransition.js");function na(e){return na="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},na(e)}function oa(){return oa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},oa.apply(null,arguments)}function aa(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ia(e,t,r){return(t=function(e){var t=function(e){if("object"!=na(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=na(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==na(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function la(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ca(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ca(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ca(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var sa="stake",ua=(0,ye.observer)((function(){var e=la(o().useState(null),2),t=e[0],r=e[1],n=(0,Zo.Y)().isMobile,a=(0,_e.E)().addBanner,l=(0,s.A)(),c=l.portfolio,u=c.all_positions,d=c.onClickSell,f=c.open_accu_contract,m=c.active_positions,p=l.client.is_logged_in,y=l.common.services_error,_=l.ui,v=_.is_mf_verification_pending_modal_visible,h=_.setIsMFVericationPendingModal,b=(0,Ie.P)(),g=b.basis,E=b.basis_list,S=b.contract_type,w=b.currency,A=b.has_open_accu_contract,O=b.is_accumulator,k=b.is_multiplier,x=b.is_purchase_enabled,C=b.is_touch,T=b.is_trade_enabled_v2,j=b.is_turbos,L=b.is_vanilla_fx,P=b.is_vanilla,I=b.proposal_info,N=b.purchase_info,D=b.onPurchaseV2,M=b.onChange,z=b.symbol,R=b.trade_type_tab,F=b.trade_types,U=la(o().useState(O&&A),2),q=U[0],V=U[1],B=la(o().useState(450),2),H=B[0],G=B[1],Y=(0,Oe.usePrevious)(!!f&&!!m.find((function(e){var t=e.contract_info,r=e.type;return(0,i.isAccumulatorContract)(r)&&t.underlying===z}))),W=(0,Qo.A)(),$=o().useMemo((function(){return E.length?E.map((function(e){return e.value})):[]}),[E]),K=/^high_low$/.test(S.toLowerCase()),J={currency:w,has_open_accu_contract:A,is_multiplier:k,is_turbos:j,is_vanilla:P},X=P||L||j||K||C||O&&!A,Z=(0,Et.H1)(F,S,R),Q=O?u.find((function(e){var t=e.contract_info,r=e.type;return(0,i.isAccumulatorContract)(r)&&t.underlying===z&&!t.is_sold})):void 0,ee=!(null==Q||!Q.contract_info)&&(0,i.hasContractEntered)(Q.contract_info)&&(0,i.isOpen)(Q.contract_info)&&(0,i.isValidToSell)(Q.contract_info),te=ee&&Q&&(0,i.getIndicativePrice)(Q.contract_info)||null,re=(0,i.getCardLabelsV2)(),ne=Ye({services_error:y,is_mf_verification_pending_modal_visible:v}),oe=!ee||(null==Q?void 0:Q.is_sell_requested),ae=function(e,t){var r=(0,Re.FN)(S).findIndex((function(e){return e.contract_type===t}));return(r<0?e:r)?"sell":"purchase"},ie=function(e,t){return(0,wo.Dr)(S,z,t),a(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?aa(Object(r),!0).forEach((function(t){ia(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aa(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({icon:o().createElement(ta.A,{iconSize:"sm",className:"trade-notification--purchase",key:"contract-opened"})},e))};return o().useEffect((function(){x&&r(null)}),[x]),o().useEffect((function(){"payout"===g&&$.length>1&&$.includes(sa)&&M({target:{value:sa,name:"basis"}})}),[g,$]),o().useEffect((function(){G(!Y&&A||Y&&!A&&O?450:0),V(!!O&&A)}),[O,A]),o().createElement(o().Fragment,null,o().createElement(ra.A,{in:!q,timeout:H,classNames:"slide",key:"purchase-button",unmountOnExit:!0,mountOnEnter:!0},o().createElement("div",{className:(0,ke.A)("purchase-button__wrapper",{"purchase-button__wrapper__un-auth":!p})},Z.map((function(e,a){var l=(null==I?void 0:I[e])||{},c=1===Z.length,s=t===a,u=!T||l.has_error||!!N.error&&!ne;return o().createElement(o().Fragment,{key:e},o().createElement(ir.$n,{color:ae(a,e),size:"lg",label:(0,i.getContractTypeDisplay)(e,{isHighLow:K,showButtonName:!0}),fullWidth:!0,className:(0,ke.A)("purchase-button",s&&"purchase-button--loading",c&&"purchase-button--single"),isLoading:s,isOpaque:!0,disabled:u&&!s,onClick:function(){k&&W===i.MT5_ACCOUNT_STATUS.PENDING?h(!0):(r(a),D(e,n,ie))}},!s&&o().createElement(ea,oa({},J,{has_no_button_content:X,info:l,is_reverse:!!a}))))})))),o().createElement(ra.A,{in:q,timeout:H,classNames:"slide",key:"sell-button",unmountOnExit:!0,mountOnEnter:!0},o().createElement("div",{className:"purchase-button__wrapper"},o().createElement(ir.$n,{color:"black-white",size:"lg",label:oe?"".concat(re.CLOSE):"".concat(re.CLOSE," ").concat(te," ").concat(w),fullWidth:!0,isOpaque:!0,isLoading:null==Q?void 0:Q.is_sell_requested,className:"purchase-button purchase-button--single",disabled:!ee,onClick:function(){return d(null==Q?void 0:Q.contract_info.contract_id)}}))))}));const da=ua;var fa=r("../hooks/node_modules/js-cookie/src/js.cookie.js"),ma=r.n(fa),pa=r("../api/src/hooks/useRemoteConfig.ts");const ya=function(e){var t=e.error_type,r=e.services_error_message,n=function(){switch(t){case Ve:return{title:o().createElement(K.Localize,{i18n_default_text:"Insufficient balance"}),text:r||o().createElement(K.Localize,{i18n_default_text:"An error occurred."})};case Be:return{title:o().createElement(K.Localize,{i18n_default_text:"Start trading with us"}),text:o().createElement(K.Localize,{i18n_default_text:"Log in or create a free account to place a trade."})};case He:return{title:o().createElement(K.Localize,{i18n_default_text:"Account verification required"}),text:o().createElement(K.Localize,{i18n_default_text:"Please submit your proof of identity and proof of address to verify your account and continue trading."})};case Ge:return{title:o().createElement(K.Localize,{i18n_default_text:"Pending verification"}),text:o().createElement(K.Localize,{i18n_default_text:"You cannot trade as your documents are still under review. We will notify you by email once your verification is approved."})};default:return{}}}()||{},a=n.title,i=n.text;return o().createElement(o().Fragment,null,o().createElement(je.E,{size:"lg",bold:!0,className:"service-error-sheet__body__heading"},a),o().createElement(je.E,null,i))};function _a(){return _a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_a.apply(null,arguments)}function va(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const ha=(0,ye.observer)((function(){var e=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return va(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?va(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,n.useState)(!1),2),t=e[0],r=e[1],a=(0,s.A)(),l=a.common,c=a.client,u=a.ui,d=u.is_mf_verification_pending_modal_visible,f=u.setIsMFVericationPendingModal,m=c.has_wallet,p=c.is_virtual,y=l.services_error,_=l.resetServicesError,v=(0,Ie.P)(),h=v.clearPurchaseInfo,b=v.requestProposal,g=(0,ft.useHistory)(),E=function(){var e,t,r=(0,pa.A)(!0).data,n=null!==(e=null==r?void 0:r.hub_enabled_country_list)&&void 0!==e?e:[],o=(0,s.A)().client,a=o.account_settings,i=o.clients_country,l=(null===(t=JSON.parse(ma().get("client_information")||"{}"))||void 0===t?void 0:t.residence)||(null==a?void 0:a.country_code);return{isHubRedirectionEnabled:Array.isArray(n)&&l&&n.includes(l),isChangingToHubAppId:Array.isArray(n)&&i&&n.includes(i),isHubRedirectionLoaded:!!n.length}}().isHubRedirectionEnabled,S=y||{},w=S.code,A=S.message,O=S.type,k=w===Ve,x=w===Be&&"buy"===O,C=w===He,T=(!(0,i.isEmptyObject)(y)||d)&&Ye({services_error:y,is_mf_verification_pending_modal_visible:d}),j=function(){if(r(!1),"buy"===y.type){if(k)return;h(),b()}};return(0,n.useEffect)((function(){r(T)}),[T]),(0,n.useEffect)((function(){!t&&w&&_(),t||f(!1)}),[t]),T?o().createElement(Le.A.Root,{className:"service-error-sheet",isOpen:t,onClose:j,expandable:!1,position:"left"},o().createElement(Le.A.Portal,{showHandlebar:!0,shouldCloseOnDrag:!0},o().createElement("div",{className:"service-error-sheet__body"},o().createElement(ya,{error_type:k?Ve:x?Be:C?He:d?Ge:null,services_error_message:A})),o().createElement(Le.A.Footer,_a({className:"service-error-sheet__footer",alignment:"vertical",primaryButtonColor:"coral"},k?{primaryAction:{content:o().createElement(K.Localize,{i18n_default_text:"Deposit now"}),onAction:function(){if(_(),p)j();else if(m&&E){var e=window.location.search,t=new URLSearchParams(e),r=window.sessionStorage.getItem("account")||t.get("account");window.location.href="".concat("https://hub.deriv.com/tradershub","/redirect?action=redirect_to&redirect_to=wallet").concat(r?"&account=".concat(r):"")}else{var n;null==g||null===(n=g.push)||void 0===n||n.call(g,m?i.routes.wallets_deposit:i.routes.cashier_deposit)}}}}:x?{primaryAction:{content:o().createElement(K.Localize,{i18n_default_text:"Create free account"}),onAction:function(){_(),(0,i.redirectToSignUp)()}},secondaryAction:{content:o().createElement(K.Localize,{i18n_default_text:"Login"}),onAction:function(){_(),(0,i.redirectToLogin)(!1,(0,K.getLanguage)())}}}:C?{primaryAction:{content:o().createElement(K.Localize,{i18n_default_text:"Submit Proof"}),onAction:function(){_(),g.push(i.routes.proof_of_identity)}}}:d?{primaryAction:{content:o().createElement(K.Localize,{i18n_default_text:"Got it"}),onAction:function(){_(),f(!1),j()}}}:void 0)))):null}));var ba=r("../../node_modules/@deriv-com/quill-ui/dist/components/Snackbar/snackbar-controller.js");const ga=function(e){var t,r=e.error_fields,n=(0,Ie.P)(),o=n.contract_type,a=n.proposal_info,i=n.validation_errors,l=n.trade_type_tab,c=n.trade_types,s=(0,Et.H1)(c,o,l),u=null!==(t=null==a?void 0:a[s[0]])&&void 0!==t?t:{},d=u.has_error,f=u.error_field,m=u.message;return r.map((function(e){return function(e){var t,r,n,o=(null==i||null===(t=i[e])||void 0===t?void 0:t.length)>0;return{is_error_matching_field:d&&f===e||o,message:null!==(r=null!=m?m:null==i||null===(n=i[e])||void 0===n?void 0:n[0])&&void 0!==r?r:""}}(e)})).find((function(e){return e.is_error_matching_field}))||{is_error_matching_field:!1,message:""}},Ea=(0,ye.observer)((function(e){var t=e.error_fields,r=e.should_show_snackbar,n=(0,s.A)().client.is_logged_in,a=(0,_r.d)().addSnackbar,i=ga({error_fields:t}),l=i.is_error_matching_field,c=i.message;return o().useEffect((function(){l&&r&&a({message:c,status:"fail",hasCloseButton:!0,hasFixedHeight:!1,style:{marginBottom:n?"48px":"-8px",width:"calc(100% - var(--core-spacing-800)"}})}),[l,r]),o().createElement(ba.C,null)}));var Sa=r("../../node_modules/@deriv/quill-icons/dist/esm/react/LabelPaired/LabelPairedPresentationScreenSmRegularIcon.js"),wa=r("./src/AppV2/Utils/contract-description-utils.tsx");const Aa=function(e){var t=e.contract_type,r=e.term,n=e.onClose;return o().createElement(Le.A.Root,{isOpen:!!r,onClose:n,position:"left",expandable:!1},o().createElement(Le.A.Portal,{shouldCloseOnDrag:!0},o().createElement(Le.A.Content,{className:"definition__wrapper"},o().createElement(Wt.D.H4,{className:"definition__title"},r),o().createElement(je.E,{as:"div"},(0,wa.OG)({term:r,contract_type:t}))),o().createElement(Le.A.Footer,{alignment:"vertical",primaryAction:{content:o().createElement(K.Localize,{i18n_default_text:"Got it"}),onAction:n},className:"definition__button"})))};var Oa=r("../../node_modules/@deriv-com/quill-ui/dist/components/Chip/index.js"),ka=(0,i.makeLazyLoader)((function(){return(0,i.moduleLoader)((function(){return r.e("accumulators-trade-description").then(r.bind(r,"./src/AppV2/Components/Guide/Description/ContractDescription/accumulators-trade-description.tsx"))}))}),(function(){return o().createElement(Oe.Loading,{is_fullscreen:!1})}))(),xa=(0,i.makeLazyLoader)((function(){return(0,i.moduleLoader)((function(){return r.e("multipliers-trade-description").then(r.bind(r,"./src/AppV2/Components/Guide/Description/ContractDescription/multipliers-trade-description.tsx"))}))}),(function(){return o().createElement(Oe.Loading,{is_fullscreen:!1})}))(),Ca=(0,i.makeLazyLoader)((function(){return(0,i.moduleLoader)((function(){return r.e("vanillas-trade-description").then(r.bind(r,"./src/AppV2/Components/Guide/Description/ContractDescription/vanillas-trade-description.tsx"))}))}),(function(){return o().createElement(Oe.Loading,{is_fullscreen:!1})}))(),Ta=(0,i.makeLazyLoader)((function(){return(0,i.moduleLoader)((function(){return r.e("turbos-trade-description").then(r.bind(r,"./src/AppV2/Components/Guide/Description/ContractDescription/turbos-trade-description.tsx"))}))}),(function(){return o().createElement(Oe.Loading,{is_fullscreen:!1})}))(),ja=(0,i.makeLazyLoader)((function(){return(0,i.moduleLoader)((function(){return r.e("rise-fall-trade-description").then(r.bind(r,"./src/AppV2/Components/Guide/Description/ContractDescription/rise-fall-trade-description.tsx"))}))}),(function(){return o().createElement(Oe.Loading,{is_fullscreen:!1})}))(),La=(0,i.makeLazyLoader)((function(){return(0,i.moduleLoader)((function(){return r.e("higher-lower-trade-description").then(r.bind(r,"./src/AppV2/Components/Guide/Description/ContractDescription/higher-lower-trade-description.tsx"))}))}),(function(){return o().createElement(Oe.Loading,{is_fullscreen:!1})}))(),Pa=(0,i.makeLazyLoader)((function(){return(0,i.moduleLoader)((function(){return r.e("touch-no-touch-trade-description").then(r.bind(r,"./src/AppV2/Components/Guide/Description/ContractDescription/touch-no-touch-trade-description.tsx"))}))}),(function(){return o().createElement(Oe.Loading,{is_fullscreen:!1})}))(),Ia=(0,i.makeLazyLoader)((function(){return(0,i.moduleLoader)((function(){return r.e("matches-differs-trade-description").then(r.bind(r,"./src/AppV2/Components/Guide/Description/ContractDescription/matches-differs-trade-description.tsx"))}))}),(function(){return o().createElement(Oe.Loading,{is_fullscreen:!1})}))(),Na=(0,i.makeLazyLoader)((function(){return(0,i.moduleLoader)((function(){return r.e("even-odd-trade-description").then(r.bind(r,"./src/AppV2/Components/Guide/Description/ContractDescription/even-odd-trade-description.tsx"))}))}),(function(){return o().createElement(Oe.Loading,{is_fullscreen:!1})}))(),Da=(0,i.makeLazyLoader)((function(){return(0,i.moduleLoader)((function(){return r.e("over-under-trade-description").then(r.bind(r,"./src/AppV2/Components/Guide/Description/ContractDescription/over-under-trade-description.tsx"))}))}),(function(){return o().createElement(Oe.Loading,{is_fullscreen:!1})}))();const Ma=function(e){var t,r=e.contract_type,n=e.onTermClick;switch(r){case Et.OA.ACCUMULATORS:t=o().createElement(ka,{onTermClick:n});break;case Et.OA.RISE_FALL:t=o().createElement(ja,null);break;case Et.OA.MULTIPLIERS:t=o().createElement(xa,{onTermClick:n});break;case Et.OA.VANILLAS:t=o().createElement(Ca,{onTermClick:n});break;case Et.OA.TURBOS:t=o().createElement(Ta,{onTermClick:n});break;case Et.OA.HIGHER_LOWER:t=o().createElement(La,null);break;case Et.OA.TOUCH_NO_TOUCH:t=o().createElement(Pa,null);break;case Et.OA.MATCHES_DIFFERS:t=o().createElement(Ia,null);break;case Et.OA.EVEN_ODD:t=o().createElement(Na,null);break;case Et.OA.OVER_UNDER:t=o().createElement(Da,null);break;default:t=o().createElement(je.E,{as:"p"},o().createElement(K.Localize,{i18n_default_text:"Description not found."}))}return o().createElement(o().Fragment,null,t)};var za=r("../../node_modules/@cloudflare/stream-react/dist/stream-react.esm.js"),Ra=r("../../node_modules/@deriv/quill-icons/dist/esm/react/LabelPaired/LabelPairedPlayMdFillIcon.js");const Fa=function(e){var t=e.contract_type,r=e.toggleVideoPlayer,n=e.video_src;return o().createElement("div",{className:"guide-video__wrapper",onClick:r,onKeyDown:r},o().createElement("div",{className:"guide-video__preview","data-testid":"dt_video_preview"},o().createElement(za.Z,{className:"guide-video",letterboxColor:"transparent",muted:!0,preload:"auto",responsive:!1,src:n,width:"112px",height:"73px"}),o().createElement("div",{className:"guide-video__preview__icon__wrapper"},o().createElement(Ra.A,{className:"guide-video__preview__icon"}))),o().createElement("div",{className:"guide-video__description"},o().createElement(It.O,{bold:!0,color:"quill-typography__color--default"},o().createElement(K.Localize,{i18n_default_text:"How to trade "}),t,"?"),o().createElement(It.O,{color:"quill-typography__color--default"},o().createElement(K.Localize,{i18n_default_text:"Watch this video to learn about this trade type."}))))},Ua=function(e){var t=e.contract_list,r=e.onChipSelect,n=e.onTermClick,a=e.selected_contract_type,i=e.show_guide_for_selected_contract,l=e.show_description_in_a_modal,c=void 0===l||l,s=e.toggleVideoPlayer,u=e.video_src;return o().createElement(o().Fragment,null,!i&&o().createElement("div",{className:"guide__menu"},t.map((function(e){var t=e.tradeType,n=e.id;return o().createElement(Oa.v.Selectable,{key:n,onChipSelect:function(){return r(n)},selected:n===a},o().createElement(je.E,{size:"sm"},t))}))),o().createElement("div",{className:(0,ke.A)("guide__contract-description",{"guide__contract-description--without-btn":!c}),key:a},o().createElement(Ma,{contract_type:a,onTermClick:n}),o().createElement(Fa,{contract_type:a,toggleVideoPlayer:s,video_src:u})))};var qa=r("react-dom"),Va=r.n(qa);function Ba(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Ha=function(e){var t=e.isOpen,r=e.children;return t?Va().createPortal(o().createElement("div",{className:"modal-player","aria-modal":"true"},o().createElement("div",{className:"modal-player__container",onClick:function(e){return e.stopPropagation()},onKeyDown:function(e){return e.stopPropagation()}},r)),document.body):null};const Ga=o().memo((function(e){var t=e.contract_list,r=e.is_dark_mode_on,n=e.is_open,a=e.onChipSelect,l=e.onClose,c=e.onTermClick,s=e.selected_contract_type,u=e.show_guide_for_selected_contract,d=e.show_description_in_a_modal,f=void 0===d||d,m=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ba(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ba(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o().useState(!1),2),p=m[0],y=m[1],_=o().useRef(null),v=(0,wa.gl)(s,r),h=function(e){(0,i.clickAndKeyEventHandler)((function(){return y(!p)}),e)},b={contract_list:t,onChipSelect:a,onTermClick:c,selected_contract_type:s,show_guide_for_selected_contract:u,show_description_in_a_modal:f,toggleVideoPlayer:h,video_src:v};return o().useEffect((function(){_.current&&(p?_.current.showModal():_.current.close())}),[p]),o().createElement(o().Fragment,null,f?o().createElement(Le.A.Root,{isOpen:n,onClose:l,position:"left",expandable:!1},o().createElement(Le.A.Portal,{shouldCloseOnDrag:!0},o().createElement(Le.A.Content,{className:"guide__wrapper__content"},o().createElement(Wt.D.H4,{className:"guide__title"},u?s:o().createElement(K.Localize,{i18n_default_text:"Trade types"})),o().createElement(Ua,b)),o().createElement(Le.A.Footer,{alignment:"vertical",primaryAction:{content:o().createElement(K.Localize,{i18n_default_text:"Got it"}),onAction:l},className:"guide__button"}))):o().createElement("div",{className:"guide__wrapper__content--separate"},o().createElement(Ua,b)),o().createElement(Ha,{isOpen:p},o().createElement(Oe.VideoPlayer,{className:"modal-player__wrapper",data_testid:"dt_video_player",is_v2:!0,is_mobile:!0,increased_drag_area:!0,src:v,onModalClose:h,muted:!0,hide_volume_control:!0})))}));function Ya(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||Wa(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wa(e,t){if(e){if("string"==typeof e)return $a(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?$a(e,t):void 0}}function $a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Ka=(0,ye.observer)((function(e){var t,r,n=e.has_label,a=e.is_open_by_default,i=e.show_guide_for_selected_contract,l=e.show_trigger_button,c=void 0===l||l,u=e.show_description_in_a_modal,d=void 0===u||u,f=(0,s.A)(),m=f.ui.is_dark_mode_on,p=f.common.current_language,y=(0,Ie.P)().contract_type,_=null!==(t=null===(r=Et.Ou.find((function(e){return e.for.includes(y)})))||void 0===r?void 0:r.id)&&void 0!==t?t:"",v=Ot().trade_types,h=[Et.OA.RISE_FALL,Et.OA.ACCUMULATORS,Et.OA.MULTIPLIERS,Et.OA.VANILLAS,Et.OA.TURBOS,Et.OA.HIGHER_LOWER,Et.OA.TOUCH_NO_TOUCH,Et.OA.MATCHES_DIFFERS,Et.OA.EVEN_ODD,Et.OA.OVER_UNDER],b=Et.Ou.filter((function(e){return v.some((function(t){return t.text===e.id}))})),g=function(e){return function(e){if(Array.isArray(e))return $a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Wa(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(b).sort((function(e,t){return h.findIndex((function(t){return t===e.id}))-h.findIndex((function(e){return e===t.id}))})),E=Ya(o().useState(a),2),S=E[0],w=E[1],A=Ya(o().useState(_),2),O=A[0],k=A[1],x=Ya(o().useState(""),2),C=x[0],T=x[1],j=o().useCallback((function(e){return k(null!=e?e:"")}),[]),L=o().useCallback((function(){return w(!1)}),[]);return o().useEffect((function(){i&&k(_)}),[i,_]),o().useEffect((function(){w(S)}),[a]),o().createElement(o().Fragment,null,c&&o().createElement(ir.$n,{color:m?"white":"black",icon:o().createElement(Sa.A,{key:"guide-button-icon"}),onClick:function(){(0,wo.YL)(y,"main_trade_page"),w(!0)},variant:n?"secondary":"tertiary",key:p},n&&o().createElement(je.E,{size:"sm",bold:!0,color:"quill-typography__color--prominent"},o().createElement(K.Localize,{i18n_default_text:"Guide"}))),o().createElement(Ga,{contract_list:g,is_dark_mode_on:m,is_open:S,onChipSelect:function(e){var t,r,n=g.find((function(t){return t.id===e}));(0,wo.YL)(null!==(t=null==n||null===(r=n.for)||void 0===r?void 0:r[0])&&void 0!==t?t:"","trade_type_page"),j(e)},onClose:L,onTermClick:T,selected_contract_type:O,show_guide_for_selected_contract:i,show_description_in_a_modal:d}),o().createElement(Aa,{contract_type:O,term:C,onClose:function(){return T("")}}))}));const Ja=Ka;const Xa=o().memo((function(e){var t=e.children,r=e.is_minimized,n=e.is_minimized_visible,a=r&&n;return o().createElement("section",{className:(0,ke.A)("",{"trade-params--minimized":a,"trade-params":!a})},!a&&o().createElement("div",{className:"trade-params__title"},o().createElement(je.E,null,o().createElement(K.Localize,{i18n_default_text:"Set your trade"})),o().createElement(Ja,{has_label:!0,show_guide_for_selected_contract:!0})),t)})),Za=(0,ye.observer)((function(){var e,t=(0,Ie.P)(),r=t.currency,n=t.is_market_closed,a=t.maximum_payout;return(null===(e=t.proposal_info[i.CONTRACT_TYPES.ACCUMULATOR])||void 0===e?void 0:e.has_error)?null:o().createElement("div",{className:"accumulators-info__wrapper"},o().createElement(je.E,{size:"sm",className:(0,ke.A)(n&&"trade-params__text--disabled")},o().createElement(K.Localize,{i18n_default_text:"Max. payout"})),a?o().createElement(je.E,{size:"sm",bold:!0,className:(0,ke.A)(n&&"trade-params__text--disabled")},o().createElement(Oe.Money,{amount:a,show_currency:!0,currency:r})):o().createElement(Oe.Skeleton,{width:100,height:14}))}));var Qa=r("../../node_modules/@deriv-com/quill-ui/dist/components/SelectionControl/toggle-switch/index.js"),ei=r("./src/Stores/Modules/Trading/Helpers/allow-equals.ts");function ti(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const ri=(0,ye.observer)((function(){var e=(0,Ie.P)(),t=e.contract_types_list,r=e.contract_start_type,n=e.duration_unit,a=e.expiry_type,l=e.is_equal,c=e.is_market_closed,s=e.onChange,u=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ti(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ti(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o().useState(!1),2),d=u[0],f=u[1],m=(0,ei.jZ)(t,n,r),p=(0,ei.KM)(t),y=function(e){c||(0,i.clickAndKeyEventHandler)((function(){return f(!0)}),e)},_=function(){return f(!1)};return(m||"endtime"===a)&&p?o().createElement(o().Fragment,null,o().createElement("div",{className:"allow-equals__wrapper"},o().createElement(je.E,{size:"sm",className:(0,ke.A)("allow-equals__title",c&&"allow-equals__title--disabled"),onClick:y,onKeyDown:y},o().createElement(K.Localize,{i18n_default_text:"Allow equals"})),o().createElement(Qa.j,{checked:!!l,onChange:function(e){s({target:{name:"is_equal",value:Number(e)}}),f(!1)},disabled:c})),o().createElement(Le.A.Root,{isOpen:d,onClose:_,position:"left",expandable:!1},o().createElement(Le.A.Portal,{shouldCloseOnDrag:!0},o().createElement(Le.A.Content,{className:"allow-equals__definition__wrapper"},o().createElement(Wt.D.H4,{className:"allow-equals__definition__title"},o().createElement(K.Localize,{i18n_default_text:"Allow equals"})),o().createElement(je.E,{as:"div"},o().createElement(K.Localize,{i18n_default_text:"Win payout if exit spot is also equal to entry spot."}))),o().createElement(Le.A.Footer,{alignment:"vertical",primaryAction:{content:o().createElement(K.Localize,{i18n_default_text:"Got it"}),onAction:_},className:"allow-equals__button"})))):null}));var ni=r("../../node_modules/@deriv-com/quill-ui/dist/components/Input/text-field/index.js");function oi(){return oi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},oi.apply(null,arguments)}function ai(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const ii=function(e){var t=e.classname,r=e.current_index,n=e.header,a=e.is_swipeable,i=e.is_infinite_loop,l=e.onNextButtonClick,c=e.onPreviousButtonClick,s=e.pages,u=e.previous_icon,d=e.title,f=e.next_icon,m=e.setCurrentIndex,p=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ai(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ai(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o().useState(0),2),y=p[0],_=p[1],v=n,h=void 0!==r&&void 0!==m,b=h?r:y,g="AR"===(0,K.getLanguage)(),E=function(){if(i||!(b+1>=s.length)){var e=(b+1)%s.length;h?null==m||m(e):_(e),null==l||l()}},S=function(){if(i||!(b-1<0)){var e=(b-1+s.length)%s.length;h?null==m||m(e):_(e),null==c||c()}},w=(0,Mo.useSwipeable)({onSwipedLeft:E,onSwipedRight:S});return o().createElement(o().Fragment,null,v&&o().createElement(v,{current_index:b,onNextClick:E,onPrevClick:S,previous_icon:u,next_icon:f,title:d}),o().createElement("ul",oi({className:(0,ke.A)("carousel",t),"data-testid":"dt_carousel"},a?w:{}),s.map((function(e){var t=e.component,r=e.id;return o().createElement("li",{className:"carousel__item",style:{transform:"translateX(".concat(100*b*(g?1:-1),"%)")},key:r},t)}))))},li=function(e){var t=e.isDays;return o().createElement(Le.A.Content,{className:"barrier-params__description-content"},t?o().createElement("div",{className:"content-section"},o().createElement(je.E,{bold:!0},o().createElement(K.Localize,{i18n_default_text:"Fixed barrier:"})),o().createElement(je.E,null,o().createElement(K.Localize,{i18n_default_text:"Barrier set at specific price."}))):o().createElement(o().Fragment,null,o().createElement("div",{className:"content-section"},o().createElement(je.E,{bold:!0},o().createElement(K.Localize,{i18n_default_text:"Above spot:"})),o().createElement(je.E,null,o().createElement(K.Localize,{i18n_default_text:"Barrier set above spot price."}))),o().createElement("div",{className:"content-section"},o().createElement(je.E,{bold:!0},o().createElement(K.Localize,{i18n_default_text:"Below spot:"})),o().createElement(je.E,null,o().createElement(K.Localize,{i18n_default_text:"Barrier set below spot price."}))),o().createElement("div",{className:"content-section"},o().createElement(je.E,{bold:!0},o().createElement(K.Localize,{i18n_default_text:"Fixed barrier:"})),o().createElement(je.E,null,o().createElement(K.Localize,{i18n_default_text:"Barrier set at specific price."})))))};var ci=r("../../node_modules/@deriv-com/quill-ui/dist/components/Input/text-field-addon/index.js");function si(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ui(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ui(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ui(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var di=[{name:o().createElement(K.Localize,{i18n_default_text:"Above spot"})},{name:o().createElement(K.Localize,{i18n_default_text:"Below spot"})},{name:o().createElement(K.Localize,{i18n_default_text:"Fixed barrier"})}];const fi=(0,ye.observer)((function(e){var t=e.setInitialBarrierValue,r=e.isDays,n=e.onClose,a=(0,Ie.P)(),i=a.barrier_1,l=a.onChange,c=a.validation_errors,s=a.tick_data,u=a.setV2ParamsInitialValues,d=si(o().useState(0),2),f=d[0],m=d[1],p=si(o().useState(!1),2),y=p[0],_=p[1],v=si(o().useState(i),2),h=(v[0],v[1]),b="deriv_spot_barrier_value",g="deriv_fixed_barrier_value",E=function(e){try{return localStorage.getItem(e)||""}catch(e){return""}},S=function(e,t){try{localStorage.setItem(e,t)}catch(e){}},w=si(o().useState(E(b)||""),2),A=w[0],O=w[1],k=si(o().useState(E(g)||""),2),x=k[0],C=k[1],T=si(o().useState(!1),2),j=T[0],L=T[1],P=(null!=s?s:{}).pip_size,I=o().useRef(null),N=(null==c?void 0:c.barrier_1.length)>0&&(i||y);o().useEffect((function(){if(t(i),u({name:"barrier_1",value:i}),i.includes("-")){m(1);var e=i.replace(/^[+-]/,"");O(e),A||S(b,e)}else if(i.includes("+")){m(0);var r=i.replace(/^[+-]/,"");O(r),A||S(b,r)}else m(2),C(i),x||S(g,i);l({target:{name:"barrier_1",value:i}})}),[]),o().useEffect((function(){var e=I.current,t=function(){L(!(!e||!e.contains(document.activeElement)))};return document.addEventListener("focusin",t),document.addEventListener("focusout",t),function(){document.removeEventListener("focusin",t),document.removeEventListener("focusout",t)}})),o().useEffect((function(){j&&_(!1)}),[j]);var D=function(e){var t=e.target.value;if(0===f&&(t="+".concat(t)),1===f&&(t="-".concat(t)),0===f||1===f){var r=t.replace(/^[+-]/,"");O(r),S(b,r)}else 2===f&&(C(t),S(g,t));l({target:{name:"barrier_1",value:t}}),u({name:"barrier_1",value:t}),h(t)};return o().createElement(o().Fragment,null,o().createElement(Le.A.Content,null,o().createElement("div",{className:"barrier-params"},!r&&o().createElement("div",{className:"barrier-params__chips"},di.map((function(e,t){return o().createElement(Oa.v.Selectable,{key:t,onClick:function(){return function(e){var t=f;m(e);var r="";if(0===t||1===t){var n=i.replace(/^[+-]/,"");O(n),S(b,n)}else 2===t&&(C(i),S(g,i));if(0===e||1===e){var o=A||"";r=0===e?"+".concat(o):"-".concat(o)}else 2===e&&(r=x||"");(r.startsWith("+")||r.startsWith("-"))&&"."===r.charAt(1)?r="".concat(r.charAt(0),"0").concat(r.slice(1)):r.startsWith(".")&&(r="0".concat(r)),h(r),l({target:{name:"barrier_1",value:r}})}(t)},selected:t==f},o().createElement(je.E,{size:"sm"},e.name))}))),o().createElement("div",null,2===f||r?o().createElement(ni.A,{customType:"commaRemoval",name:"barrier_1",noStatusIcon:!0,status:N?"error":"neutral",value:i,allowDecimals:!0,decimals:P,allowSign:!1,inputMode:"decimal",regex:/[^0-9.,]/g,textAlignment:"center",onChange:D,placeholder:(0,K.localize)("Price"),variant:"fill",message:N?null==c?void 0:c.barrier_1[0]:"",ref:I}):o().createElement(ci.M,{fillAddonBorderColor:"var(--semantic-color-slate-solid-surface-frame-mid)",customType:"commaRemoval",name:"barrier_1",noStatusIcon:!0,addonLabel:0==f?"+":"-",decimals:P,value:i.replace(/[+-]/g,""),allowDecimals:!0,inputMode:"decimal",allowSign:!1,status:N?"error":"neutral",onChange:D,placeholder:(0,K.localize)("Distance to spot"),regex:/[^0-9.,]/g,variant:"fill",message:N?null==c?void 0:c.barrier_1[0]:"",ref:I}),(0==(null==c?void 0:c.barrier_1.length)||!N)&&o().createElement("div",{className:"barrier-params__error-area"})),o().createElement("div",{className:"barrier-params__current-spot-wrapper"},o().createElement(je.E,{size:"sm"},o().createElement(K.Localize,{i18n_default_text:"Current spot"})),o().createElement(je.E,{size:"sm"},null==s?void 0:s.quote)))),o().createElement(Le.A.Footer,{alignment:"vertical",shouldCloseOnPrimaryButtonClick:!1,primaryAction:{content:o().createElement(K.Localize,{i18n_default_text:"Save"}),onAction:function(){if(0===c.barrier_1.length){if(0===f||1===f){var e=i.replace(/^[+-]/,"");S(b,e)}else 2===f&&S(g,i);n(!0),D({target:{name:"barrier_1",value:i.replace(/[+-]/g,"")}})}else _(!0)}}}))}));var mi=r("../../node_modules/@deriv/quill-icons/dist/esm/react/LabelPaired/LabelPairedCircleInfoMdRegularIcon.js"),pi=r("../../node_modules/@deriv/quill-icons/dist/esm/react/LabelPaired/LabelPairedArrowLeftMdRegularIcon.js");const yi=function(e){var t=e.current_index,r=e.onNextClick,n=e.onPrevClick,a=e.previous_icon,i=e.next_icon,l=e.title,c=null!=i?i:mi.A,s=null!=a?a:pi.A;return o().createElement(Le.A.Header,{className:"carousel-controls",title:l,icon:t?o().createElement(s,{onClick:n}):o().createElement(c,{onClick:r}),iconPosition:t?"left":"right"})};function _i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return vi(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?vi(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vi(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const hi=(0,ye.observer)((function(e){var t,r,n=e.is_minimized,a=(0,Ie.P)(),i=a.barrier_1,l=a.onChange,c=a.duration_unit,s=a.is_market_closed,u=a.setV2ParamsInitialValues,d=a.v2_params_initial_values,f=a.validation_errors,m=a.proposal_info,p=a.trade_type_tab,y=_i(o().useState(!1),2),_=y[0],v=y[1],h=_i(o().useState(""),2),b=h[0],g=h[1],E="d"==c,S=f.barrier_1.length>0||(null==m||null===(t=m[p])||void 0===t?void 0:t.has_error)&&"barrier"===(null==m||null===(r=m[p])||void 0===r?void 0:r.error_field),w=(0,_r.d)().addSnackbar,A=_i(o().useState(!1),2),O=A[0],k=A[1],x=o().useCallback((function(){_&&(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||l({target:{name:"barrier_1",value:b}}),u({value:"",name:"barrier_1"}),v(!1))}),[b,_]);o().useEffect((function(){var e,t,r,o=null==m||null===(e=m[p])||void 0===e?void 0:e.has_error,a=null==m||null===(t=m[p])||void 0===t?void 0:t.error_field,i=null==m||null===(r=m[p])||void 0===r?void 0:r.message;!o||"barrier"!==a||O||_||n||(w({message:i,hasCloseButton:!0,status:"fail",style:{marginBottom:"48px"}}),k(!0))}),[m]),o().useEffect((function(){_&&k(!1)}),[_]);var C=[{id:1,component:o().createElement(fi,{isDays:E,setInitialBarrierValue:g,onClose:x})},{id:2,component:o().createElement(li,{isDays:E})}];return o().createElement(o().Fragment,null,o().createElement(ni.A,{className:(0,ke.A)("trade-params__option",n&&"trade-params__option--minimized"),disabled:s,variant:"fill",readOnly:!0,noStatusIcon:!0,label:o().createElement(K.Localize,{i18n_default_text:"Barrier",key:"barrier".concat(n?"-minimized":"")}),value:d.barrier_1||i,onClick:function(){return v(!0)},status:S&&!_?"error":void 0}),o().createElement(Le.A.Root,{isOpen:_,onClose:x,position:"left",expandable:!1,shouldBlurOnClose:_},o().createElement(Le.A.Portal,{shouldCloseOnDrag:!0},o().createElement(ii,{header:yi,title:o().createElement(K.Localize,{i18n_default_text:"Barrier"}),pages:C}))))}));var bi=(0,ye.observer)((function(){var e,t=(0,Ie.P)(),r=t.barrier_1,n=t.contract_type,a=t.is_market_closed;return(null===(e=t.proposal_info[n.toUpperCase()])||void 0===e?void 0:e.has_error)?null:o().createElement("div",{className:"barrier-info__container"},o().createElement(je.E,{size:"sm",className:(0,ke.A)(a&&"trade-params__text--disabled")},o().createElement(K.Localize,{i18n_default_text:"Barrier"})),r?o().createElement(je.E,{size:"sm",bold:!0,className:(0,ke.A)(a&&"trade-params__text--disabled")},r):o().createElement(Oe.Skeleton,{width:50,height:14}))}));const gi=bi,Ei=function(e){var t=e.duration_units_list,r=e.onChangeUnit,n=e.unit,a=t.length>1;return a?o().createElement("div",{className:"duration-container__chips"},t.map((function(e,t){return"d"!==e.value&&o().createElement(Oa.v.Selectable,{key:"".concat(e.text,"-").concat(t),selected:n==e.value,className:"duration-container__chips__chip",onClick:function(){return n!==e.value&&r(e.value)}},o().createElement(je.E,{size:"sm"},e.text))})),a&&o().createElement(Oa.v.Selectable,{key:"end-time",selected:"d"===n,className:"duration-container__chips__chip",onClick:function(){return r("d")}},o().createElement(je.E,{size:"sm"},o().createElement(K.Localize,{i18n_default_text:"End Time"})))):o().createElement(o().Fragment,null)};var Si=r("../../node_modules/@deriv-com/quill-ui/dist/components/Atom/WheelPicker/wheel-picker/index.js");function wi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ai(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ai(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ai(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Oi=function(e){var t,r,a=e.setWheelPickerValue,i=e.selected_hour,l=e.selected_time,c=e.duration_min_max,s=wi((0,n.useState)([]),2),u=s[0],d=s[1],f=wi((0,n.useState)([]),2),m=f[0],p=f[1];(0,n.useEffect)((function(){var e=Math.max(c.intraday.min,3600),t=c.intraday.max,r=Math.max(1,Math.ceil(e/3600)),n=Math.floor(t/3600),o=Array.from({length:n-r+1},(function(e,t){return{label:"".concat(t+r," ").concat((0,K.localize)("h")),value:t+r}}));d(o),y(i[0]||r,e,t)}),[c,i]);var y=function(e,t,r){var n=0,o=59;e===Math.ceil(t/3600)&&(n=Math.ceil(t%3600/60)),e===Math.floor(r/3600)&&(o=Math.floor(r%3600/60)),n>0&&3600*e>=t&&(n=0);var a=Array.from({length:o-n+1},(function(e,t){return{label:"".concat(t+n," ").concat((0,K.localize)("min")),value:t+n}}));p(a)},_=function(e,t){var r,n=e.find((function(e){return e.value===t}));return n?n.label:(null===(r=e[0])||void 0===r?void 0:r.label)||"1 ".concat((0,K.localize)("h"))};return o().createElement(Si.N,{data:[u,m],defaultValue:[_(u,i[0]),_(m,l[1])],containerHeight:"268px",inputValues:[i[0]||(null===(t=u[0])||void 0===t?void 0:t.value),l[1]||(null===(r=m[0])||void 0===r?void 0:r.value)],setInputValues:function(e,t){a(e,t),0===e&&y(Number(t),c.intraday.min,c.intraday.max)}})},ki=(0,ye.observer)((function(e){var t=e.unit,r=e.setWheelPickerValue,n=e.selected_hour,a=e.selected_time,i=(0,Ie.P)(),l=i.duration_min_max,c=i.duration_units_list,s=o().useMemo((function(){return(0,Re.nw)(t,l)}),[t,l]);return o().createElement("div",{className:(0,ke.A)("duration-container__wheel-picker-container",{"duration-container__wheel-picker-container__single":1==c.length&&t!==Re.mM.DAYS})},t!==Re.mM.HOURS?o().createElement(Si.N,{data:s,defaultValue:[String(a)],containerHeight:t===Re.mM.DAYS?"228px":1===c.length?"230px":"268px",inputValues:a,setInputValues:r}):o().createElement(Oi,{setWheelPickerValue:r,selected_hour:n,selected_time:a,duration_min_max:l}))}));var xi=r("../../node_modules/@deriv/quill-icons/dist/esm/react/LabelPaired/LabelPairedCalendarSmRegularIcon.js"),Ci=r("../../node_modules/@deriv/quill-icons/dist/esm/react/LabelPaired/LabelPairedClockThreeSmRegularIcon.js"),Ti=r("../../node_modules/@deriv-com/quill-ui/dist/components/Atom/Calendar/index.js"),ji=r("./src/Stores/Modules/Trading/Helpers/contract-type.ts");function Li(e){return Li="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Li(e)}function Pi(){Pi=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),l=new j(n||[]);return o(i,"_invoke",{value:k(e,r,l)}),i}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",m="suspendedYield",p="executing",y="completed",_={};function v(){}function h(){}function b(){}var g={};s(g,i,(function(){return this}));var E=Object.getPrototypeOf,S=E&&E(E(L([])));S&&S!==r&&n.call(S,i)&&(g=S);var w=b.prototype=v.prototype=Object.create(g);function A(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function r(o,a,i,l){var c=d(e[o],e,a);if("throw"!==c.type){var s=c.arg,u=s.value;return u&&"object"==Li(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,i,l)}),(function(e){r("throw",e,i,l)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return r("throw",e,i,l)}))}l(c.arg)}var a;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function k(t,r,n){var o=f;return function(a,i){if(o===p)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var l=n.delegate;if(l){var c=x(l,n);if(c){if(c===_)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var s=d(t,r,n);if("normal"===s.type){if(o=n.done?y:m,s.arg===_)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=y,n.method="throw",n.arg=s.arg)}}}function x(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),_;var a=d(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,_;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,_):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,_)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(Li(t)+" is not iterable")}return h.prototype=b,o(w,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:h,configurable:!0}),h.displayName=s(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,s(e,c,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},A(O.prototype),s(O.prototype,l,(function(){return this})),t.AsyncIterator=O,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new O(u(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},A(w),s(w,c,"Generator"),s(w,i,(function(){return this})),s(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return l.type="throw",l.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],l=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(c&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,_):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),_}},t}function Ii(e,t,r,n,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,o)}function Ni(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Di(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Di(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Di(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Mi=function(e){var t=e.start_date,r=e.end_date,a=e.setEndDate,l=Ni(o().useState([]),2),c=l[0],s=l[1],u=(0,Ie.P)().symbol,d=(0,i.useIsMounted)(),f=o().useCallback(function(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){Ii(a,n,o,i,l,"next",e)}function l(e){Ii(a,n,o,i,l,"throw",e)}i(void 0)}))}}(Pi().mark((function e(){var t,r,n,o,a,l,c,f=arguments;return Pi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=f.length>0&&void 0!==f[0]?f[0]:(0,i.toMoment)().format("YYYY-MM-DD"),r=[],n=[],e.next=5,Promise.all([ji.h.getTradingEvents(t,u),ji.h.getTradingDays(t,u)]);case 5:o=e.sent,a=Ni(o,2),l=a[0],(c=a[1])&&(n=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map((function(e,t){return c.includes(e)?-1:t})).filter((function(e){return-1!==e}))),null==l||l.forEach((function(e){var t=e.dates.split(", ");r.push({dates:t,descrip:e.descrip})})),d()&&s(n);case 12:case"end":return e.stop()}}),e)}))),[d,u]);return(0,n.useEffect)((function(){f()}),[]),o().createElement("div",{className:"duration-datepicker duration-container__date-picker"},o().createElement(Ti.l,{className:"date-picker",hasFixedWidth:!1,minDate:new Date(t),maxDate:new Date((new Date).setFullYear((new Date).getFullYear()+1)),view:"month",value:r,tileDisabled:function(e){var t=e.date.getDay();return c.includes(t)},onChange:function(e){e&&e instanceof Date&&a(e)},wrapperClassName:"duration-container__date-picker__sheet"}))};var zi=r("../../node_modules/@deriv-com/quill-ui/dist/components/Atom/WheelPicker/time-wheel-picker/index.js");const Ri=function(e){var t=e.end_time,r=e.setEndTime,n=e.current_gmt_time,a=e.adjusted_start_time;return o().createElement("div",{className:"duration-container__time-picker"},o().createElement(zi.I,{is12Hour:!1,startTimeIn24Format:a,minutesInterval:5,selectedTime:t,setSelectedValue:function(e){return r(e)},containerHeight:"256px",hoursInterval:1}),o().createElement("div",{className:"duration-container__endtime"},o().createElement(It.O,{color:"quill-typography__color--subtle"},o().createElement(K.Localize,{i18n_default_text:"Current time"})),o().createElement(je.E,{size:"sm"},"".concat(n," GMT"))))};var Fi=r("./src/Stores/Modules/Trading/Helpers/end-time.ts");function Ui(e){return Ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ui(e)}function qi(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Vi(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?qi(Object(r),!0).forEach((function(t){Bi(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qi(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Bi(e,t,r){return(t=function(e){var t=function(e){if("object"!=Ui(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Ui(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ui(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Gi(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Gi(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gi(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Yi=function(e){var t=Hi(e.split(":").map(Number),2);return 60*t[0]+t[1]};const Wi=function(e){var t,r=e.end_time,a=e.expiry_time_input,l=e.saved_expiry_date_v2,c=e.setEndTime,u=e.setExpiryTimeInput,d=e.setUnsavedExpiryDateV2,f=e.unsaved_expiry_date_v2,m=Hi(o().useState(""),2),p=m[0],y=m[1],_=Hi(o().useState(!1),2),v=_[0],h=_[1],b=Hi(o().useState(!1),2),g=b[0],E=b[1],S=Hi((0,n.useState)(!1),2),w=S[0],A=S[1],O=Hi((0,n.useState)(!1),2),k=O[0],x=O[1],C=Hi((0,n.useState)(new Date(l||f)),2),T=C[0],j=C[1],L=Hi((0,n.useState)(),2),P=L[0],I=L[1],N=Hi((0,n.useState)(),2),D=N[0],M=N[1],z=(0,s.A)().common,R=Hi((0,n.useState)(null),2),F=R[0],U=R[1],q=z.server_time,V=(0,Ie.P)(),B=V.barrier_1,H=V.contract_type,G=V.duration_min_max,Y=V.duration_units_list,W=V.duration,$=V.expiry_date,J=V.is_turbos,X=V.market_close_times,Z=V.market_open_times,Q=V.start_date,ee=V.start_time,te=V.symbol,re=V.tick_data,ne=V.trade_types,oe=(0,Ie.P)(),ae=(0,_r.d)().addSnackbar,ie=Vi(Vi({duration_unit:"d",duration:F||W,expiry_type:"duration",contract_type:H,basis:"stake",amount:"5",symbol:te},P&&{payout_per_point:P}),D&&{barrier:D}),le=(0,Re.hi)({new_values:ie,trade_store:oe,trade_type:Object.keys(ne)[0]}),ce=gt(["proposal",JSON.stringify(F),JSON.stringify(P),JSON.stringify(D)],Vi(Vi({},le),{},{symbol:te},!B||J||D?{}:{barrier:Math.round(null==re?void 0:re.quote)}),{enabled:w}).data;(0,n.useEffect)((function(){if(ce){var e,t,r,n,a,i,l;if("ContractBuyValidationError"===(null==ce||null===(e=ce.error)||void 0===e?void 0:e.code)){var c=ce.error.details;if("payout_per_point"===(null==c?void 0:c.field)&&null!=c&&c.payout_per_point_choices){var s=null==c?void 0:c.payout_per_point_choices[0];return I(s),void A(!0)}if("barrier"===(null==c?void 0:c.field)&&null!=c&&c.barrier_choices){var d=null==c?void 0:c.barrier_choices[0];return M(d),void A(!0)}}null!=ce&&null!==(t=ce.error)&&void 0!==t&&t.message&&"duration"===(null==ce||null===(r=ce.error)||void 0===r||null===(n=r.details)||void 0===n?void 0:n.field)?(ae({message:o().createElement(K.Localize,{i18n_default_text:null==ce||null===(i=ce.error)||void 0===i?void 0:i.message}),status:"fail",hasCloseButton:!0,style:{marginBottom:"48px"}}),x(!0)):x(!1),null!=ce&&null!==(a=ce.proposal)&&void 0!==a&&a.date_expiry&&u(new Date(1e3*(null==ce||null===(l=ce.proposal)||void 0===l?void 0:l.date_expiry)).toISOString().split("T")[1].substring(0,8)),f=["proposal",JSON.stringify(F),JSON.stringify(P),JSON.stringify(D)],m=bt(f),vt[m]=null,A(!1)}var f,m}),[ce,u,d]);var se=(0,i.toMoment)($),ue=Z.map((function(e){return(0,i.setTime)(se.clone(),e)})),de=X.map((function(e){return(0,i.setTime)(se.clone(),e)})),fe=(0,i.toMoment)(q),me=(null===(t=(0,Fi.h)(fe.clone(),ue,de).start[0])||void 0===t?void 0:t.clone().add(5,"minutes").format("HH:mm"))||(0,Re.nz)(5),pe=new Date(f).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}),ye=(new Date).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"});o().useEffect((function(){var e=function(){var e=(new Date).toLocaleTimeString("en-GB",{timeZone:"GMT",hour12:!1});y(e)};e();var t=setInterval(e,1e3);return""!==r&&Yi(r)<Yi(me)&&5===Math.abs(Yi(me)-Yi(r))&&!g&&c(me),function(){return clearInterval(t)}}),[r,me]),(0,n.useEffect)((function(){pe!==ye||r||c(me)}),[f]);var _e,ve=(0,i.hasIntradayDurationUnit)(Y),he=new Date(Date.parse("".concat(pe," 00:00:00"))),be=he.getFullYear()===q.year()&&he.getMonth()===q.month()&&he.getDate()===q.date();return _e=(!!Q||be)&&ve,o().createElement("div",{className:"duration-container__days-input"},o().createElement(ni.A,{variant:"fill",readOnly:!0,name:"date","data-testid":"dt_date_input",textAlignment:"center",value:pe,disabled:0===Y.filter((function(e){return"d"===e.value})).length,onClick:function(){h(!0)},leftIcon:o().createElement(xi.A,{width:24,height:24})}),o().createElement(ni.A,{variant:"fill",readOnly:!0,textAlignment:"center",name:"time",value:"".concat((_e?r:be&&a)||"23:59:59"," GMT"),disabled:!_e,onClick:function(){E(!0)},leftIcon:o().createElement(Ci.A,{width:24,height:24})}),o().createElement("div",{className:"duration-container__days-input__expiry"},o().createElement(je.E,{size:"sm",color:"quill-typography__color--subtle"},o().createElement(K.Localize,{i18n_default_text:"Expiry"})),o().createElement(je.E,{size:"sm"},"\n                ".concat(pe," ").concat((pe===ye?r:a)||"23:59:59"," GMT"))),o().createElement(Le.A.Root,{isOpen:v||g,onClose:function(){h(!1),E(!1),x(!1)},position:"left",expandable:!1},o().createElement(Le.A.Portal,{shouldCloseOnDrag:!0},o().createElement(Le.A.Header,{title:v?o().createElement(K.Localize,{i18n_default_text:"Pick an end date"}):o().createElement(K.Localize,{i18n_default_text:"Pick an end time"})}),v&&o().createElement(Mi,{start_date:(0,Re.bg)(Y,q,ee,G),end_date:T,setEndDate:function(e){var t=e.getTime()-(new Date).getTime(),r=Math.ceil(t/864e5);if(U(Number(r)),j(e),0==r){c(me);var n=(new Date).toISOString().split("T")[0];d(n)}else c(""),d("".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"),"-").concat(String(e.getDate()).padStart(2,"0")));A(!0)}}),g&&o().createElement(Ri,{setEndTime:c,end_time:r,current_gmt_time:p,adjusted_start_time:me}),o().createElement(Le.A.Footer,{alignment:"vertical",shouldCloseOnPrimaryButtonClick:!1,isPrimaryButtonDisabled:k,primaryAction:{content:o().createElement(K.Localize,{i18n_default_text:"Done"}),onAction:function(){k||(h(!1),E(!1),new Date(f).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})!==ye&&c(""),Yi(me)>Yi(r)&&c(me))}}}))))};function $i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ki(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ki(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ki(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Ji=(0,ye.observer)((function(e){var t=e.end_time,r=e.expiry_time_string,a=e.saved_expiry_date_v2,i=e.selected_hour,l=e.setEndTime,c=e.setExpiryTimeString,s=e.setSavedExpiryDateV2,u=e.setSelectedHour,d=e.setUnit,f=e.setUnsavedExpiryDateV2,m=e.unit,p=e.unsaved_expiry_date_v2,y=(0,Ie.P)(),_=y.duration,v=y.duration_units_list,h=y.onChangeMultiple,b=$i((0,n.useState)([_]),2),g=b[0],E=b[1],S=$i(o().useState(r),2),w=S[0],A=S[1];o().useEffect((function(){f(a||p)}),[]);var O=o().useCallback((function(e){d(e),E([]),e!==Re.mM.HOURS&&u([])}),[d,u]);return o().createElement("div",{className:"duration-container"},o().createElement(Le.A.Header,{title:o().createElement(K.Localize,{i18n_default_text:"Duration"})}),o().createElement(Ei,{duration_units_list:v,onChangeUnit:O,unit:m}),m!==Re.mM.DAYS&&o().createElement(ki,{unit:m,setWheelPickerValue:function(e,t){var r=Number(t);if(m===Re.mM.HOURS){var n=i;n[e]=r,u(n)}else E([r])},selected_hour:i,selected_time:g}),m===Re.mM.DAYS&&o().createElement(Wi,{end_time:t,expiry_time_input:w,saved_expiry_date_v2:a,setEndTime:l,setExpiryTimeInput:A,setUnsavedExpiryDateV2:f,unsaved_expiry_date_v2:p||a}),o().createElement(Le.A.Footer,{alignment:"vertical",primaryAction:{content:o().createElement(K.Localize,{i18n_default_text:"Save"}),onAction:function(){if(c(w),s(p),m===Re.mM.HOURS){var e=60*i[0]+i[1],r=Math.floor(_/60);u([r,_%60]),l(""),h({duration_unit:Re.mM.MINUTES,duration:Number(e),expiry_time:null,expiry_type:"duration"})}else if(m===Re.mM.DAYS){var n=new Date(p).getTime()-(new Date).getTime(),o=Math.ceil(n/864e5);u([]),t?h({expiry_time:t,expiry_type:"endtime"}):(l(""),h({duration_unit:Re.mM.DAYS,duration:Number(o),expiry_time:null,expiry_type:"duration"}))}else l(""),u([]),h({duration_unit:m,duration:Number(g),expiry_time:null,expiry_type:"duration"})}}}))}));const Xi=Ji;function Zi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Qi(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Qi(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qi(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var el=(0,ye.observer)((function(e){var t,r,a,l,c=e.is_minimized,u=(0,Ie.P)(),d=u.contract_type,f=u.duration_min_max,m=u.duration_unit,p=u.duration_units_list,y=u.duration,_=u.expiry_epoch,v=u.expiry_time,h=u.expiry_type,b=u.is_market_closed,g=u.onChangeMultiple,E=u.proposal_info,S=u.saved_expiry_date_v2,w=u.setSavedExpiryDateV2,A=u.setUnsavedExpiryDateV2,O=u.start_time,k=u.symbol,x=u.trade_type_tab,C=u.trade_types,T=u.unsaved_expiry_date_v2,j=u.validation_errors,L=(0,_r.d)().addSnackbar,P=null!==(t=(0,i.getUnitMap)()[m])&&void 0!==t?t:{},I=P.name_plural,N=P.name,D=P.name_singular,M=null!==(r=1===y?D:I)&&void 0!==r?r:N,z=Zi((0,n.useState)([]),2),R=z[0],F=z[1],U=Zi((0,n.useState)(!1),2),q=U[0],V=U[1],B=Zi((0,n.useState)(""),2),H=B[0],G=B[1],Y=Zi((0,n.useState)(""),2),W=(Y[0],Y[1]),$=Zi((0,n.useState)(new Date),2),J=($[0],$[1]),X=Zi((0,n.useState)(""),2),Z=X[0],Q=X[1],ee=Zi((0,n.useState)(v?"d":m),2),te=ee[0],re=ee[1],ne=(0,Et.H1)(C,d,x),oe=(null===(a=E[ne[0]])||void 0===a?void 0:a.has_error)&&"duration"===(null===(l=E[ne[0]])||void 0===l?void 0:l.error_field)||j.duration.length>0,ae=(0,n.useRef)(!0),ie=(0,s.A)(),le=ie.common,ce=ie.client.is_logged_in,se=le.server_time;(0,n.useEffect)((function(){if(_&&"d"!==m&&!S){G("23:59:59");var e=(0,i.getTomorrowDate)(se);W(e),w(e)}if(_&&"d"===m&&!H){G(new Date(1e3*_).toISOString().split("T")[1].substring(0,8)||"");var t=new Date(1e3*_).toISOString().split("T")[0];W(new Date(1e3*_).toISOString().split("T")[0]),w(t)}}),[_]),(0,n.useEffect)((function(){if("d"==m){var e=new Date;e.setDate(e.getDate()+y),J(e)}}),[m]),(0,n.useEffect)((function(){if(ae.current){var e=setTimeout((function(){ae.current=!1}),500);return function(){return clearTimeout(e)}}var t=(0,Re.yv)(f,p);"d"==(null==t?void 0:t.unit)&&J(new Date);var r=setTimeout((function(){g({duration_unit:null==t?void 0:t.unit,duration:null==t?void 0:t.value,expiry_time:null,expiry_type:"duration"})}),10),n=(0,Re.bg)(p,se,O,f);return J(new Date(n)),function(){return clearTimeout(r)}}),[k,d,f,p]);var ue=o().useCallback((function(){return V(!1)}),[]);(0,n.useEffect)((function(){if(oe&&!c){var e,t=E[ne[0]]||(null==j||null===(e=j.duration)||void 0===e?void 0:e[0]);"duration"===(null==t?void 0:t.error_field)&&L({message:t.message,status:"fail",hasCloseButton:!0,hasFixedHeight:!1,style:{marginBottom:ce?"48px":"-8px",width:"calc(100% - var(--core-spacing-800)"}})}}),[oe,ne[0]]);var de=o().useCallback((function(){if(v)re("d"),Q(v);else if("m"===m&&y>59){var e=Math.floor(y/60),t=y%60;re("h"),F([e,t])}else F([]),re(m)}),[y,m,v]);return(0,n.useEffect)((function(){q&&de()}),[q]),o().createElement(o().Fragment,null,o().createElement(ni.A,{variant:"fill",key:"".concat(y,"-$").concat(m),readOnly:!0,label:o().createElement(K.Localize,{i18n_default_text:"Duration",key:"duration".concat(c?"-minimized":"")}),value:function(){var e=S?new Date(S).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}):"";if("duration"==h){if("m"===m&&y>59){var t=Math.floor(y/60),r=y%60;return"".concat(t," ").concat(t>1?(0,K.localize)("hours"):(0,K.localize)("hour")," ").concat(r?"".concat(r," ").concat(r>1?(0,K.localize)("minutes"):(0,K.localize)("minute")):""," ")}return"d"===m?e?"".concat((0,K.localize)("Ends on")," ").concat(e,", ").concat(H||"23:59:59"," GMT"):"":"".concat(y," ").concat(M)}if(v)return"".concat((0,K.localize)("Ends on")," ").concat(e," ").concat(v," GMT")}(),noStatusIcon:!0,disabled:b,className:(0,ke.A)("trade-params__option",c&&"trade-params__option--minimized"),onClick:function(){return V(!0)},status:oe?"error":"neutral"}),o().createElement(Le.A.Root,{isOpen:q,onClose:ue,position:"left",expandable:!1,shouldBlurOnClose:q},o().createElement(Le.A.Portal,{shouldCloseOnDrag:!0},o().createElement(Xi,{selected_hour:R,setSelectedHour:F,unit:te,setUnit:re,expiry_time_string:H,setExpiryTimeString:G,end_time:Z,setEndTime:Q,saved_expiry_date_v2:S,setSavedExpiryDateV2:w,unsaved_expiry_date_v2:T,setUnsavedExpiryDateV2:A}))))}));const tl=el,rl=function(e){var t=e.classname,r=e.description,n=e.is_custom_description;return r?o().createElement(Le.A.Content,{className:(0,ke.A)("trade-param-definition",t)},n?r:o().createElement(je.E,null,r)):null};var nl=r("../../node_modules/@deriv-com/quill-ui/dist/components/Atom/WheelPicker/base/index.js"),ol=d()((function(e,t){e(t)}),200);const al=function(e){var t=e.accumulator_range_list,r=void 0===t?[]:t,n=e.growth_rate,a=e.maximum_ticks,l=e.setGrowthRate,c=e.setV2ParamsInitialValues,s=e.should_show_details,u=e.tick_size_barrier_percentage,d=o().useRef(),f=o().useRef(n),m=r.map((function(e){return{value:"".concat((0,i.getGrowthRatePercentage)(e),"%")}})),p=[{label:o().createElement(K.Localize,{i18n_default_text:"Barrier"}),value:"±".concat(u)},{label:o().createElement(K.Localize,{i18n_default_text:"Max duration"}),value:"".concat(a||0," ").concat(1===a?(0,K.localize)("tick"):(0,K.localize)("ticks"))}];return o().useEffect((function(){return!d.current&&n&&(d.current=n,c({value:n,name:"growth_rate"})),function(){d.current&&d.current!==f.current&&l(d.current),ol.cancel()}}),[]),o().createElement(o().Fragment,null,o().createElement(Le.A.Content,{className:"growth-rate__picker"},o().createElement("div",{className:"growth-rate__wheel-picker"},r.length?o().createElement(nl.I,{data:m,selectedValue:"".concat((0,i.getGrowthRatePercentage)(f.current),"%"),setSelectedValue:function(e){var t=Number(e.slice(0,-1))/100;t!==f.current&&(ol(l,t),f.current=t)}}):o().createElement(Oe.Skeleton,null)),o().createElement("div",{className:"growth-rate__details"},p.map((function(e){var t=e.label,r=e.value;return o().createElement("span",{key:r,className:"growth-rate__details-item"},o().createElement(je.E,{color:"quill-typography__color--subtle",size:"sm"},t),o().createElement("div",{className:"growth-rate__details-item-value"},s?o().createElement(je.E,{size:"sm"},r):o().createElement(Oe.Skeleton,{height:14,width:75})))})))),o().createElement(Le.A.Footer,{alignment:"vertical",primaryAction:{content:o().createElement(K.Localize,{i18n_default_text:"Save"}),onAction:function(){d.current=f.current,c({value:f.current,name:"growth_rate"})}}}))};function il(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var ll=(0,ye.observer)((function(e){var t=e.is_minimized,r=(0,Ie.P)(),n=r.accumulator_range_list,a=r.growth_rate,l=r.is_purchase_enabled,c=r.is_trade_enabled,s=r.is_market_closed,u=r.has_open_accu_contract,d=r.maximum_ticks,f=r.onChange,m=r.proposal_info,p=r.setV2ParamsInitialValues,y=r.tick_size_barrier_percentage,_=r.v2_params_initial_values,v=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return il(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?il(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o().useState(!1),2),h=v[0],b=v[1],g=(0,Re.Qv)(),E=(null==m?void 0:m[i.CONTRACT_TYPES.ACCUMULATOR])||{},S=c&&!(0,i.isEmptyObject)(m)&&!!E.id&&l,w=(0,ke.A)("trade-params__option",t&&"trade-params__option--minimized"),A=function(e){f({target:{name:"growth_rate",value:e}})},O=o().useCallback((function(){return b(!1)}),[]),k=[{id:1,component:o().createElement(al,{accumulator_range_list:n,maximum_ticks:d,growth_rate:a,setGrowthRate:A,setV2ParamsInitialValues:p,should_show_details:S,tick_size_barrier_percentage:y})},{id:2,component:o().createElement(rl,{description:o().createElement(K.Localize,{i18n_default_text:"Your stake will grow at {{growth_rate}}% per tick as long as the current spot price remains within ±{{tick_size_barrier_percentage}} from the previous spot price.",values:{growth_rate:(0,i.getGrowthRatePercentage)(a),tick_size_barrier_percentage:y}})})}];return o().useEffect((function(){var e=null==_?void 0:_.growth_rate;e&&a!==e&&A(e)}),[]),a?o().createElement(o().Fragment,null,o().createElement(ni.A,{className:w,disabled:u||s,label:o().createElement(K.Localize,{i18n_default_text:"Growth rate",key:"growth-rate".concat(t?"-minimized":"")}),onClick:function(){return b(!0)},readOnly:!0,value:"".concat((0,i.getGrowthRatePercentage)(a),"%"),variant:"fill"}),o().createElement(Le.A.Root,{isOpen:h,onClose:O,position:"left",expandable:!1,shouldBlurOnClose:h},o().createElement(Le.A.Portal,{shouldCloseOnDrag:!0},o().createElement(ii,{classname:(0,ke.A)("growth-rate__carousel",g&&"growth-rate__carousel--small"),header:yi,pages:k,title:o().createElement(K.Localize,{i18n_default_text:"Growth rate"})})))):o().createElement("div",{className:w},o().createElement(Oe.Skeleton,null))}));const cl=ll,sl=function(e){var t=e.digit,r=e.digit_stats,n=void 0===r?[]:r,a=e.is_active,i=e.is_disabled,l=e.is_max,c=e.is_min,s=e.onClick,u=n.length?n[t]:null,d=u?100*u/1e3:null,f=d&&!isNaN(d)?parseFloat(d.toFixed(1)):null;return!t&&isNaN(t)?null:o().createElement("div",{key:t,className:"digit"},o().createElement("button",{className:(0,ke.A)(a&&"active"),disabled:i,onClick:function(){return null==s?void 0:s(t)},name:"last_digit"},o().createElement(je.E,{size:"xl",color:i?"quill-typography__color--disabled":""},t)),f?o().createElement(It.O,{size:"sm",className:(0,ke.A)("percentage",l&&"percentage--max",c&&"percentage--min"),"data-testid":"dt_digit_stats_percentage"},f,"%"):o().createElement(ze.E.Square,{width:36,height:12,rounded:!0}))};function ul(e){return function(e){if(Array.isArray(e))return dl(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return dl(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?dl(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dl(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const fl=function(e){var t=e.digits,r=void 0===t?[]:t,n=e.digit_stats,a=e.is_disabled,i=e.onDigitSelect,l=e.selected_digit;return o().createElement("div",{className:"last-digit-prediction__selector"},ul(Array(2).keys()).map((function(e){return o().createElement("div",{key:e,className:"last-digit-prediction__selector-row"},r.slice(5*e,5*(e+1)).map((function(e){return o().createElement(sl,{key:e,digit:e,digit_stats:n,is_active:l===e,is_disabled:a,is_max:n[e]===Math.max.apply(Math,ul(n)),is_min:n[e]===Math.min.apply(Math,ul(n)),onClick:i})})))})))};function ml(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||pl(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pl(e,t){if(e){if("string"==typeof e)return yl(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?yl(e,t):void 0}}function yl(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var _l,vl=function(e){if(Array.isArray(e))return yl(e)}(_l=Array(10).keys())||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(_l)||pl(_l)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();const hl=(0,ye.observer)((function(e){var t=e.is_minimized,r=(0,Ie.P)(),n=r.digit_stats,a=void 0===n?[]:n,i=r.is_market_closed,l=r.last_digit,c=r.onChange,s=ml(o().useState(!1),2),u=s[0],d=s[1],f=ml(o().useState(l),2),m=f[0],p=f[1];o().useEffect((function(){p(l)}),[l]);var y=function(e){c({target:{name:"last_digit",value:e}})},_=o().useCallback((function(){d(!1),p(l)}),[l]);return t?o().createElement(o().Fragment,null,o().createElement(ni.A,{className:(0,ke.A)("trade-params__option","trade-params__option--minimized"),disabled:i,variant:"fill",readOnly:!0,label:o().createElement(K.Localize,{i18n_default_text:"Last digit prediction",key:"last-digit-prediction".concat(t?"-minimized":"")}),value:l,onClick:function(){return d(!0)}}),o().createElement(Le.A.Root,{isOpen:u,onClose:_,position:"left",expandable:!1,shouldBlurOnClose:u},o().createElement(Le.A.Portal,{shouldCloseOnDrag:!0},o().createElement(Le.A.Header,{title:o().createElement(K.Localize,{i18n_default_text:"Last digit prediction"})}),o().createElement(Le.A.Content,null,o().createElement(fl,{digits:vl,digit_stats:a,onDigitSelect:p,selected_digit:m})),o().createElement(Le.A.Footer,{alignment:"vertical",primaryAction:{content:o().createElement(K.Localize,{i18n_default_text:"Save"}),onAction:function(){l!==m&&y(m)}}})))):o().createElement("div",{className:(0,ke.A)("last-digit-prediction",i&&"last-digit-prediction--disabled")},o().createElement(It.O,{size:"sm",className:"last-digit-prediction__title"},o().createElement(K.Localize,{i18n_default_text:"Last digit prediction"})),o().createElement(fl,{digits:vl,digit_stats:a,onDigitSelect:y,selected_digit:l,is_disabled:i}))}));var bl=d()((function(e,t){e(t)}),200);const gl=function(e){var t=e.multiplier,r=e.multiplier_range_list,a=void 0===r?[]:r,l=e.currency,c=e.commission,s=e.setMultiplier,u=a.map((function(e){return{value:e.text}})),d=o().useRef(t),f=o().useRef(t);return(0,n.useEffect)((function(){return function(){d.current&&d.current!==f.current&&s(d.current),bl.cancel()}}),[]),o().createElement(o().Fragment,null,o().createElement(Le.A.Content,{className:"multiplier__picker"},o().createElement("div",{className:"multiplier__wheel-picker"},u.length?o().createElement(nl.I,{data:u,selectedValue:"x".concat(f.current),setSelectedValue:function(e){var t=Number(e.slice(1));t!==f.current&&(bl(s,t),f.current=Number(t))}}):o().createElement(ze.E.Square,null)),o().createElement("div",{className:"multiplier__commission"},o().createElement(je.E,{color:"quill-typography__color--subtle",size:"sm"},o().createElement(K.Localize,{i18n_default_text:"Commission"})),o().createElement(je.E,{size:"sm",as:"div",className:"multiplier__commission-value"},c?o().createElement(o().Fragment,null,(0,i.formatMoney)(l,c,!0)," ",l):o().createElement(ze.E.Square,{width:60,height:14})))),o().createElement(Le.A.Footer,{isPrimaryButtonDisabled:!1,shouldCloseOnPrimaryButtonClick:!0,primaryAction:{content:o().createElement(K.Localize,{i18n_default_text:"Save"}),onAction:function(){d.current=f.current}}}))};function El(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Sl=(0,ye.observer)((function(e){var t=e.is_minimized,r=(0,Ie.P)(),a=r.multiplier,i=r.multiplier_range_list,l=r.commission,c=r.is_market_closed,s=r.onChange,u=r.currency,d=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return El(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?El(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,n.useState)(!1),2),f=d[0],m=d[1],p=(0,Re.Qv)(),y=(0,ke.A)("trade-params__option",t&&"trade-params__option--minimized"),_=o().useCallback((function(){return m(!1)}),[]),v=[{id:1,component:o().createElement(gl,{multiplier:a,multiplier_range_list:i,currency:u,commission:l,setMultiplier:function(e){s({target:{name:"multiplier",value:e}})}})},{id:2,component:o().createElement(rl,{description:o().createElement(K.Localize,{i18n_default_text:"Multipliers amplify your potential profit if the market moves in your favour, with losses limited to your initial capital."})})}];return a?o().createElement(o().Fragment,null,o().createElement(ni.A,{className:y,disabled:c,variant:"fill",readOnly:!0,label:o().createElement(K.Localize,{i18n_default_text:"Multiplier",key:"multiplier".concat(t?"-minimized":"")}),value:"x".concat(a),onClick:function(){return m(!0)}}),o().createElement(Le.A.Root,{expandable:!1,isOpen:f,position:"left",onClose:_,shouldBlurOnClose:f},o().createElement(Le.A.Portal,{shouldCloseOnDrag:!0},o().createElement(ii,{classname:(0,ke.A)("multiplier__carousel",p&&"multiplier__carousel--small"),header:yi,pages:v,title:o().createElement(K.Localize,{i18n_default_text:"Multiplier"})})))):o().createElement("div",{className:y},o().createElement(ze.E.Square,null))}));const wl=Sl,Al=(0,ye.observer)((function(e){var t,r,n,a,l,c,s=e.is_minimized,u=(0,Ie.P)(),d=u.currency,f=u.is_market_closed,m=u.proposal_info,p=null==m||null===(t=m[i.CONTRACT_TYPES.MULTIPLIER.UP])||void 0===t||null===(r=t.cancellation)||void 0===r?void 0:r.ask_price,y=null==m||null===(n=m[i.CONTRACT_TYPES.MULTIPLIER.DOWN])||void 0===n||null===(a=n.cancellation)||void 0===a?void 0:a.ask_price;if((null==m||null===(l=m[i.CONTRACT_TYPES.MULTIPLIER.UP])||void 0===l?void 0:l.has_error)||(null==m||null===(c=m[i.CONTRACT_TYPES.MULTIPLIER.DOWN])||void 0===c?void 0:c.has_error))return null;var _=function(e){return e?o().createElement(Oe.Money,{amount:e,show_currency:!0,currency:d}):o().createElement(Oe.Skeleton,{width:65,height:18})};return s?o().createElement("div",{className:"multipliers-info__container multipliers-info__container--horizontal"},o().createElement("div",{className:"multipliers-info__fee-row"},o().createElement(je.E,{size:"sm",className:(0,ke.A)(f&&"trade-params__text--disabled")},o().createElement(K.Localize,{i18n_default_text:"DC Fee"})),o().createElement(je.E,{size:"sm",bold:!0,as:"div",className:(0,ke.A)(f&&"trade-params__text--disabled")},_(p))),o().createElement("div",{className:"multipliers-info__fee-row"},o().createElement(je.E,{size:"sm",className:(0,ke.A)(f&&"trade-params__text--disabled")},o().createElement(K.Localize,{i18n_default_text:"DC Fee"})),o().createElement(je.E,{size:"sm",bold:!0,as:"div",className:(0,ke.A)(f&&"trade-params__text--disabled")},_(y)))):o().createElement("div",{className:"multipliers-info__container multipliers-info__container--stacked"},o().createElement("div",{className:"multipliers-info__row"},o().createElement(je.E,{size:"sm",className:(0,ke.A)(f&&"trade-params__text--disabled")},o().createElement(K.Localize,{i18n_default_text:"DC fee (Up)"})),o().createElement(je.E,{size:"sm",bold:!0,as:"div",className:(0,ke.A)(f&&"trade-params__text--disabled")},_(p))),o().createElement("div",{className:"multipliers-info__row"},o().createElement(je.E,{size:"sm",className:(0,ke.A)(f&&"trade-params__text--disabled")},o().createElement(K.Localize,{i18n_default_text:"DC fee (Down)"})),o().createElement(je.E,{size:"sm",bold:!0,as:"div",className:(0,ke.A)(f&&"trade-params__text--disabled")},_(y))))})),Ol=(0,ye.observer)((function(){var e=(0,Ie.P)(),t=e.expiration,r=e.is_market_closed,n=(0,s.A)().common.server_time,a=(0,i.formatDuration)((0,i.getDiffDuration)(Number(null==n?void 0:n.unix()),Number(t)),"HH:mm"),l=a.days,c=a.timestamp,u=(0,i.getDateFromNow)(l,"day","DD MMM YYYY");return o().createElement("div",{className:"multipliers-expiration-info__container"},o().createElement(je.E,{size:"sm",className:(0,ke.A)(r&&"trade-params__text--disabled")},o().createElement(K.Localize,{i18n_default_text:"Expires on"})),o().createElement(je.E,{size:"sm",bold:!0,className:(0,ke.A)(r&&"trade-params__text--disabled")},o().createElement(K.Localize,{i18n_default_text:"{{date}} at {{timestamp}}",values:{date:u,timestamp:c}})))})),kl=(0,ye.observer)((function(){var e,t,r=(0,Ie.P)(),n=r.currency,a=r.is_market_closed,i=r.proposal_info,l=r.trade_type_tab,c=((null===(e=i[l])||void 0===e?void 0:e.obj_contract_basis)||{}).value,s=null===(t=i[l])||void 0===t?void 0:t.has_error;return o().createElement("div",{className:"payout-info__container"},o().createElement(je.E,{size:"sm",className:(0,ke.A)(a&&"trade-params__text--disabled")},o().createElement(K.Localize,{i18n_default_text:"Payout"})),c?o().createElement(je.E,{size:"sm",bold:!0,className:(0,ke.A)(a&&"trade-params__text--disabled")},o().createElement(Oe.Money,{amount:c,show_currency:!0,currency:n})):s?o().createElement(je.E,{size:"sm",bold:!0},"- ",n):o().createElement(Oe.Skeleton,{width:60,height:14}))}));function xl(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||Cl(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cl(e,t){if(e){if("string"==typeof e)return Tl(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Tl(e,t):void 0}}function Tl(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var jl=(0,ye.observer)((function(e){var t=e.barrier,r=e.current_payout_per_point,n=e.is_open,a=e.onPayoutPerPointSelect,i=e.onClose,l=e.payout_per_point_list,c=(0,Ie.P)(),s=c.trade_types,u=xl(o().useState(r),2),d=u[0],f=u[1],m=xl(o().useState(t),2),p=m[0],y=m[1],_=o().useRef(!1),v={payout_per_point:String(d)},h=(0,Re.hi)({new_values:v,trade_store:c,trade_type:Object.keys(s)[0]}),b=gt(["proposal"].concat(function(e){return function(e){if(Array.isArray(e))return Tl(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Cl(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(Object.entries(v).flat().join("-")),["".concat(t),Object.keys(s)[0],JSON.stringify(h)]),h,{enabled:n}).data;return o().useEffect((function(){b&&function(e){var t=e.error,r=e.proposal,n=(null!=r?r:{}).barrier_spot_distance;n&&!t&&y(n),_.current=!0}(b)}),[b]),o().createElement(o().Fragment,null,o().createElement(Le.A.Content,{className:"payout-per-point__wrapper","data-testid":"dt_payout-per-point_wrapper"},o().createElement("div",{className:"payout-per-point__wheel-picker"},o().createElement(nl.I,{data:l,selectedValue:d,setSelectedValue:function(e){var t=d===e;_.current=t,t||f(e)}})),o().createElement("div",{className:"payout-per-point__barrier"},o().createElement(je.E,{color:"quill-typography__color--subtle",size:"sm"},o().createElement(K.Localize,{i18n_default_text:"Barrier"})),o().createElement(je.E,{size:"sm",as:"div",className:"payout-per-point__barrier__content"},null!=p?p:o().createElement(Oe.Skeleton,{width:90,height:14})))),o().createElement(Le.A.Footer,{alignment:"vertical",primaryAction:{content:o().createElement(K.Localize,{i18n_default_text:"Save"}),onAction:function(){_.current&&(a(d),i())}},shouldCloseOnPrimaryButtonClick:!1}))}));const Ll=jl;function Pl(e,t){if(e){if("string"==typeof e)return Il(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Il(e,t):void 0}}function Il(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Nl=(0,ye.observer)((function(e){var t=e.is_minimized,r=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||Pl(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o().useState(!1),2),n=r[0],a=r[1],l=(0,Ie.P)(),c=l.barrier_1,s=l.currency,u=l.is_market_closed,d=l.payout_choices,f=l.payout_per_point,m=l.setPayoutPerPoint,p=(0,Re.Qv)(),y=(0,i.getCurrencyDisplayCode)(s),_=function(e){return function(e){if(Array.isArray(e))return Il(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Pl(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(d).sort((function(e,t){return Number(e)-Number(t)})).map((function(e){return{value:e,label:"".concat(e," ").concat(y)}})),v=o().useCallback((function(){return a(!1)}),[]),h=[{id:1,component:o().createElement(Ll,{barrier:c,current_payout_per_point:f,is_open:n,onPayoutPerPointSelect:m,onClose:v,payout_per_point_list:_})},{id:2,component:o().createElement(rl,{description:o().createElement(K.Localize,{i18n_default_text:"The amount you choose to receive at expiry for every point of change between the final price and the barrier."})})}],b=(0,ke.A)("trade-params__option",t&&"trade-params__option--minimized");return f?o().createElement(o().Fragment,null,o().createElement(ni.A,{disabled:u,className:b,label:o().createElement(K.Localize,{i18n_default_text:"Payout per point",key:"payout-per-point".concat(t?"-minimized":"")}),onClick:function(){return a(!0)},readOnly:!0,variant:"fill",value:"".concat(f," ").concat(y)}),o().createElement(Le.A.Root,{isOpen:n,onClose:v,position:"left",expandable:!1,shouldBlurOnClose:n},o().createElement(Le.A.Portal,{shouldCloseOnDrag:!0},o().createElement(ii,{classname:(0,ke.A)("payout-per-point__carousel",p&&"payout-per-point__carousel--small"),header:yi,pages:h,title:o().createElement(K.Localize,{i18n_default_text:"Payout per point"})})))):o().createElement("div",{className:b},o().createElement(Oe.Skeleton,null))}));const Dl=Nl;var Ml=(0,ye.observer)((function(){var e,t,r=(0,Ie.P)(),n=r.contract_type,a=r.currency,i=r.is_market_closed,l=r.proposal_info,c=n.toUpperCase(),s=((null===(e=l[c])||void 0===e?void 0:e.obj_contract_basis)||{}).value;return(null===(t=l[c])||void 0===t?void 0:t.has_error)?null:o().createElement("div",{className:"payout-per-point-info__container"},o().createElement(je.E,{size:"sm",className:(0,ke.A)(i&&"trade-params__text--disabled")},o().createElement(K.Localize,{i18n_default_text:"Payout per point"})),s?o().createElement(je.E,{size:"sm",bold:!0,className:(0,ke.A)(i&&"trade-params__text--disabled")},s," ",a):o().createElement(Oe.Skeleton,{width:100,height:14}))}));const zl=Ml;var Rl=r("../../node_modules/@deriv-com/quill-ui/dist/components/SegmentedControl/single-choice/index.js");function Fl(e){return Fl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fl(e)}function Ul(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ql(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ul(Object(r),!0).forEach((function(t){Vl(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ul(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Vl(e,t,r){return(t=function(e){var t=function(e){if("object"!=Fl(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Fl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Fl(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bl(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Hl(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Hl(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Hl(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Gl=(0,ye.observer)((function(e){var t=e.closeActionSheet,r=(0,Ie.P)(),n=r.has_cancellation,a=r.has_take_profit,i=r.has_stop_loss,l=r.cancellation_range_list,c=r.cancellation_duration,s=r.onChangeMultiple,u=(0,_r.d)().addSnackbar,d=Bl(o().useState(n),2),f=d[0],m=d[1],p=Bl(o().useState(c),2),y=p[0],_=p[1],v=l.map((function(e){var t=e.text,r=e.value;return{label:(0,Re._V)({value:t}),value:r}}));return o().createElement(o().Fragment,null,o().createElement("div",{className:"deal-cancellation__container"},o().createElement("div",{className:"deal-cancellation__toggle"},o().createElement(je.E,null,o().createElement(K.Localize,{i18n_default_text:"Deal cancellation"})),o().createElement(Qa.j,{checked:f,onChange:m})),o().createElement("div",{className:"deal-cancellation__wheel-picker"},l.length?o().createElement(nl.I,{data:v,disabled:!f,selectedValue:y,setSelectedValue:_}):o().createElement(ze.E.Square,null))),o().createElement(ir.$n,{color:"black-white",size:"lg",label:o().createElement(K.Localize,{i18n_default_text:"Save"}),fullWidth:!0,className:"risk-management__save-button",onClick:function(){n!==f||y!==c?(f&&(a||i)&&u({message:(0,Re.B1)({has_cancellation:f,has_stop_loss:i,has_take_profit:a,switching_cancellation:!0}),hasCloseButton:!0}),s(ql(ql({has_cancellation:f},f?{has_take_profit:!1,has_stop_loss:!1}:{}),{},{cancellation_duration:y})),t()):t()}}))}));function Yl(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Wl(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Wl(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wl(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const $l=function(e){var t=Yl(o().useState(!1),2),r=t[0],n=t[1],a=Yl(o().useState(!1),2),i=a[0],l=a[1];return o().useEffect((function(){var t,r=function(t){var r=t.target,o="focusin"===t.type;r&&r.id===e&&n(o)},o=function(e){var t=e.target;if(t&&null!=t&&t.height&&null!=t&&t.scale){var r=t.height*t.scale/window.screen.height<.75;l(r)}};return document.addEventListener("focusin",r),document.addEventListener("focusout",r),null===(t=window.visualViewport)||void 0===t||t.addEventListener("resize",o),function(){var e;document.removeEventListener("focusin",r),document.removeEventListener("focusout",r),null===(e=window.visualViewport)||void 0===e||e.removeEventListener("resize",o)}}),[]),{is_key_board_visible:r&&i}};function Kl(e){return Kl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kl(e)}function Jl(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Xl(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Jl(Object(r),!0).forEach((function(t){Zl(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jl(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Zl(e,t,r){return(t=function(e){var t=function(e){if("object"!=Kl(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Kl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Kl(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ql(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||ec(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ec(e,t){if(e){if("string"==typeof e)return tc(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?tc(e,t):void 0}}function tc(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const rc=(0,ye.observer)((function(e){var t,r,n,a,l,c,s,u=e.classname,d=e.has_save_button,f=void 0===d||d,m=e.has_actionsheet_wrapper,p=void 0===m||m,y=e.initial_error_text,_=e.onActionSheetClose,v=e.parent_ref,h=e.parent_is_api_response_received_ref,b=e.type,g=void 0===b?"take_profit":b,E=(0,Ie.P)(),S=E.contract_type,w=E.currency,A=E.has_take_profit,O=E.has_stop_loss,k=E.is_accumulator,x=E.take_profit,C=E.stop_loss,T=E.trade_types,j=E.trade_type_tab,L=E.onChangeMultiple,P=E.validation_params,I="take_profit"===g,N=(0,Et.H1)(T,S,j),D=ga({error_fields:[g]}).message,M=o().useRef(!1),z=h||M,R=Ql(o().useState(I?A:O),2),F=R[0],U=R[1],q=Ql(o().useState(I?x:C),2),V=q[0],B=q[1],H=Ql(o().useState(""),2),G=H[0],Y=H[1],W=Ql(o().useState(null!==(t=null!=y?y:D)&&void 0!==t?t:""),2),$=W[0],J=W[1],X=Ql(o().useState(10),2),Z=X[0],Q=X[1],ee=o().useRef(null),te=o().useRef(null),re=o().useRef(),ne=(0,i.getDecimalPlaces)(w),oe=(0,i.getCurrencyDisplayCode)(w),ae=p?Le.A.Content:"div",ie=null===(r=P[N[0]])||void 0===r||null===(n=r[g])||void 0===n?void 0:n.min,le=null===(a=P[N[0]])||void 0===a||null===(l=a[g])||void 0===l?void 0:l.max,ce=Ql(o().useState({min_value:ie,max_value:le}),2),se=ce[0],ue=ce[1],de=Xl(Xl({},I?{has_take_profit:F}:{has_stop_loss:F}),{},{has_cancellation:!1},I?{take_profit:F?V:""}:{stop_loss:F?V:""}),fe=(0,Re.hi)({new_values:de,trade_store:E,trade_type:Object.keys(T)[0]});I&&null!==(c=fe.limit_order)&&void 0!==c&&c.stop_loss&&delete fe.limit_order.stop_loss,!I&&null!==(s=fe.limit_order)&&void 0!==s&&s.take_profit&&delete fe.limit_order.take_profit;var me=gt(["proposal"].concat(function(e){return function(e){if(Array.isArray(e))return tc(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ec(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(Object.entries(de).flat().join("-")),[Object.keys(T)[0],JSON.stringify(fe)]),fe,{enabled:F}).data,pe=se.min_value&&se.max_value?o().createElement(K.Localize,{i18n_default_text:"Acceptable range: {{min_value}} to {{max_value}} {{currency}}",values:{currency:oe,min_value:se.min_value,max_value:se.max_value}}):"",ye=function(e){var t=e.field_name,r=e.new_value;null!=v&&v.current&&t&&(v.current=Xl(Xl({},v.current),{},Zl({},t,r)))},_e=function(e){var t;z.current=!1,U(e),ye({field_name:I?"has_take_profit":"has_stop_loss",new_value:e}),e?(clearTimeout(re.current),re.current=(0,Re.rx)(te.current,ee.current)):(J(""),Y(""),ye({field_name:I?"tp_error_text":"sl_error_text",new_value:""}),null===(t=ee.current)||void 0===t||t.blur())};o().useEffect((function(){me&&function(e){var t,r,n,o=e.error,a=e.proposal,i=null!==(t=null==o?void 0:o.message)&&void 0!==t?t:"",l=(null==o||null===(r=o.details)||void 0===r?void 0:r.field)===g||!(null!=o&&null!==(n=o.details)&&void 0!==n&&n.field);if(Y(l?i:""),ye({field_name:I?"tp_error_text":"sl_error_text",new_value:l?i:""}),!se.min_value||!se.max_value){var c,s,u=null!==(c=null==a||null===(s=a.validation_params)||void 0===s?void 0:s[g])&&void 0!==c?c:{},d=u.min,f=u.max;ue((function(e){return e.min_value!==d&&d||e.max_value!==f&&f?{min_value:d,max_value:f}:e}))}z.current=!0}(me)}),[F,me]);var ve=$l(g).is_key_board_visible;return o().useEffect((function(){var e;ve&&(null===(e=window)||void 0===e||e.scrollTo({top:225,behavior:"smooth"}))}),[ve]),o().useEffect((function(){J(null!=y?y:"")}),[y]),o().useEffect((function(){ue((function(e){return e.min_value!==ie&&ie||e.max_value!==le&&le?{min_value:ie,max_value:le}:e}))}),[ie,le]),o().useEffect((function(){return function(){return clearTimeout(re.current)}}),[]),o().createElement(o().Fragment,null,o().createElement(ae,{className:(0,ke.A)("take-profit__wrapper",u)},o().createElement("div",{className:"take-profit__content"},o().createElement(je.E,null,I?o().createElement(K.Localize,{i18n_default_text:"Take profit"}):o().createElement(K.Localize,{i18n_default_text:"Stop loss"})),o().createElement(Qa.j,{checked:F,onChange:_e})),o().createElement(Le.T,{allowDecimals:!0,customType:"commaRemoval",className:"text-field--custom",disabled:!F,decimals:ne,"data-testid":I?"dt_tp_input":"dt_sl_input",inputMode:"decimal",id:g,message:F&&($||G||pe),minusDisabled:Number(V)-1<=0,name:g,noStatusIcon:!0,onChange:function(e){var t=String(e.target.value);t.length>1&&(t=/^[0-]+$/.test(t)?"0":t.replace(/^0*/,"").replace(/^\./,"0."));var r=t===V;z.current=r,r||(J(""),B(t),ye({field_name:g,new_value:t}))},placeholder:(0,K.localize)("Amount"),ref:ee,regex:/[^0-9.,]/g,status:$||G?"error":"neutral",textAlignment:"center",unitLeft:oe,variant:"fill",value:null!=V?V:"",onBeforeInput:function(e){var t,r,n;[".",","].includes(null!==(t=null===(r=e.nativeEvent)||void 0===r?void 0:r.data)&&void 0!==t?t:"")&&(null!==(n=null==V?void 0:V.length)&&void 0!==n?n:0)<=10?Q(ne?11+ne:10):null!=V&&V.includes(".")||Q(10)},maxLength:Z}),!F&&o().createElement("button",{className:"take-profit__overlay","data-testid":"dt_take_profit_overlay",onClick:function(){return _e(!0)}}),o().createElement("input",{ref:te,style:{height:0,opacity:0,display:"none"},inputMode:"decimal"}),k&&o().createElement(It.O,{color:"quill-typography__color--subtle",className:"take-profit__accu-information"},o().createElement(K.Localize,{i18n_default_text:"Note: Cannot be adjusted for ongoing accumulator contracts."}))),f&&o().createElement(Le.A.Footer,{alignment:"vertical",primaryAction:{content:o().createElement(K.Localize,{i18n_default_text:"Save"}),onAction:function(){if((z.current||!F)&&(!G||!F))if(V||!F){var e=!G&&F;L(Xl(Xl(Xl({},I?{has_take_profit:e}:{has_stop_loss:e}),I?{take_profit:G||"0"===V?"":V}:{stop_loss:G||"0"===V?"":V}),e?{has_cancellation:!1}:{})),_()}else J(I?(0,K.localize)("Please enter a take profit amount."):(0,K.localize)("Please enter a stop loss amount."))}},shouldCloseOnPrimaryButtonClick:!1}))}));function nc(e){return nc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nc(e)}function oc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ac(e,t,r){return(t=function(e){var t=function(e){if("object"!=nc(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=nc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==nc(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ic(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return lc(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?lc(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lc(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var cc=(0,ye.observer)((function(e){var t,r,n,a,i,l,c=e.closeActionSheet,s=(0,Ie.P)(),u=s.has_take_profit,d=s.has_cancellation,f=s.has_stop_loss,m=s.take_profit,p=s.onChangeMultiple,y=s.stop_loss,_=s.validation_errors,v=(0,_r.d)().addSnackbar,h=ic(o().useState(null!==(t=null==_||null===(r=_.take_profit)||void 0===r?void 0:r[0])&&void 0!==t?t:""),2),b=h[0],g=h[1],E=o().useRef({has_take_profit:u,take_profit:m,tp_error_text:null==_||null===(n=_.take_profit)||void 0===n?void 0:n[0]}),S=o().useRef(!1),w=ic(o().useState(null!==(a=null==_||null===(i=_.stop_loss)||void 0===i?void 0:i[0])&&void 0!==a?a:""),2),A=w[0],O=w[1],k=o().useRef({has_stop_loss:f,stop_loss:y,sl_error_text:null==_||null===(l=_.stop_loss)||void 0===l?void 0:l[0]}),x=o().useRef(!1);return o().createElement("div",{className:"risk-management__tp-sl__wrapper"},o().createElement(rc,{classname:"risk-management__tp-sl",has_save_button:!1,has_actionsheet_wrapper:!1,initial_error_text:b,onActionSheetClose:c,parent_ref:E,parent_is_api_response_received_ref:S}),o().createElement(rc,{classname:"risk-management__tp-sl",has_save_button:!1,has_actionsheet_wrapper:!1,initial_error_text:A,onActionSheetClose:c,parent_ref:k,parent_is_api_response_received_ref:x,type:"stop_loss"}),o().createElement(ir.$n,{color:"black-white",size:"lg",label:o().createElement(K.Localize,{i18n_default_text:"Save"}),fullWidth:!0,className:"risk-management__save-button",onClick:function(){if((S.current||!E.current.has_take_profit)&&(x.current||!k.current.has_stop_loss)){var e=E.current,t=e.has_take_profit,r=e.take_profit,n=e.tp_error_text,a=k.current,i=a.has_stop_loss,l=a.stop_loss,s=a.sl_error_text,u=!r&&t,f=!l&&i;if(u&&g(o().createElement(K.Localize,{i18n_default_text:"Please enter a take profit amount."})),f&&O(o().createElement(K.Localize,{i18n_default_text:"Please enter a stop loss amount."})),!(n&&t||s&&i||f||u)){var m=!n&&t,y=!s&&i;(m||y)&&d&&v({message:(0,Re.B1)({has_cancellation:d,has_stop_loss:y,has_take_profit:m,switching_tp_sl:!0}),hasCloseButton:!0}),p(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?oc(Object(r),!0).forEach((function(t){ac(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oc(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({has_take_profit:t,take_profit:n||"0"===r?"":r,has_stop_loss:i,stop_loss:s||"0"===l?"":l},m||y?{has_cancellation:!1}:{})),c()}}}}))}));const sc=cc;function uc(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const dc=function(e){var t=e.closeActionSheet,r=e.initial_tab_index,n=void 0===r?0:r,a=e.should_show_deal_cancellation,i=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return uc(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?uc(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o().useState(n),2),l=i[0],c=i[1];return o().createElement(Le.A.Content,{className:"risk-management__picker"},a&&o().createElement(Rl.v,{hasContainerWidth:!0,onChange:c,options:[{label:o().createElement(K.Localize,{i18n_default_text:"TP & SL"})},{label:o().createElement(K.Localize,{i18n_default_text:"Deal cancellation"})}],size:"sm",selectedItemIndex:l}),l?o().createElement(Gl,{closeActionSheet:t}):o().createElement(sc,{closeActionSheet:t}))};var fc=r("../../node_modules/@deriv-com/quill-ui/dist/components/SectionMessage/index.js");const mc=function(e){var t=e.should_show_deal_cancellation,r=[{definition:o().createElement(K.Localize,{i18n_default_text:"When your profit reaches or exceeds this amount, your trade will be closed automatically."}),is_displayed:!0,label:o().createElement(K.Localize,{i18n_default_text:"Take Profit"})},{definition:o().createElement(K.Localize,{i18n_default_text:"When your loss reaches or exceeds this amount, your trade will be closed automatically."}),is_displayed:!0,label:o().createElement(K.Localize,{i18n_default_text:"Stop loss"})},{definition:o().createElement(K.Localize,{i18n_default_text:"When this is active, you can cancel your trade within the chosen time frame. Your stake will be returned without loss."}),is_displayed:t,label:o().createElement(K.Localize,{i18n_default_text:"Deal cancellation"})}];return o().createElement(o().Fragment,null,r.map((function(e){var t=e.definition,r=e.is_displayed,n=e.label;return r&&o().createElement(o().Fragment,{key:t.props.i18n_default_text},o().createElement(je.E,{bold:!0},n),o().createElement(je.E,{className:"risk-management__description__definition"},t))})),t&&o().createElement(fc.H,{message:o().createElement(K.Localize,{i18n_default_text:"Take profit and/or stop loss are not available while deal cancellation is active."}),size:"sm",status:"info"}))};function pc(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var yc=(0,ye.observer)((function(e){var t=e.is_minimized,r=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return pc(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?pc(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o().useState(!1),2),n=r[0],a=r[1],l=(0,Ie.P)(),c=l.cancellation_range_list,s=l.cancellation_duration,u=l.currency,d=l.has_cancellation,f=l.has_take_profit,m=l.has_stop_loss,p=l.is_market_closed,y=l.take_profit,_=l.stop_loss,v=ga({error_fields:["stop_loss","take_profit"]}).is_error_matching_field,h=o().useCallback((function(){return a(!1)}),[]),b=(0,Re.Qv)(),g=(null==c?void 0:c.length)>0,E=(0,ke.A)("trade-params__option",t&&"trade-params__option--minimized"),S=[{id:1,component:o().createElement(dc,{closeActionSheet:h,initial_tab_index:Number(d),should_show_deal_cancellation:g})},{id:2,component:o().createElement(rl,{classname:"risk-management__description",description:o().createElement(mc,{should_show_deal_cancellation:g}),is_custom_description:!0})}];return o().createElement(o().Fragment,null,o().createElement(ni.A,{className:E,disabled:p,label:o().createElement(K.Localize,{i18n_default_text:"Risk management",key:"risk-management".concat(t?"-minimized":"")}),onClick:function(){return a(!0)},readOnly:!0,value:d?"DC: ".concat((0,Re._V)({value:s,unit:(0,K.localize)("minutes")})):f&&m?"TP: ".concat(y," ").concat((0,i.getCurrencyDisplayCode)(u)," / SL: ").concat(_," ").concat((0,i.getCurrencyDisplayCode)(u)):f?"TP: ".concat(y," ").concat((0,i.getCurrencyDisplayCode)(u)):m?"SL: ".concat(_," ").concat((0,i.getCurrencyDisplayCode)(u)):"-",variant:"fill",status:v?"error":"neutral"}),o().createElement(Le.A.Root,{isOpen:n,onClose:h,position:"left",expandable:!1,shouldBlurOnClose:n},o().createElement(Le.A.Portal,{shouldCloseOnDrag:!0},o().createElement(ii,{classname:(0,ke.A)("risk-management__carousel",b&&"risk-management__carousel--small"),header:yi,pages:S,title:o().createElement(K.Localize,{i18n_default_text:"Risk management"})}))))}));const _c=yc;function vc(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var hc=function(e){var t,r=e.trade_store,n=e.proposal_request_values,o=e.contract_type,a=e.contract_types,i=e.is_enabled,l=(0,Re.hi)({new_values:n,trade_store:r,trade_type:o}),c=n?Object.entries(n):[],s=["proposal"].concat(function(e){return function(e){if(Array.isArray(e))return vc(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return vc(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?vc(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(c.flat().join("-")),["".concat(null!==(t=null==n?void 0:n.amount)&&void 0!==t?t:""),JSON.stringify(l),a.join("-")]);return gt(s,l,{enabled:i})},bc=r("./src/Stores/Modules/Trading/Helpers/proposal.ts");function gc(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Ec=function(e){var t=e.contract_type,r=e.contract_types,n=e.currency,a=e.details,l=e.has_stop_loss,c=e.is_loading_proposal,s=e.is_multiplier,u=e.is_empty,d=e.should_show_payout_details,f=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return gc(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?gc(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o().useState({is_first_payout_exceeded:!1,is_second_payout_exceeded:!1,commission:"",first_contract_payout:"",max_payout:"",second_contract_payout:"",stop_out:""}),2),m=f[0],p=f[1];o().useEffect((function(){var e=function(e,t){return"-"===t&&c||!e||u?"-":(0,i.formatMoney)(n,Number(e),!0)},t=m.commission,r=m.first_contract_payout,o=m.is_first_payout_exceeded,l=m.is_second_payout_exceeded,s=m.second_contract_payout,d=m.stop_out,f=m.max_payout,y=e(Math.abs(Number(a.commission)),t),_=e(a.first_contract_payout,r),v=e(a.second_contract_payout,s),h=e(Math.abs(Number(a.stop_out)),d),b=e(a.max_payout,f);t===y&&r===_&&m.is_first_payout_exceeded===o&&m.is_second_payout_exceeded===l&&s===v&&d===h&&f===b||p({commission:y,first_contract_payout:_,is_first_payout_exceeded:o,is_second_payout_exceeded:l,second_contract_payout:v,stop_out:h,max_payout:b})}),[n,a,m,c,u]);var y=o().createElement(K.Localize,{i18n_default_text:"Payout"}),_=[{is_displayed:!l&&s&&!d,label:o().createElement(K.Localize,{i18n_default_text:"Stop out"}),value:m.stop_out},{is_displayed:s&&!d,label:o().createElement(K.Localize,{i18n_default_text:"Commission"}),value:m.commission},{is_displayed:!!a.max_payout&&d,label:o().createElement(K.Localize,{i18n_default_text:"Max payout"}),value:(0,i.formatMoney)(n,+a.max_payout,!0)},{contract_type:(0,i.getTradeTypeName)(r[0],{isHighLow:t===i.TRADE_TYPES.HIGH_LOW}),is_displayed:!!r.length&&d,label:y,has_error:a.is_first_payout_exceeded,value:m.first_contract_payout},{contract_type:(0,i.getTradeTypeName)(r[1],{isHighLow:t===i.TRADE_TYPES.HIGH_LOW}),is_displayed:r.length>1&&d,label:y,has_error:a.is_second_payout_exceeded,value:m.second_contract_payout}];return o().createElement("div",{className:"stake-content__details"},_.map((function(e,t){var r=e.contract_type,a=e.is_displayed,l=e.label,c=e.has_error,s=e.value;return a&&o().createElement("div",{key:"".concat(t,"_").concat(s),className:(0,ke.A)("stake-content__details-row",c&&"error")},o().createElement(je.E,{size:"sm"},l,r&&" (".concat(r,")")),o().createElement(je.E,{size:"sm"},s," ",(0,i.getCurrencyDisplayCode)(n)))})))};function Sc(e){return Sc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sc(e)}function wc(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Ac(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Oc(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ac(Object(r),!0).forEach((function(t){kc(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ac(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function kc(e,t,r){return(t=function(e){var t=function(e){if("object"!=Sc(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Sc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Sc(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var xc=function(e,t){switch(t.type){case"SET_PROPOSAL_VALUES":return Oc(Oc({},e),{},{proposal_request_values:Oc(Oc({},e.proposal_request_values),t.payload)});case"SET_STAKE_ERROR":return Oc(Oc({},e),{},{stake_error:t.payload});case"SET_FE_STAKE_ERROR":return Oc(Oc({},e),{},{fe_stake_error:t.payload});case"UPDATE_DETAILS":return Oc(Oc({},e),{},{details:Oc(Oc({},e.details),t.payload)});case"SET_MAX_LENGTH":return Oc(Oc({},e),{},{max_length:t.payload});case"RESET_ERRORS":return Oc(Oc({},e),{},{stake_error:"",fe_stake_error:""});default:return e}},Cc=function(e,t){var r,n=e.amount,o=e.commission,a=e.contract_type,i=e.trade_type_tab,l=e.trade_types,c=e.proposal_info,s=e.validation_params,u=e.stop_out,d=(0,Et.H1)(l,a,i),f=(0,Re.Nw)(c[d[0]]),m=f.contract_payout,p=f.max_payout,y=f.error,_=(0,Re.Nw)(c[d[1]]),v=_.contract_payout,h=_.error,b=(null!==(r=s[d[0]]||s[d[1]])&&void 0!==r?r:{}).stake,g=null!=b?b:{},E=g.max,S=void 0===E?0:E,w=g.min,A=void 0===w?0:w;return{proposal_request_values:{amount:n},stake_error:"",fe_stake_error:"",max_length:Tc(n,t),details:{commission:o,error_1:y,error_2:h,first_contract_payout:m,second_contract_payout:v,is_first_payout_exceeded:!!y&&m>p,is_second_payout_exceeded:!!h&&v>p,max_payout:p,max_stake:S,min_stake:A,stop_out:u}}},Tc=function(e,t){return String(e).includes(".")||String(e).includes(",")?11+t:10},jc=(0,ye.observer)((function(e){var t=e.onClose,r=e.is_open,n=(0,Ie.P)(),a=n.contract_type,l=n.currency,c=n.barrier_1,s=n.has_stop_loss,u=n.is_accumulator,d=n.is_multiplier,f=n.is_turbos,m=n.is_vanilla,p=n.onChange,y=n.trade_type_tab,_=n.trade_types,v=(0,i.getDecimalPlaces)(l),h=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return wc(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?wc(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o().useReducer(xc,null,(function(){return Cc(n,v)})),2),b=h[0],g=h[1],E=b.proposal_request_values,S=b.stake_error,w=b.fe_stake_error,A=b.details,O=o().useMemo((function(){return(0,Et.H1)(_,a,y)}),[_,a,y]),k=!(u||d||f||m),x="stake_input",C=$l(x).is_key_board_visible;o().useEffect((function(){var e;C&&(null===(e=window)||void 0===e||e.scrollTo({top:225,behavior:"smooth"}))}),[C]),o().useEffect((function(){var e=Cc(n,v);g({type:"SET_PROPOSAL_VALUES",payload:e.proposal_request_values}),g({type:"UPDATE_DETAILS",payload:e.details})}),[]);var T=O.length>1&&!d,j=!!A.error_1&&!!A.error_2,L=!T||T&&j,P=hc({trade_store:n,proposal_request_values:E,contract_type:O[0],contract_types:O,is_enabled:r}),I=P.data,N=P.is_fetching,D=hc({trade_store:n,proposal_request_values:E,contract_type:O[1],contract_types:O,is_enabled:r&&T}),M=D.data,z=D.is_fetching,R=N||T&&z,F=function(e,t){var r,o,a,i,l,s,u,p=e.error,y=e.proposal;if(""!==E.amount){if(m&&null!=p&&null!==(r=p.details)&&void 0!==r&&r.barrier_choices){var _=p.details.barrier_choices;if(null==_||!_.includes(c)){var v=Math.floor(_.length/2);return void g({type:"SET_PROPOSAL_VALUES",payload:{barrier_1:_[v]}})}}if(f&&null!=p&&null!==(o=p.details)&&void 0!==o&&o.payout_per_point_choices&&"payout_per_point"===(null==p||null===(a=p.details)||void 0===a?void 0:a.field)){var h=p.details.payout_per_point_choices,b=Math.floor(h.length/2);g({type:"SET_PROPOSAL_VALUES",payload:{payout_per_point:h[b]}})}else{var S=null!==(i=null==p?void 0:p.message)&&void 0!==i?i:"",w=["amount","stake"].includes(null!==(l=null==p||null===(s=p.details)||void 0===s?void 0:s.field)&&void 0!==l?l:"")||!(null!=p&&null!==(u=p.details)&&void 0!==u&&u.field);if(g({type:"SET_STAKE_ERROR",payload:w?S:""}),k){var O=(0,bc.vL)(n,e),x=(0,Re.Nw)(O),C=x.contract_payout,T=x.max_payout,j=x.error;g({type:"UPDATE_DETAILS",payload:Oc(Oc({},T?{max_payout:T}:{}),{},kc(kc(kc({},"".concat(t,"_contract_payout"),C||0),"is_".concat(t,"_payout_exceeded"),!!j&&C>T),"error_".concat("first"===t?1:2),j))})}else{if((!A.min_stake||!A.max_stake)&&null!=p&&p.details){var L=p.details,P=L.max_stake,I=L.min_stake;P&&I&&g({type:"UPDATE_DETAILS",payload:{max_stake:P,min_stake:I}})}if(y){var N,D,M=y,z=M.commission,R=M.limit_order,F=M.validation_params,U=null!==(N=null==F?void 0:F.stake)&&void 0!==N?N:{},q=U.max,V=U.min,B=(null!==(D=null==R?void 0:R.stop_out)&&void 0!==D?D:{}).order_amount;g({type:"UPDATE_DETAILS",payload:Oc(Oc({},d&&z&&B?{commission:z,stop_out:B}:{}),A.max_stake||A.min_stake?{}:{max_stake:q,min_stake:V})})}else!y&&d&&g({type:"UPDATE_DETAILS",payload:{commission:0,stop_out:0}})}}}else g({type:"SET_STAKE_ERROR",payload:""})};return o().useEffect((function(){I&&F(I,"first")}),[I]),o().useEffect((function(){M&&F(M,"second")}),[M]),o().createElement(o().Fragment,null,o().createElement(Le.A.Content,{className:"stake-content"},o().createElement(Le.T,{allowDecimals:!0,allowSign:!1,className:"text-field--custom",customType:"commaRemoval","data-testid":"dt_input_with_steppers",decimals:v,inputMode:"decimal",id:x,maxLength:b.max_length,message:w||L&&S||!!A.min_stake&&!!A.max_stake&&o().createElement(K.Localize,{i18n_default_text:"Acceptable range: {{min_stake}} to {{max_stake}} {{currency}}",values:{currency:(0,i.getCurrencyDisplayCode)(l),min_stake:(0,i.formatMoney)(l,+A.min_stake,!0),max_stake:(0,i.formatMoney)(l,+A.max_stake,!0)}}),minusDisabled:Number(E.amount)-1<=0,name:"amount",noStatusIcon:!0,onChange:function(e){var t=String(e.target.value);g({type:"SET_MAX_LENGTH",payload:Tc(t,v)}),t.endsWith(".")||t.endsWith(",")?g({type:"SET_FE_STAKE_ERROR",payload:(0,K.localize)("Should be a valid number.")}):t===String(E.amount)||(g({type:"RESET_ERRORS"}),g({type:"SET_PROPOSAL_VALUES",payload:{amount:t}}))},onBeforeInput:function(e){var t,r,n,o;[".",","].includes(null!==(t=null===(r=e.nativeEvent)||void 0===r?void 0:r.data)&&void 0!==t?t:"")&&(null!==(n=null===(o=String(E.amount))||void 0===o?void 0:o.length)&&void 0!==n?n:0)<=10&&g({type:"SET_MAX_LENGTH",payload:v?11+v:10})},placeholder:(0,K.localize)("Amount"),regex:/[^0-9.,]/g,status:w||L&&S?"error":"neutral",textAlignment:"center",unitLeft:(0,i.getCurrencyDisplayCode)(l),value:E.amount,variant:"fill"}),o().createElement(Ec,{contract_type:a,contract_types:O,currency:l,details:A,has_stop_loss:s,is_loading_proposal:R,is_multiplier:d,is_empty:!E.amount,should_show_payout_details:k})),o().createElement(Le.A.Footer,{alignment:"vertical",shouldCloseOnPrimaryButtonClick:!1,primaryAction:{content:o().createElement(K.Localize,{i18n_default_text:"Save"}),onAction:function(){N||T&&z||L&&S||w||(""!==E.amount?(p({target:{name:"amount",value:E.amount}}),t()):g({type:"SET_FE_STAKE_ERROR",payload:(0,K.localize)("Amount is a required field.")}))}}}))}));const Lc=jc;function Pc(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Ic=(0,ye.observer)((function(e){var t=e.is_minimized,r=(0,Ie.P)(),n=r.amount,a=r.currency,l=r.contract_type,c=r.has_open_accu_contract,s=r.is_market_closed,u=r.is_multiplier,d=r.trade_types,f=r.trade_type_tab,m=r.proposal_info,p=ga({error_fields:["stake","amount"]}).is_error_matching_field,y=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Pc(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Pc(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o().useState(!1),2),_=y[0],v=y[1],h=(0,Et.H1)(d,l,f),b=h.every((function(e){var t;return null==m||null===(t=m[e])||void 0===t?void 0:t.has_error})),g=1===h.length||u||b,E=o().useCallback((function(){return v(!1)}),[]);return o().createElement(o().Fragment,null,o().createElement(ni.A,{disabled:c||s,variant:"fill",readOnly:!0,label:o().createElement(K.Localize,{i18n_default_text:"Stake",key:"stake".concat(t?"-minimized":"")}),noStatusIcon:!0,onClick:function(){return v(!0)},value:"".concat(n," ").concat((0,i.getCurrencyDisplayCode)(a)),className:(0,ke.A)("trade-params__option",t&&"trade-params__option--minimized"),status:p&&g?"error":"neutral"}),o().createElement(Le.A.Root,{isOpen:_,onClose:E,position:"left",expandable:!1,shouldBlurOnClose:_},o().createElement(Le.A.Portal,{shouldCloseOnDrag:!0},o().createElement(Le.A.Header,{title:o().createElement(K.Localize,{i18n_default_text:"Stake"})}),o().createElement(Lc,{onClose:E,is_open:_}))))}));const Nc=Ic;var Dc=d()((function(e,t){return t(e)}),200);const Mc=function(e){var t=e.current_strike,r=e.currency,n=e.onStrikePriceSelect,a=e.payout_per_point,i=e.strike_price_list,l=e.setV2ParamsInitialValues,c=o().useRef(),s=o().useRef(t);return o().useEffect((function(){return!c.current&&t&&(c.current=t,l({value:t,name:"strike"})),function(){c.current&&c.current!==s.current&&n(c.current),Dc.cancel()}}),[]),o().createElement(o().Fragment,null,o().createElement(Le.A.Content,{className:"strike__wrapper","data-testid":"dt_strike_wrapper"},o().createElement("div",{className:"strike__wheel-picker"},o().createElement(nl.I,{data:i,selectedValue:s.current,setSelectedValue:function(e){e!==s.current&&(s.current=e,Dc(e,n))}})),o().createElement("div",{className:"strike__payout"},o().createElement(je.E,{color:"quill-typography__color--subtle",size:"sm"},o().createElement(K.Localize,{i18n_default_text:"Payout per point:"})),o().createElement(je.E,{size:"sm",as:"div",className:"strike__payout__content"},a?o().createElement(o().Fragment,null,a," ",r):o().createElement(Oe.Skeleton,{width:90,height:14})))),o().createElement(Le.A.Footer,{alignment:"vertical",primaryAction:{content:o().createElement(K.Localize,{i18n_default_text:"Save"}),onAction:function(){c.current=s.current,l({value:s.current,name:"strike"})}}}))};function zc(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Rc=(0,ye.observer)((function(e){var t,r,n=e.is_minimized,a=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return zc(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?zc(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o().useState(!1),2),l=a[0],c=a[1],s=(0,Ie.P)(),u=s.barrier_1,d=s.barrier_choices,f=s.contract_type,m=s.currency,p=s.is_market_closed,y=s.onChange,_=s.proposal_info,v=s.setV2ParamsInitialValues,h=s.v2_params_initial_values,b=(0,Re.Qv)(),g=d.map((function(e){return{value:e}})),E=(0,i.isEmptyObject)(_)?"":null===(t=_[f.toUpperCase()])||void 0===t||null===(r=t.obj_contract_basis)||void 0===r?void 0:r.value,S=function(e){return y({target:{name:"barrier_1",value:e}})},w=o().useCallback((function(){return c(!1)}),[]),A=[{id:1,component:o().createElement(Mc,{current_strike:u,currency:(0,i.getCurrencyDisplayCode)(m),onStrikePriceSelect:S,payout_per_point:E,strike_price_list:g,setV2ParamsInitialValues:v})},{id:2,component:o().createElement(rl,{description:o().createElement(o().Fragment,null,o().createElement("p",null,o().createElement(K.Localize,{i18n_default_text:"It is the price where you can start receiving a payout from an option."})),o().createElement("br",null),o().createElement("p",null,o().createElement(K.Localize,{i18n_default_text:"For a Call option, you receive a payout if the final price is higher than the strike price."})),o().createElement("br",null),o().createElement("p",null,o().createElement(K.Localize,{i18n_default_text:"For a Put option, you receive a payout if the final price is lower than the strike price."})))})}],O=(0,ke.A)("trade-params__option",n&&"trade-params__option--minimized");return o().useEffect((function(){var e=null==h?void 0:h.strike;e&&u!==e&&S(e)}),[]),u?o().createElement(o().Fragment,null,o().createElement(ni.A,{className:O,disabled:p,label:o().createElement(K.Localize,{i18n_default_text:"Strike price",key:"strike".concat(n?"-minimized":"")}),onClick:function(){return c(!0)},readOnly:!0,variant:"fill",value:u}),o().createElement(Le.A.Root,{isOpen:l,onClose:w,position:"left",expandable:!1,shouldBlurOnClose:l},o().createElement(Le.A.Portal,{shouldCloseOnDrag:!0},o().createElement(ii,{classname:(0,ke.A)("strike__carousel",b&&"strike__carousel--small"),header:yi,pages:A,title:o().createElement(K.Localize,{i18n_default_text:"Strike price"})})))):o().createElement("div",{className:O},o().createElement(Oe.Skeleton,null))}));const Fc=Rc;function Uc(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var qc=(0,ye.observer)((function(e){var t=e.is_minimized,r=(0,Ie.P)(),n=r.currency,a=r.has_open_accu_contract,l=r.has_take_profit,c=r.is_market_closed,s=r.take_profit,u=ga({error_fields:["take_profit"]}).is_error_matching_field,d=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Uc(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Uc(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o().useState(!1),2),f=d[0],m=d[1],p=o().useCallback((function(){return m(!1)}),[]),y=[{id:1,component:o().createElement(rc,{onActionSheetClose:p})},{id:2,component:o().createElement(rl,{description:o().createElement(K.Localize,{i18n_default_text:"When your profit reaches or exceeds the set amount, your trade will be closed automatically."})})}];return o().createElement(o().Fragment,null,o().createElement(ni.A,{className:(0,ke.A)("trade-params__option",t&&"trade-params__option--minimized"),disabled:a||c,label:o().createElement(K.Localize,{i18n_default_text:"Take profit",key:"take-profit".concat(t?"-minimized":"")}),onClick:function(){return m(!0)},readOnly:!0,variant:"fill",value:l&&s?"".concat(s," ").concat((0,i.getCurrencyDisplayCode)(n)):"-",status:u?"error":"neutral"}),o().createElement(Le.A.Root,{isOpen:f,onClose:p,position:"left",expandable:!1,shouldBlurOnClose:f},o().createElement(Le.A.Portal,{shouldCloseOnDrag:!0},o().createElement(ii,{header:yi,pages:y,title:o().createElement(K.Localize,{i18n_default_text:"Take profit"})}))))}));const Vc=qc;function Bc(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Hc=(0,ye.observer)((function(e){var t=e.is_minimized,r=(0,Ie.P)(),n=r.contract_type,a=r.is_market_closed,i=r.onChange,l=r.trade_type_tab,c=r.setTradeTypeTab,s=(0,Re.FN)(n),u=0;"VANILLALONGPUT"===l&&"vanillalongcall"===n||"TURBOSSHORT"===l&&"turboslong"===n||(u=s.findIndex((function(e){return l?e.contract_type===l:e.value===n})));var d=u<0?0:u,f=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Bc(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Bc(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o().useState(d),2),m=f[0],p=f[1];return o().useEffect((function(){var e;p(d),c(null===(e=s[d])||void 0===e?void 0:e.contract_type)}),[s,d]),s.length?o().createElement(Rl.v,{className:(0,ke.A)("trade-params__option",t&&"trade-params__option--minimized"),hasContainerWidth:!0,onChange:function(e){var t,r=null!==(t=s[e])&&void 0!==t?t:{},o=r.contract_type,a=r.value;p(e),c(o),a!==n&&i({target:{name:"contract_type",value:a}})},options:s.map((function(e){var t=e.label;return{disabled:a,label:t}})),selectedItemIndex:m,key:"".concat(m).concat(a)}):null}));const Gc=Hc;var Yc=(0,ye.observer)((function(e){var t=e.is_minimized,r=(0,Ie.P)(),n=r.contract_type,a=r.has_cancellation,i=r.symbol,l=function(e){return Ue({component_key:e,contract_type:n,has_cancellation:a,symbol:i})};return o().createElement("div",{className:(0,ke.A)("trade-params__options__wrapper",t&&"trade-params__options__wrapper--minimized")},t&&o().createElement(o().Fragment,null,l("expiration")&&o().createElement(Ol,null),l("payout_per_point_info")&&o().createElement(zl,null),l("allow_equals")&&o().createElement(ri,null),l("payout")&&o().createElement(kl,null)),o().createElement("div",{className:(0,ke.A)("trade-params__options__wrapper",t&&"trade-params__options__wrapper--horizontal")},l("trade_type_tabs")&&o().createElement(Gc,{is_minimized:t}),l("last_digit")&&o().createElement(hl,{is_minimized:t}),l("duration")&&o().createElement(tl,{is_minimized:t}),l("strike")&&o().createElement(Fc,{is_minimized:t}),l("barrier")&&o().createElement(hi,{is_minimized:t}),l("growth_rate")&&o().createElement(cl,{is_minimized:t}),l("multiplier")&&o().createElement(wl,{is_minimized:t}),l("stake")&&o().createElement(Nc,{is_minimized:t}),l("payout_per_point")&&o().createElement(Dl,{is_minimized:t}),l("allow_equals")&&!t&&o().createElement(ri,null),l("take_profit")&&o().createElement(Vc,{is_minimized:t}),l("risk_management")&&o().createElement(_c,{is_minimized:t}),l("expiration")&&!t&&o().createElement(Ol,null),l("accu_info_display")&&!t&&o().createElement(Za,null),l("barrier_info")&&!t&&o().createElement(gi,null),l("payout_per_point_info")&&!t&&o().createElement(zl,null),l("payout")&&!t&&o().createElement(kl,null)),l("mult_info_display")&&o().createElement(Al,{is_minimized:t}))}));const Wc=Yc;var $c=r("./src/Modules/Trading/Helpers/digits.ts"),Kc=r("./src/Modules/SmartChart/index.js"),Jc=r("./src/Modules/SmartChart/Components/Markers/accumulators-chart-elements.tsx"),Xc=r("./src/Modules/SmartChart/Components/toolbar-widgets.tsx");function Zc(e){return Zc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zc(e)}function Qc(){Qc=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),l=new j(n||[]);return o(i,"_invoke",{value:k(e,r,l)}),i}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",m="suspendedYield",p="executing",y="completed",_={};function v(){}function h(){}function b(){}var g={};s(g,i,(function(){return this}));var E=Object.getPrototypeOf,S=E&&E(E(L([])));S&&S!==r&&n.call(S,i)&&(g=S);var w=b.prototype=v.prototype=Object.create(g);function A(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function r(o,a,i,l){var c=d(e[o],e,a);if("throw"!==c.type){var s=c.arg,u=s.value;return u&&"object"==Zc(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,i,l)}),(function(e){r("throw",e,i,l)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return r("throw",e,i,l)}))}l(c.arg)}var a;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function k(t,r,n){var o=f;return function(a,i){if(o===p)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var l=n.delegate;if(l){var c=x(l,n);if(c){if(c===_)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var s=d(t,r,n);if("normal"===s.type){if(o=n.done?y:m,s.arg===_)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=y,n.method="throw",n.arg=s.arg)}}}function x(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),_;var a=d(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,_;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,_):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,_)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(Zc(t)+" is not iterable")}return h.prototype=b,o(w,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:h,configurable:!0}),h.displayName=s(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,s(e,c,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},A(O.prototype),s(O.prototype,l,(function(){return this})),t.AsyncIterator=O,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new O(u(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},A(w),s(w,c,"Generator"),s(w,i,(function(){return this})),s(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(T),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return l.type="throw",l.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],l=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(c&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,_):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),_}},t}function es(e,t,r,n,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,o)}function ts(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){es(a,n,o,i,l,"next",e)}function l(e){es(a,n,o,i,l,"throw",e)}i(void 0)}))}}function rs(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const ns=function(){var e=(0,Ie.P)(),t=e.processContractsForV2,r=e.onChange,o=e.symbol,a=Pt().activeSymbols,l=(0,n.useRef)(!1),c=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return rs(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?rs(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,n.useState)(""),2),s=c[0],u=c[1],d=(0,n.useCallback)((function(e){var t=l.current;return e.some((function(e){var r=!!t||1===e.exchange_is_open;return e.symbol===o&&r}))}),[o]),f=(0,n.useCallback)(function(){var e=ts(Qc().mark((function e(n){var a,c,s;return Qc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=l.current,c=!a&&n,s=o!=n&&n,u(n),!c&&!s){e.next=8;break}return e.next=7,r({target:{name:"symbol",value:n}});case 7:t();case 8:(0,i.setTradeURLParams)({symbol:n});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[r,t,o]);return(0,n.useEffect)((function(){var e=function(){var e=ts(Qc().mark((function e(){var t;return Qc().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!d(a)){e.next=4;break}e.t0=o,e.next=10;break;case 4:return e.next=6,(0,i.pickDefaultSymbol)(a);case 6:if(e.t1=e.sent,e.t1){e.next=9;break}e.t1="1HZ100V";case 9:e.t0=e.t1;case 10:t=e.t0,f(t),l.current=!0;case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[a,d,f,o]),{symbol:s}};function os(e){return os="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},os(e)}function as(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function is(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ls(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?is(Object(r),!0).forEach((function(t){cs(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):is(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function cs(e,t,r){return(t=function(e){var t=function(e){if("object"!=os(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=os(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==os(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ss=(0,ye.observer)((function(e){var t=e.digits,r=e.tick,n=(0,Ie.P)(),a=n.setDigitStats,i=n.setTickData;return o().useEffect((function(){i(r)}),[r]),o().useEffect((function(){a(t)}),[t.join("-")]),null})),us=(0,ye.observer)((function(){var e=(0,s.A)(),t=e.ui,r=e.common,n=e.contract_trade,a=e.portfolio,l=(0,Zo.Y)().isMobile,c=n.accumulator_barriers_data,u=n.accumulator_contract_barriers_data,d=n.chart_type,f=n.granularity,m=n.has_crossed_accu_barriers,p=n.markers_array,y=n.updateChartType,_=n.updateGranularity,v=o().useRef(null),h=a.all_positions,b=t.is_chart_countdown_visible,g=t.is_chart_layout_default,E=t.is_dark_mode_on,S=t.is_positions_drawer_on,w=r.current_language,A=r.is_socket_opened,O=Pt().activeSymbols,k=ns().symbol,x=(0,Ie.P)(),C=x.barriers_flattened,T=x.chartStateChange,j=x.chart_layout,L=x.contract_type,P=x.exportLayout,I=x.has_alternative_source,N=x.has_barrier,D=x.main_barrier_flattened,M=x.setChartStatus,z=x.show_digits_stats,R=x.onChange,F=x.prev_contract_type,U=x.wsForget,q=x.wsForgetStream,V=x.wsSendRequest,B=x.wsSubscribe,H=(0,i.isAccumulatorContract)(L),G=ls(ls({countdown:b,isHighestLowestMarkerEnabled:!1,language:w.toLowerCase(),position:g?"bottom":"left",theme:E?"dark":"light"},H?{whitespace:190,minimumLeftBars:l?3:void 0}:{}),N?{whitespace:110}:{}),Y=c||{},W=Y.current_spot,$=Y.current_spot_time;o().useEffect((function(){var e,t;(H||z)&&null!==(e=v.current)&&void 0!==e&&e.hasPredictionIndicators()&&(null===(t=v.current)||void 0===t||t.triggerPopup((function(){return R({target:{name:"contract_type",value:F}})})))}),[H,R,F,z]);var K=D?[D].concat(function(e){return function(e){if(Array.isArray(e))return as(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return as(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?as(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(C)):C,J=0===f?8:24;return k&&O.length?o().createElement(Kc.GR,{ref:v,barriers:K,contracts_array:p,bottomWidgets:ss,crosshair:l?0:void 0,crosshairTooltipLeftAllow:560,showLastDigitStats:!0,chartControlsWidgets:null,chartStatusListener:function(e){return M(!e,!0)},chartType:d,initialData:{activeSymbols:JSON.parse(JSON.stringify(O))},chartData:{activeSymbols:JSON.parse(JSON.stringify(O))},feedCall:{activeSymbols:!1},enabledNavigationWidget:!l,enabledChartFooter:!1,id:"trade",isMobile:l,isVerticalScrollEnabled:!1,maxTick:l?J:void 0,granularity:z||H?0:f,requestAPI:V,requestForget:U,requestForgetStream:q,requestSubscribe:B,settings:G,allowTickChartTypeOnly:z||H,stateChangeListener:T,symbol:k,topWidgets:function(){return o().createElement("div",null)},isConnectionOpened:A,clearChart:!1,toolbarWidget:function(){return o().createElement(Xc.A,{updateChartType:y,updateGranularity:_})},importedLayout:j,onExportLayout:P,shouldFetchTradingTimes:!1,hasAlternativeSource:I,getMarketsOrder:function(e){var t="synthetic_index",r=e.some((function(e){return e.market===t}));return e.slice().sort((function(e,t){return e.display_name<t.display_name?-1:1})).map((function(e){return e.market})).reduce((function(e,t){return-1===e.indexOf(t)&&e.push(t),e}),r?[t]:[])},should_zoom_out_on_yaxis:H,yAxisMargin:{top:l?76:106},isLive:!0,leftMargin:!l&&S?328:80},H&&o().createElement(Jc.A,{all_positions:h,current_spot:W,current_spot_time:$,has_crossed_accu_barriers:m,should_show_profit_text:!!u.accumulators_high_barrier,symbol:k,is_mobile:l})):null}));const ds=us;function fs(e){return fs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fs(e)}function ms(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ps(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ms(Object(r),!0).forEach((function(t){ys(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ms(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ys(e,t,r){return(t=function(e){var t=function(e){if("object"!=fs(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=fs(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==fs(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return vs(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?vs(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vs(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const hs=o().memo((function(e){var t=e.is_dark_mode_on,r=_s(o().useState(!1),2),n=r[0],a=r[1],i=o().useRef(),l=_s(Te("guide_dtrader_v2",{trade_types_selection:!1,trade_page:!1,positions_page:!1}),2),c=l[0],s=l[1],u=(c||{}).trade_types_selection,d=t?Me.fm.trade_type_selection.dark:Me.fm.trade_type_selection.light,f=function(){a(!1),s(ps(ps({},c),{},{trade_types_selection:!0}))};return o().useEffect((function(){return u||(i.current=setTimeout((function(){return a(!0)}),800)),function(){return clearTimeout(i.current)}}),[u]),u?null:o().createElement(Le.M,{isOpened:n,isNonExpandable:!0,isMobile:!0,showHandleBar:!0,shouldCloseModalOnSwipeDown:!0,toggleModal:f,primaryButtonLabel:o().createElement(K.Localize,{i18n_default_text:"Got it"}),primaryButtonCallback:f},o().createElement(Le.M.Header,{image:o().createElement(Je,{src:d,title:"trade_types_selection"}),title:o().createElement(K.Localize,{i18n_default_text:"Manage your trade types"})}),o().createElement(Le.M.Body,null,o().createElement(K.Localize,{i18n_default_text:"Pin, rearrange, or remove your favorite trade types for easy access."})))}));var bs=r("../../node_modules/react-beautiful-dnd/dist/react-beautiful-dnd.esm.js"),gs=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Standalone/StandaloneGripDotsVerticalBoldIcon.js"),Es=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Standalone/StandaloneCircleMinusFillIcon.js");function Ss(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const ws=function(e){var t=e.active,r=e.disabled,a=e.leftIcon,l=e.onLeftIconClick,c=e.onRightIconClick,s=e.rightIcon,u=e.title,d=o().createElement(gs.A,{iconSize:"sm",fill:"var(--component-textIcon-normal-default)"}),f=o().createElement(Es.A,{fill:"var(--core-color-solid-red-700)",iconSize:"sm"}),m=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ss(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ss(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,n.useState)(!1),2),p=m[0],y=m[1];return o().createElement("div",{className:(0,ke.A)("draggable-list-item",{"draggable-list-item--active":t})},o().createElement("div",{className:"draggable-list-item__left"},o().createElement("button",{className:"draggable-list-item__left-icon","data-testid":"dt_draggable_list_item_left_icon",onClick:l,disabled:r},a||d),o().createElement("div",{className:"draggable-list-item__title"},u)),o().createElement("button",{className:(0,ke.A)("draggable-list-item__icon",{"draggable-list-item__icon--disabled":r}),"data-testid":"dt_draggable_list_item_icon",onClick:function(){!(0,i.isTouchDevice)()&&c&&c()},onTouchMove:function(){p||y(!0)},onTouchEnd:function(){p||!c||r||c(),y(!1)},disabled:r},s||f))};function As(e){return As="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},As(e)}function Os(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ks(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Os(Object(r),!0).forEach((function(t){xs(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Os(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function xs(e,t,r){return(t=function(e){var t=function(e){if("object"!=As(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=As(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==As(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cs(){return Cs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cs.apply(null,arguments)}function Ts(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return js(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?js(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function js(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Ls=function(e){var t=e.category,r=e.draggedItemId,n=e.onRightIconClick,a=e.show_editing_divider;return o().createElement("div",{className:a?"draggable-list-category":""},o().createElement(bs.gL,{droppableId:t.id},(function(e){return o().createElement("div",Cs({},e.droppableProps,{ref:e.innerRef,className:"draggable-list-category__droppable-area"}),o().createElement(Ps,{items:t.items,draggedItemId:r,onRightIconClick:n}),e.placeholder)})))},Ps=function(e){var t=e.items,r=e.draggedItemId,n=e.onRightIconClick;return o().createElement(o().Fragment,null,t.map((function(e,a){return e.id&&o().createElement(bs.sx,{key:e.id,draggableId:e.id,index:a},(function(a){return o().createElement("div",Cs({ref:a.innerRef},a.draggableProps,a.dragHandleProps,{className:"draggable-list-category__item"}),o().createElement(ws,{title:e.title,onRightIconClick:function(){return n(e)},active:r===e.id,disabled:1===t.length}))}))})))};const Is=function(e){var t=e.categories,r=e.onRightIconClick,n=e.onDrag,a=e.show_editing_divider,i=Ts(o().useState(t),2),l=i[0],c=i[1],s=Ts(o().useState(null),2),u=s[0],d=s[1];return o().useEffect((function(){return c(t)}),[t]),o().createElement(bs.JY,{onDragEnd:function(e){if(d(null),e.destination){var t=function(e,t){var r=t.source,n=t.destination;if(!n)return e;var o=e.findIndex((function(e){return e.id===r.droppableId})),a=e.findIndex((function(e){return e.id===n.droppableId}));if(-1===o||-1===a)return e;var i=e[o],l=e[a],c=Array.from(i.items),s=Ts(c.splice(r.index,1),1)[0];if(o===a)c.splice(n.index,0,s);else{var u=Array.from(l.items);u.splice(n.index,0,s),e[a]=ks(ks({},l),{},{items:u})}return e[o]=ks(ks({},i),{},{items:c}),Array.from(e)}(l,e);c(t),null==n||n(t)}},onDragStart:function(e){return d(e.draggableId)}},l.map((function(e){return o().createElement(Ls,{key:e.id,category:e,draggedItemId:u,onRightIconClick:r,show_editing_divider:a})})))};var Ns=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Standalone/StandaloneCirclePlusFillIcon.js");const Ds=function(e){var t=e.title,r=e.selected,n=e.leftIcon,a=e.rightIcon,i=e.onLeftIconClick,l=e.onRightIconClick,c=e.onTradeTypeClick,s=o().createElement(Ns.A,{fill:"var(--core-color-solid-green-700)",iconSize:"sm"});return o().createElement("div",{className:(0,ke.A)("trade-type-list-item",{"trade-type-list-item--selected":r}),onClick:c,onKeyDown:c},n&&o().createElement("button",{className:"trade-type-list-item__left-icon","data-testid":"dt_trade_type_list_item_left_icon",onClick:i},n),o().createElement("div",{className:"trade-type-list-item__title"},t),l&&o().createElement("button",{className:"trade-type-list-item__icon","data-testid":"dt_trade_type_list_item_right_icon",onClick:l},a||s))};function Ms(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const zs=function(e){var t,r=e.categories,n=e.isSelected,a=e.selectable,i=e.show_divider,l=e.onRightIconClick,c=e.onTradeTypeClick,s=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ms(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ms(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o().useState(r),2),u=s[0],d=s[1];return o().useEffect((function(){d(r)}),[r]),null!=r&&null!==(t=r[0])&&void 0!==t&&t.items.length?o().createElement(o().Fragment,null,null==u?void 0:u.map((function(e){var t;return o().createElement("div",{key:e.id,className:(0,ke.A)("trade-type-list-category",{"trade-type-list-category__border":e.items&&e.items.length>0&&i})},o().createElement("div",{className:"trade-type-list-category__items"},null===(t=e.items)||void 0===t?void 0:t.map((function(e){return o().createElement("div",{key:e.id},o().createElement(Ds,{title:e.title,selected:!!a&&n(e.id),onRightIconClick:l&&function(){return l(e)},onTradeTypeClick:c}))}))))}))):null},Rs=function(e){var t=e.handleCustomizeTradeTypes,r=e.handleRemovePinnedClick,n=e.handleOnDrag,a=e.handleOnTradeTypeSelect,i=e.handleAddPinnedClick,l=e.is_editing,c=e.is_dark_mode_on,s=e.isTradeTypeSelected,u=e.savePinnedToLocalStorage,d=e.show_trade_type_list_divider,f=e.show_editing_divider,m=e.other_trade_types,p=e.pinned_trade_types;return o().createElement(o().Fragment,null,o().createElement("div",null,o().createElement("div",{className:"draggable-list-category-header"},o().createElement(je.E,{size:"sm",bold:!0,className:"draggable-list-category-header-title"},l&&o().createElement(K.Localize,{i18n_default_text:"Pinned"})),o().createElement(ir.$n,{color:c?"white":"black",variant:"secondary",className:"draggable-list-category-header-button",onClick:l?u:t},l?o().createElement(K.Localize,{i18n_default_text:"Done"}):o().createElement(K.Localize,{i18n_default_text:"Customise"})))),o().createElement(Le.A.Content,{className:"trade-types-dialog__content"},l?o().createElement(Is,{categories:p,onRightIconClick:r,onDrag:n,show_editing_divider:f}):o().createElement(zs,{categories:p,onTradeTypeClick:a,isSelected:s,selectable:!0,show_divider:d}),o().createElement(zs,{categories:m,onRightIconClick:l?i:void 0,onTradeTypeClick:l?void 0:a,isSelected:s,selectable:!l})))};function Fs(e){return Fs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fs(e)}function Us(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function qs(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Us(Object(r),!0).forEach((function(t){Vs(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Us(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Vs(e,t,r){return(t=function(e){var t=function(e){if("object"!=Fs(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Fs(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Fs(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bs(e){return function(e){if(Array.isArray(e))return Ys(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Gs(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Hs(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||Gs(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gs(e,t){if(e){if("string"==typeof e)return Ys(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ys(e,t):void 0}}function Ys(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Ws=o().memo((function(e){var t,r,a,i,l,c=e.contract_type,s=e.onTradeTypeSelect,u=e.trade_types,d=e.is_dark_mode_on,f=Hs(o().useState(!1),2),m=f[0],p=f[1],y=Hs(o().useState(!1),2),_=y[0],v=y[1],h=o().useRef(null),b=null!==(t=localStorage.getItem("pinned_trade_types"))&&void 0!==t?t:"[]",g=(0,n.useMemo)((function(){var e;return null!==(e=(0,xe.xL)(b))&&void 0!==e?e:[]}),[b]),E=Hs((0,n.useState)([]),2),S=E[0],w=E[1],A=Hs((0,n.useState)(g),2),O=A[0],k=A[1],x=(0,n.useMemo)((function(){return e=[],u.forEach((function(t){var r;e.push({id:t.value,title:null!==(r=t.text)&&void 0!==r?r:""})})),e;var e}),[u]),C=(0,n.useCallback)((function(){var e=M(D(g),x);return 0===e.length&&e.push.apply(e,Bs(x.slice(0,x.length))),e}),[g,x]),T=(0,n.useCallback)((function(){var e=C(),t=[{id:"pinned",title:(0,K.localize)("Pinned"),items:e}],r=[{id:"other",items:x.filter((function(t){return!e.some((function(e){return e.id===t.id}))}))}];k(t),w(r)}),[C,x]);(0,n.useEffect)((function(){T()}),[T]),(0,n.useEffect)((function(){I()}),[]);var j,L,P=function(e,t){return e.map((function(e){return qs(qs({},e),{},{items:e.items.filter((function(e){return e.id!==t.id}))})}))},I=function(){setTimeout((function(){var e=0;if(h.current){var t=h.current.querySelector('button[data-state="selected"]');t&&(e=t.getBoundingClientRect().x-(window.innerWidth-t.getBoundingClientRect().width)/2||0),h.current.scrollBy({left:e,top:0})}}),0)},N=function(e){return St([c,e])||c===e},D=function(e){return e.flatMap((function(e){return e.items}))},M=function(e,t){var r=t.map((function(e){return e.id}));return e.filter((function(e){return r.includes(e.id)}))},z=(L=(j=C()).some((function(e){return e.id===c}))?null:D(S).find((function(e){return e&&(e.id===c||St([e.id,c]))})),[].concat(Bs(j),[L]).filter(Boolean)),R=z.length>=2||D(S).length>0,F=!(null===(r=S[0])||void 0===r||null===(a=r.items)||void 0===a||!a.length),U=x.length!==(null===(i=O[0])||void 0===i||null===(l=i.items)||void 0===l?void 0:l.length),q={handleCustomizeTradeTypes:function(){v(!0)},handleRemovePinnedClick:function(e){k((function(t){return P(t,e)})),w((function(t){return function(e,t){return e.map((function(e){return"other"===e.id?qs(qs({},e),{},{items:(0,Et.c1)(u,[].concat(Bs(e.items),[t]))}):e}))}(t,e)}))},handleOnDrag:function(e){k(e)},handleOnTradeTypeSelect:function(e){s(e,"trade_type_page",C().length),I(),p(!1)},handleAddPinnedClick:function(e){w((function(t){return P(t,e)})),k((function(t){return function(e,t,r){return e.map((function(e){return"pinned"===e.id?qs(qs({},e),{},{items:"add"===r?[].concat(Bs(e.items),[t]):e.items.filter((function(e){return e.id!==t.id}))}):e}))}(t,e,"add")}))},is_editing:_,is_dark_mode_on:d,isTradeTypeSelected:N,savePinnedToLocalStorage:function(){localStorage.setItem("pinned_trade_types",JSON.stringify(O)),v(!1)},show_trade_type_list_divider:F,show_editing_divider:U,other_trade_types:S,pinned_trade_types:O},V=[{id:1,component:o().createElement(Rs,q)},{id:2,component:o().createElement(Ja,{show_trigger_button:!1,is_open_by_default:!0,show_description_in_a_modal:!1})}];return o().createElement("div",{className:"trade__trade-types",ref:h},z.map((function(e){var t=e.title,r=e.id;return o().createElement(Oa.v.Selectable,{key:r,onChipSelect:function(e){return s(e,"main_trade_page",C().length)},selected:N(r)},o().createElement(je.E,{size:"sm"},t))})),R&&o().createElement(ir.$n,{key:"trade-types-all",onClick:function(){T(),p(!0)},variant:"tertiary",className:"trade__trade-types-header",color:d?"white":"black"},o().createElement(je.E,{size:"sm",bold:!0,underlined:!0,color:"var(--component-button-label-color-blackWhite-tertiary)"},o().createElement(K.Localize,{i18n_default_text:"View all"}))),o().createElement(Le.A.Root,{className:(0,ke.A)("trade-types-dialog",{"trade-types-dialog--is_editing":_}),isOpen:m,expandable:!1,onClose:function(){p(!1),v(!1)}},o().createElement(Le.A.Portal,{shouldCloseOnDrag:!0},_?o().createElement(o().Fragment,null,o().createElement(Le.A.Header,{title:o().createElement("div",{className:"trade-types-dialog__title"},o().createElement(K.Localize,{i18n_default_text:"Trade types"}))}),o().createElement(Rs,q)):o().createElement(ii,{header:yi,pages:V,title:o().createElement(K.Localize,{i18n_default_text:"Trade types"}),next_icon:Sa.A,onNextButtonClick:function(){return(0,wo.YL)(c,"trade_type_page")}}))),m&&o().createElement(hs,{is_dark_mode_on:d}))}));function $s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ks(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ks(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ks(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Js=(0,ye.observer)((function(){var e=$s(o().useState(!1),2),t=e[0],r=e[1],a=o().useRef(null),i=(0,s.A)(),l=i.client,c=l.is_logged_in,u=l.is_switching,d=i.common,f=d.current_language,m=d.network_status,p=i.ui.is_dark_mode_on,y=(0,Ie.P)(),_=y.active_symbols,v=y.contract_type,h=y.has_cancellation,b=y.is_accumulator,g=y.is_multiplier,E=y.is_market_closed,S=y.onChange,w=y.onMount,A=y.onUnmount,O=y.symbol,k=y.proposal_info,x=y.trade_types,C=y.trade_type_tab,T=Ot(),j=T.trade_types,L=T.resetTradeTypes,P=$s(Te("guide_dtrader_v2",{trade_types_selection:!1,trade_page:!1,positions_page:!1}),1)[0],I=(0,Et.H1)(x,v,C),N=I.every((function(e){var t;return null==k||null===(t=k[e])||void 0===t?void 0:t.has_error})),D=1===I.length||g||N,M=o().useMemo((function(){return _.map((function(e){return{text:e.display_name,value:e.symbol}}))}),[_]),z=o().useCallback((function(e,t,r){var n,o=null===(n=j.find((function(t){return t.text===e.target.textContent})))||void 0===n?void 0:n.value;S({target:{name:"contract_type",value:o}}),(0,wo.bC)(o||"",t,O,r)}),[j,S,O]),R=o().useCallback((function(){var e=null==a?void 0:a.current;if(e){var t=e.getBoundingClientRect().bottom,n=window.innerHeight-56;r(t<=n)}}),[]);return o().useEffect((function(){return w(),A}),[f,m.class]),(0,n.useEffect)((function(){u&&L()}),[u]),o().createElement(pt,{onScroll:R},M.length&&j.length&&!u?o().createElement(o().Fragment,null,o().createElement("div",{className:"trade"},o().createElement(Ws,{contract_type:v,onTradeTypeSelect:z,trade_types:j,is_dark_mode_on:p}),o().createElement(Lo,null),(0,$c.E)(v)&&o().createElement(nr,null),o().createElement(Xa,null,o().createElement(Wc,null)),o().createElement("div",{className:"trade__chart-tooltip"},o().createElement("section",{className:(0,ke.A)("trade__chart",{"trade__chart--with-borderRadius":!b}),style:{height:qe({is_accumulator:b,symbol:O,has_cancellation:h,contract_type:v})},ref:a},o().createElement(ds,null))),b&&o().createElement(nt,null)),o().createElement("div",{className:(0,ke.A)("trade__parameter",{"trade__parameter--with-button":!E})},o().createElement(Xa,{is_minimized_visible:t,is_minimized:!0},o().createElement(Wc,{is_minimized:!0})),!E&&o().createElement(da,null)),!(null!=P&&P.trade_page)&&c&&o().createElement(Xo,{type:"trade_page",is_dark_mode_on:p})):o().createElement(Oe.Loading.DTraderV2,null),o().createElement(ha,null),o().createElement(Yt,null),o().createElement(Ea,{error_fields:["stop_loss","take_profit","date_start","stake","amount"],should_show_snackbar:D}))}));const Xs=Js;var Zs=r("./src/AppV2/Utils/positions-utils.ts"),Qs=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Standalone/StandaloneSearchFillIcon.js"),eu=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Standalone/StandaloneBriefcaseFillIcon.js");const tu=function(e){var t=e.isClosedTab,r=e.noMatchesFound,n=r?Qs.A:eu.A;return o().createElement("div",{className:"empty-positions__".concat(t?Zs.Eu.CLOSED.toLowerCase():Zs.Eu.OPEN.toLowerCase())},o().createElement("div",{className:"icon","data-testid":"dt_empty_state_icon"},o().createElement(n,{iconSize:"2xl"})),o().createElement("div",{className:"message"},o().createElement(je.E,{bold:!0,size:"lg",color:"quill-typography__color--subtle"},r&&o().createElement(K.Localize,{i18n_default_text:"No matches found"}),!r&&(t?o().createElement(K.Localize,{i18n_default_text:"No closed positions"}):o().createElement(K.Localize,{i18n_default_text:"No open positions"}))),o().createElement(je.E,{size:"sm",centered:!0,color:"quill-typography__color--subtle"},r&&o().createElement(K.Localize,{i18n_default_text:"Try changing or removing filters to view available positions."}),!r&&(t?o().createElement(K.Localize,{i18n_default_text:"Your closed positions will be shown here."}):o().createElement(K.Localize,{i18n_default_text:"Your open positions will appear here."})))))};var ru=r("../../node_modules/@deriv/quill-icons/dist/esm/react/LabelPaired/LabelPairedStopwatchCaptionRegularIcon.js"),nu=function(e){var t=e.currentTick,r=e.date_expiry,n=e.isSold,a=e.serverTime,l=t?"".concat(null!=t?t:0," ").concat((0,i.getCardLabels)().TICKS.toLowerCase()):r&&a?o().createElement(Oe.RemainingTime,{as:"span",end_time:r,getCardLabels:i.getCardLabels,start_time:a,key:"remaining-time"}):null;return!r||(null==a?void 0:a.unix())>+r||n?o().createElement(vr.v,{className:"status",label:(0,i.getCardLabels)().CLOSED,variant:"custom",color:"custom",size:"sm"}):l?o().createElement(vr.v,{className:"timer",icon:o().createElement(ru.A,{key:"open-contract-card",fill:"var(--component-tag-label-color-default)"}),label:l,variant:"custom",size:"sm"}):null};const ou=function(e){var t=e.formatted_date,r=e.formatted_time;return t&&r?o().createElement(vr.v,{color:"info",className:"forward-starting","data-testid":"dt_forward-starting",label:o().createElement(K.Localize,{i18n_default_text:"Starts on {{formatted_date}}, {{formatted_time}}",values:{formatted_date:t,formatted_time:r}}),showIcon:!1,size:"sm",variant:"fill"}):null};function au(e){return au="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},au(e)}function iu(){return iu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},iu.apply(null,arguments)}function lu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function cu(e,t,r){return(t=function(e){var t=function(e){if("object"!=au(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=au(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==au(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function su(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return uu(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?uu(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function uu(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var du="left",fu={trackMouse:!0,preventScrollOnSwipe:!0};const mu=function(e){var t,r,n,a=e.className,l=void 0===a?"contract-card":a,c=e.contractInfo,s=e.currency,u=e.hasActionButtons,d=e.isSellRequested,f=e.onCancel,m=e.onClick,p=e.onClose,y=e.redirectTo,_=e.serverTime,v=su(o().useState(!1),2),h=v[0],b=v[1],g=su(o().useState(!1),2),E=g[0],S=g[1],w=su(o().useState(!1),2),A=w[0],O=w[1],k=su(o().useState(!1),2),x=k[0],C=k[1],T=c,j=T.buy_price,L=T.contract_type,P=T.display_name,I=T.purchase_time,N=T.sell_time,D=T.shortcode,M=T.limit_order,z=null!=M?M:{take_profit:{},stop_loss:{}},R=z.take_profit,F=z.stop_loss,U=(0,i.isHighLow)({shortcode:D}),q=(0,i.getTradeTypeName)(null!=L?L:"",{isHighLow:U,showMainTitle:!0}),V="cancellation"in c?null===(t=c.cancellation)||void 0===t?void 0:t.date_expiry:null,B="tick_count"in c&&c.tick_count?(0,i.getCurrentTick)(c):null,H="".concat(q," ").concat((0,i.getTradeTypeName)(null!=L?L:"",{isHighLow:U})).trim(),G="underlying_symbol"in c?(0,i.getMarketName)(null!==(r=c.underlying_symbol)&&void 0!==r?r:""):P,Y=(0,i.isCryptoContract)(c.underlying),W=(0,i.isMultiplierContract)(L),$=!!N||(0,i.isEnded)(c),K=(0,Zs.Dd)(c),J=(0,i.isValidToCancel)(c),X=(0,i.isValidToSell)(c)&&!d,Z=d&&A,Q=d&&E,ee=W&&!Y,te=(0,i.isForwardStarting)(null!=D?D:"",I),re=(0,i.getStartTime)(null!=D?D:""),ne=(0,i.hasForwardContractStarted)(null!=D?D:""),oe=te&&!!re&&!ne&&!$,ae=(!ee||ee&&$)&&!oe,ie=y?be.NavLink:"div",le=function(e){C(e===du)},ce=(0,Mo.useSwipeable)(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?lu(Object(r),!0).forEach((function(t){cu(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lu(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({onSwipedLeft:function(){return le(du)},onSwipedRight:function(){return le("right")}},fu)),se=function(e,t){e.preventDefault(),e.stopPropagation(),t?(null==f||f(e),O(!0)):(null==p||p(e),S(!0))},ue=(n=[],null!=R&&R.order_amount&&n.push("TP"),null!=F&&F.order_amount&&n.push("SL"),J&&n.push("DC"),n),de=!!ue.length&&!$;return o().useEffect((function(){$&&u&&b(!0)}),[$,u]),L?o().createElement("div",{className:(0,ke.A)("".concat(l,"-wrapper"),{deleted:h})},o().createElement(ie,iu({},u?ce:{},{className:(0,ke.A)(l,{"show-buttons":x,"has-cancel-button":J,lost:Number(K)<0,won:Number(K)>=0}),onClick:m,onDragStart:function(e){return e.preventDefault()},to:y}),o().createElement("div",{className:"".concat(l,"__body")},o().createElement("div",{className:"".concat(l,"__details")},o().createElement(Oe.IconTradeTypes,{type:U?"".concat(L,"_barrier"):L,size:16}),o().createElement("div",{className:"tag__wrapper"},de&&ue.map((function(e){return o().createElement(vr.v,{className:"risk-management",label:e,key:e,variant:"custom",size:"sm"})})),ae&&o().createElement(nu,iu({currentTick:B,isSold:$,serverTime:_},c)),oe&&o().createElement(ou,{formatted_date:(0,i.formatDate)((0,i.toMoment)(parseInt(re||"")),"DD MMM YYYY"),formatted_time:(0,i.formatTime)(parseInt(re||""),"HH:mm [GMT]")}))),o().createElement("div",{className:"".concat(l,"__details")},o().createElement(je.E,{className:"trade-type",size:"sm"},H),o().createElement(je.E,{size:"sm",color:"quill-typography__color--subtle"},o().createElement(Oe.Money,{amount:j,currency:s,show_currency:!0}))),o().createElement("div",{className:"".concat(l,"__details")},o().createElement(je.E,{size:"sm",className:"symbol",color:"quill-typography__color--subtle"},G),o().createElement(je.E,{className:"profit",size:"sm"},o().createElement(Oe.Money,{amount:K,currency:s,has_sign:!0,show_currency:!0})))),u&&o().createElement("div",{className:"buttons"},J&&o().createElement("button",{className:(0,ke.A)({loading:Z}),disabled:Number(c.profit)>=0||d,onClick:function(e){return se(e,!0)}},Z?o().createElement("div",{className:"circle-loader","data-testid":"dt_button_loader"}):o().createElement(o().Fragment,null,o().createElement(It.O,{bold:!0,as:"div",className:"label",color:"quill-typography__color--prominent"},(0,i.getCardLabels)().CANCEL),V&&o().createElement(It.O,{bold:!0,as:"div",className:"label",color:"quill-typography__color--prominent"},o().createElement(Oe.RemainingTime,{end_time:V,format:"mm:ss",getCardLabels:i.getCardLabels,start_time:_})))),o().createElement("button",{className:(0,ke.A)({loading:Q}),disabled:!X,onClick:se},Q?o().createElement("div",{className:"circle-loader","data-testid":"dt_button_loader"}):o().createElement(It.O,{bold:!0,as:"div",className:"label",color:"var(--component-textIcon-static-prominentDark)"},(0,i.getCardLabels)().CLOSE))))):null};var pu=["hasButtonsDemo","onClickCancel","onClickSell","positions","setHasButtonsDemo"];function yu(){return yu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yu.apply(null,arguments)}const _u=function(e){var t=e.hasButtonsDemo,r=e.onClickCancel,n=e.onClickSell,a=e.positions,l=void 0===a?[]:a,c=e.setHasButtonsDemo,s=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,pu);return o().useEffect((function(){var e;return t&&c&&(e=setTimeout((function(){return c(!1)}),720)),function(){e&&clearTimeout(e)}}),[]),l.length?o().createElement("div",{className:(0,ke.A)("contract-card-list",{"contract-card-list--has-buttons-demo":t&&!l[0].contract_info.sell_time})},l.map((function(e){var t=e.contract_info.contract_id;return o().createElement(mu,yu({key:t,contractInfo:e.contract_info,hasActionButtons:!!n,isSellRequested:e.is_sell_requested,onCancel:function(){return t&&(null==r?void 0:r(t))},onClose:function(){return t&&(null==n?void 0:n(t))},redirectTo:t?{pathname:(0,i.getContractPath)(t),state:{from_table_row:!0}}:""},s))}))):null};var vu=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Standalone/StandaloneLoaderBoldIcon.js");function hu(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const bu=o().memo((function(e){var t=e.isLoadingMore,r=e.hasBottomMargin,n=e.positions,a=e.currency,l=function(e){if("string"==typeof e){var t=e.split(" ");return"".concat(t[0]," ").concat(t[1]," ").concat(t[2])}return(0,i.toMoment)(e).format("DD MMM YYYY")},c=null==n?void 0:n.map((function(e){return e.contract_info.sell_time?l(e.contract_info.sell_time):e.contract_info.purchase_time_unix&&l(e.contract_info.purchase_time_unix)})),s=function(e){return function(e){if(Array.isArray(e))return hu(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return hu(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?hu(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(new Set(c));return null!=n&&n.length?o().createElement(o().Fragment,null,o().createElement("div",{className:(0,ke.A)("contract-cards-sections",r&&"contract-cards-sections--has-bottom-margin")},s.map((function(e){return o().createElement("div",{className:"contract-cards-section",key:e},o().createElement(je.E,{as:"p",className:"contract-cards-section__title",bold:!0,size:"sm"},e),o().createElement(_u,{positions:n.filter((function(t){return t.contract_info.sell_time?l(t.contract_info.sell_time)===e:t.contract_info.purchase_time_unix&&l(t.contract_info.purchase_time_unix)===e})),currency:a}))}))),t&&o().createElement("div",{className:"load-more-spinner","data-testid":"dt_load_more_spinner"},o().createElement(vu.A,{iconSize:"md"}))):null}));function gu(e){return function(e){if(Array.isArray(e))return wu(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Su(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Eu(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||Su(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Su(e,t){if(e){if("string"==typeof e)return wu(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?wu(e,t):void 0}}function wu(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Au=function(e){var t=e.contractTypeFilter,r=e.onApplyContractTypeFilter,n=Eu(o().useState(!1),2),a=n[0],i=n[1],l=Eu(o().useState(t),2),c=l[0],s=l[1],u=function(e){var t=e.target.id;c.includes(t)?s(gu(c.filter((function(e){return e!==t})))):s([].concat(gu(c),[t]))};return o().createElement(o().Fragment,null,o().createElement(Oa.v.Standard,{className:"filter__chip",dropdown:!0,isDropdownOpen:a,onClick:function(){return i(!a)},selected:!!c.length,size:"md"},o().createElement(je.E,{size:"sm"},o().createElement(K.Localize,{i18n_default_text:"Trade types"})),!!c.length&&o().createElement(je.E,null,"(",c.length,")")),o().createElement(Le.A.Root,{isOpen:a,onClose:function(){i(!1),s(t)},position:"left",expandable:!1},o().createElement(Le.A.Portal,{shouldCloseOnDrag:!0},o().createElement(Le.A.Header,{title:o().createElement(K.Localize,{i18n_default_text:"Filter by trade types"})}),o().createElement(Le.A.Content,{className:"filter__item__wrapper"},Et.Ou.map((function(e){var t=e.tradeType,r=e.id;return o().createElement(Le.e,{checked:c.includes(r),checkboxPosition:"right",className:"filter__item",id:r,key:r,label:t,onChange:u,size:"md"})}))),o().createElement(Le.A.Footer,{alignment:"horizontal",isSecondaryButtonDisabled:!c.length,primaryAction:{content:o().createElement(K.Localize,{i18n_default_text:"Apply"}),onAction:function(){return r(c)}},secondaryAction:{content:o().createElement(K.Localize,{i18n_default_text:"Clear All"}),onAction:function(){return s([])}},shouldCloseOnSecondaryButtonClick:!1}))))};var Ou=r("../../node_modules/@deriv-com/quill-ui/dist/components/SelectionControl/radio/radio-group/index.js"),ku=r("../../node_modules/@deriv/quill-icons/dist/esm/react/LabelPaired/LabelPairedChevronRightSmBoldIcon.js");const xu=function(e){var t=e.customTimeRangeFilter,r=e.setShowDatePicker;return o().createElement("button",{className:"custom-time-filter__wrapper",onClick:function(){return r(!0)}},o().createElement(je.E,{size:"md",className:"custom-time-filter__label"},o().createElement(K.Localize,{i18n_default_text:"Custom"})),t&&o().createElement(je.E,{size:"sm",color:"quill-typography__color--subtle"},t),o().createElement(ku.A,{className:"custom-time-filter__icon",fill:"var(--component-textIcon-normal-default)"}))};var Cu=r("../../node_modules/moment/moment.js"),Tu=r.n(Cu);function ju(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Lu(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Lu(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lu(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Pu=function(e){var t=e.applyHandler,r=e.handleDateChange,n=e.onClose,a=e.isOpen,l=e.setCustomTimeRangeFilter,c=ju(o().useState(),2),s=c[0],u=c[1],d=ju(o().useState([]),2),f=d[0],m=d[1];return o().createElement(Le.A.Root,{isOpen:a,onClose:n,position:"left",expandable:!1},o().createElement(Le.A.Portal,{shouldCloseOnDrag:!0},o().createElement(Le.A.Header,{title:o().createElement(K.Localize,{i18n_default_text:"Choose a date range"})}),o().createElement(Le.A.Content,null,o().createElement(Ti.l,{allowPartialRange:!0,className:"date-picker__action-sheet",locale:"en-GB",selectRange:!0,onFormattedDate:function(e){var t=e.trim(),r=t.endsWith("-");u(r?t.substring(0,t.length-1):t)},onChange:m,optionsConfig:Zs.m$,tileDisabled:function(e){var t=e.date;return Date.parse(t.toDateString())>Date.parse((0,i.toMoment)().toString())},maxDate:new Date})),o().createElement(Le.A.Footer,{alignment:"vertical",isPrimaryButtonDisabled:!s,primaryAction:{content:o().createElement(K.Localize,{i18n_default_text:"Apply"}),onAction:function(){l(s),Array.isArray(f)&&f.length&&r({from:(0,i.toMoment)(f[0]),to:f[1]?(0,i.toMoment)(f[1]):Tu()(f[0]).endOf("day")},{shouldFilterContractTypes:!0}),t()}}})))};function Iu(e){return Iu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Iu(e)}function Nu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Du(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Nu(Object(r),!0).forEach((function(t){Mu(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Nu(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Mu(e,t,r){return(t=function(e){var t=function(e){if("object"!=Iu(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Iu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Iu(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zu(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ru(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ru(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ru(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Fu=[{value:"0",label:o().createElement(K.Localize,{i18n_default_text:"All time"})},{value:"Today",label:o().createElement(K.Localize,{i18n_default_text:"Today"})},{value:"Yesterday",label:o().createElement(K.Localize,{i18n_default_text:"Yesterday"})},{value:"7",label:o().createElement(K.Localize,{i18n_default_text:"Last 7 days"})},{value:"30",label:o().createElement(K.Localize,{i18n_default_text:"Last 30 days"})},{value:"60",label:o().createElement(K.Localize,{i18n_default_text:"Last 60 days"})},{value:"90",label:o().createElement(K.Localize,{i18n_default_text:"Last 90 days"})}];const Uu=function(e){var t,r=e.customTimeRangeFilter,n=e.handleDateChange,a=e.setTimeFilter,l=e.setCustomTimeRangeFilter,c=e.setNoMatchesFound,s=e.timeFilter,u=zu(o().useState(!1),2),d=u[0],f=u[1],m=zu(o().useState(!1),2),p=m[0],y=m[1],_=r||s||"0",v=!(!r&&!s),h=function(){a(""),l(""),f(!1),n({to:(0,i.toMoment)().endOf("day"),is_batch:!0},{shouldFilterContractTypes:!0}),c(!1)};return o().createElement(o().Fragment,null,o().createElement(Oa.v.Standard,{className:"filter__chip",dropdown:!0,isDropdownOpen:d,onClick:function(){return f(!d)},selected:v,size:"md"},o().createElement(je.E,{size:"sm"},r||(null===(t=Fu.find((function(e){return e.value===(s||"0")})))||void 0===t?void 0:t.label))),o().createElement(Le.A.Root,{isOpen:d,onClose:function(){return f(!1)},position:"left",expandable:!1},o().createElement(Le.A.Portal,{shouldCloseOnDrag:!0},o().createElement(Le.A.Header,{title:o().createElement(K.Localize,{i18n_default_text:"Filter by time"})}),o().createElement(Le.A.Content,{className:"filter__item__wrapper"},o().createElement(Ou.z,{className:"filter__item--radio",onToggle:function(e){var t,r=e.target.value;if("0"!==r){a(r),f(!1);var o={Today:{from:(0,i.toMoment)().startOf("day"),to:(0,i.toMoment)().endOf("day")},Yesterday:{from:(0,i.toMoment)().subtract(1,"days").startOf("day"),to:(0,i.toMoment)().subtract(1,"days").endOf("day")},default:{from:(0,i.toMoment)().startOf("day").subtract(Number(r),"day").add(1,"s"),to:(0,i.toMoment)().endOf("day")}};n(Du(Du({},null!==(t=o[r])&&void 0!==t?t:o.default),{},{is_batch:!0}),{shouldFilterContractTypes:!0})}else h()},selected:_,size:"sm"},Fu.map((function(e){var t=e.value,r=e.label;return o().createElement(Ou.z.Item,{value:t,label:r,key:t,radioButtonPosition:"right"})}))),o().createElement(xu,{customTimeRangeFilter:r,setShowDatePicker:y})),o().createElement(Le.A.Footer,{alignment:"vertical",secondaryAction:{content:o().createElement(K.Localize,{i18n_default_text:"Reset"}),onAction:h},shouldCloseOnSecondaryButtonClick:!1}))),p&&o().createElement(Pu,{applyHandler:function(){y(!1),f(!1)},handleDateChange:n,isOpen:p,onClose:function(){return y(!1)},setCustomTimeRangeFilter:l}))},qu=function(e){var t=e.currency,r=e.hasBottomAlignment,n=e.is_bold,a=void 0===n||n,l=e.positionsCount,c=void 0===l?"":l,s=e.totalProfitLoss;return o().createElement("div",{className:(0,ke.A)("total-profit-loss",r&&"bottom"),"data-testid":"dt_total_profit_loss"},o().createElement(je.E,{bold:a,size:"sm",className:"total-profit-loss__label"},r?o().createElement(K.Localize,{i18n_default_text:"Last {{positionsCount}} contracts:",values:{positionsCount:c}}):(0,i.getCardLabels)().TOTAL_PROFIT_LOSS),o().createElement(je.E,{className:(0,ke.A)("total-profit-loss__amount",{positive:+s>0,negative:+s<0}),bold:a,size:"sm"},o().createElement(Oe.Money,{amount:s,currency:t,show_currency:!0,has_sign:!0})))};function Vu(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Bu(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Bu(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Bu(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Hu=(0,ye.observer)((function(e){var t,r,n=e.hasButtonsDemo,a=e.isClosedTab,i=e.setHasButtonsDemo,l=function(e){var t=e.isClosedTab,r=(0,ao.q)().positions,n=r.setClosedContractTypeFilter,o=r.setOpenContractTypeFilter,a=r.openContractTypeFilter,i=r.closedContractTypeFilter;return{contractTypeFilter:t?i:a,setContractTypeFilter:t?n:o}}({isClosedTab:a}),c=l.contractTypeFilter,u=l.setContractTypeFilter,d=function(){var e=(0,ao.q)().positions;return{timeFilter:e.timeFilter,setTimeFilter:e.setTimeFilter,customTimeRangeFilter:e.customTimeRangeFilter,setCustomTimeRangeFilter:e.setCustomTimeRangeFilter}}(),f=d.timeFilter,m=d.setTimeFilter,p=d.customTimeRangeFilter,y=d.setCustomTimeRangeFilter,_=Vu(o().useState([]),2),v=_[0],h=_[1],b=Vu(o().useState(!1),2),g=b[0],E=b[1],S=(0,s.A)(),w=S.common,A=S.client,O=S.portfolio,k=(a?{}:w).server_time,x=void 0===k?void 0:k,C=A.currency,T=O.active_positions,j=O.is_active_empty,L=O.is_loading,P=O.onClickCancel,I=O.onClickSell,N=O.onMount,D=function(){var e=o().useContext(de);if(!e)throw new Error("useReportsStore must be used within ReportsStoreProvider");return e}().profit_table,M=D.clearTable,z=D.data,R=D.fetchNextBatch,F=D.handleScroll,U=D.handleDateChange,q=D.is_empty,V=D.is_loading,B=D.onMount,H=D.onUnmount,G=o().useMemo((function(){return z.map((function(e){return{contract_info:e}}))}),[z]),Y=o().useMemo((function(){return a?G:T}),[T,a,G]),W=(a?!f&&!p&&!c.length:!c.length)&&(a?q:j),$=W||g,K=!!v.length&&(a||(null===(t=v[0])||void 0===t||null===(r=t.contract_info)||void 0===r?void 0:r.status)),J=a?V&&!v.length:L,X=!a||!(!f&&!p),Z=a?o().createElement(bu,{currency:C,positions:v,isLoadingMore:V,hasBottomMargin:X}):o().createElement(_u,{currency:C,hasButtonsDemo:n,onClickCancel:a?void 0:P,onClickSell:a?void 0:I,positions:v,setHasButtonsDemo:i,serverTime:x});return o().useEffect((function(){var e=(0,Zs.H9)(Y,c);c.length?(h(e),a||E(!e.length)):(E(!1),h(Y)),a&&E(!e.length&&!!(f||p||c.length))}),[a,Y,c,f,p]),o().useEffect((function(){return a?B(!0):N(),function(){a&&(M(),H())}}),[]),J||!K&&!$?o().createElement(Oe.Loading.DTraderV2,{is_positions:!0,is_closed_tab:a}):o().createElement("div",{className:"positions-page__".concat(a?Zs.Eu.CLOSED.toLowerCase():Zs.Eu.OPEN.toLowerCase()),onScroll:a?function(e){a&&F(e,!0)}:void 0},!W&&o().createElement("div",{className:"positions-page__filter__wrapper"},a?o().createElement(Uu,{timeFilter:f,setTimeFilter:m,handleDateChange:U,customTimeRangeFilter:p,setCustomTimeRangeFilter:y,setNoMatchesFound:E}):o().createElement(Au,{contractTypeFilter:c,onApplyContractTypeFilter:function(e){u(e),a&&(M(),R(!0))}})),$?o().createElement(tu,{isClosedTab:a,noMatchesFound:g}):K&&o().createElement(o().Fragment,null,X&&o().createElement(qu,{positionsCount:v.length,currency:C,hasBottomAlignment:a,totalProfitLoss:(0,Zs.jw)(v)}),Z))}));const Gu=Hu;function Yu(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Wu(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Wu(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wu(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const $u=(0,ye.observer)((function(){var e=Yu(o().useState(!1),2),t=e[0],r=e[1],n=Yu(o().useState((0,i.getPositionsV2TabIndexFromURL)()),2),a=n[0],l=n[1],c=Yu(Te("guide_dtrader_v2",{trade_types_selection:!1,trade_page:!1,positions_page:!1}),1)[0],u=(0,be.useHistory)(),d=(0,s.A)(),f=d.client.is_logged_in,m=d.ui.is_dark_mode_on,p=(0,ao.q)().positions.onUnmount,y=[{id:Zs.Eu.OPEN.toLowerCase(),title:o().createElement(K.Localize,{i18n_default_text:"Open"}),content:o().createElement(Gu,{hasButtonsDemo:t,setHasButtonsDemo:r})},{id:Zs.Eu.CLOSED.toLowerCase(),title:o().createElement(K.Localize,{i18n_default_text:"Closed"}),content:o().createElement(Gu,{isClosedTab:!0})}];return o().useEffect((function(){return(0,Zs.RN)(y[a].id),null!=c&&c.positions_page&&r(!0),function(){u.location.pathname.startsWith("/contract/")||p()}}),[]),o().createElement(pt,null,o().createElement("div",{className:"positions-page"},o().createElement(or.o.Container,{contentStyle:"fill",className:"positions-page__tabs",size:"md",selectedTabIndex:a,onChangeTab:function(e){l(e),(0,Zs.RN)(y[e].id)}},o().createElement(or.o.List,null,y.map((function(e){var t=e.id,r=e.title;return o().createElement(or.o.Trigger,{key:t},r)}))),o().createElement(or.o.Content,{className:"positions-page__tabs-content"},y.map((function(e){var t=e.id,r=e.content;return o().createElement(or.o.Panel,{key:t},r)}))))),!(null!=c&&c.positions_page)&&f&&o().createElement(Xo,{type:"positions_page",is_dark_mode_on:m,callback:function(){return r(!0)}}))})),Ku=function(e){var t=e.label,r=e.value,n=e.date,a=e.time;return o().createElement("div",{className:"entry-exit-details__table-row"},o().createElement("div",{className:"entry-exit-details__table-cell"},o().createElement(je.E,{size:"sm",color:"quill-typography__color--subtle"},t)),o().createElement("div",{className:"entry-exit-details__table-cell"},o().createElement(je.E,{size:"sm"},r),o().createElement(je.E,{size:"sm",color:"quill-typography__color--subtle"},n),o().createElement(It.O,{color:"quill-typography__color--subtle"},a)))},Ju=function(e){var t=e.title,r=e.children,n=e.className;return o().createElement("div",{className:(0,ke.A)("card-wrapper",n)},t&&o().createElement(je.E,{size:"sm",bold:!0,className:"title"},t),r)};function Xu(){return Xu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Xu.apply(null,arguments)}var Zu=function(e){if(e){var t=new Date(1e3*e),r=Tu()(t);return{date:(0,i.formatDate)(r,"DD MMM YYYY"),time:(0,i.formatTime)(e,"HH:mm:ss [GMT]")}}};const Qu=function(e){var t=e.contract_info,r=t.entry_tick_time,a=t.entry_spot_display_value,l=t.exit_tick_time,c=t.date_start,s=t.exit_tick_display_value,u=(0,n.useMemo)((function(){var e;return{entry:r?Zu(r):void 0,exit:l?Zu(l):void 0,start:c?Zu(c):void 0,end:(0,i.getEndTime)(t)?Zu(null!==(e=(0,i.getEndTime)(t))&&void 0!==e?e:0):void 0}}),[t]),d=a?(0,i.addComma)(a):null,f=s?(0,i.addComma)(s):null;return o().createElement(Ju,{title:o().createElement(K.Localize,{i18n_default_text:"Entry & exit details"}),className:"entry-exit-details"},o().createElement("div",{className:"entry-exit-details__table"},u.start&&o().createElement(Ku,{label:o().createElement(K.Localize,{i18n_default_text:"Start time"}),value:u.start.date,time:u.start.time}),u.entry&&d&&o().createElement(Ku,Xu({label:o().createElement(K.Localize,{i18n_default_text:"Entry spot"}),value:d},u.entry)),u.end&&o().createElement(Ku,{label:o().createElement(K.Localize,{i18n_default_text:"Exit time"}),value:u.end.date,time:u.end.time}),u.exit&&f&&o().createElement(Ku,Xu({label:o().createElement(K.Localize,{i18n_default_text:"Exit spot"}),value:f},u.exit))))};var ed=r("../../node_modules/@deriv-com/quill-ui/dist/components/Pagination/index.js");function td(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const rd=function(e){var t=e.history,r=void 0===t?[]:t,a=e.currency,l=e.is_multiplier,c=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return td(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?td(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,n.useState)(0),2),s=c[0],u=c[1],d=Math.ceil(r.length/4),f=o().useCallback((function(e){u(e.currentPage-1)}),[]);if(!r.length)return null;var m=r.reduce((function(e,t,n){return n%4||e.push(r.slice(n,n+4)),e}),[]).map((function(e,t){return{id:t,component:o().createElement(o().Fragment,null,e.map((function(e,t){return o().createElement("div",{key:"take-profit-history-".concat(t),className:"take-profit-history__table-row"},o().createElement("div",{className:at()("take-profit-history__table-cell","take-profit-history__table-cell--left")},o().createElement(It.O,{color:"quill-typography__color--subtle",size:"sm"},(0,i.formatDate)(e.order_date,"DD MMM YYYY")),o().createElement(It.O,{color:"quill-typography__color--subtle"},(0,i.formatTime)(Number(e.order_date)))),o().createElement("div",{className:"take-profit-history__table-cell"},o().createElement(je.E,{size:"sm",color:"quill-typography__color--subtle"},e.display_name),o().createElement(je.E,{size:"sm"},0===Math.abs(Number(e.order_amount))?(0,K.localize)("Cancelled"):"".concat((0,i.formatMoney)(String(a),String(e.order_amount),!0)," ").concat(a))))})))}}));return o().createElement(Ju,{title:l?o().createElement(K.Localize,{i18n_default_text:"TP & SL History"}):o().createElement(K.Localize,{i18n_default_text:"TP History"}),className:"take-profit-history"},o().createElement("div",{className:at()("take-profit-history__table",{"take-profit-history__table--fixed-height":r.length>4})},o().createElement(ii,{classname:"take-profit-history__carousel",current_index:s,is_swipeable:!0,pages:m,setCurrentIndex:u})),d>1&&o().createElement(ed.d,{initialPage:s+1,contentLength:r.length,contentPerPage:4,hideChevron:!0,onClickPagination:f,variant:"bullet"}))},nd=function(e){var t=e.contract_info;return o().createElement(Ju,{title:o().createElement(K.Localize,{i18n_default_text:"How do I earn a payout?"})},o().createElement(je.E,{size:"sm"},t.longcode))},od=function(){var e=(0,s.A)(),t=e.contract_replay,r=e.contract_trade.getContractById,o=t.contract_store,a=t.onMount,i=t.onUnmount,l=o.contract_info,c=r(l.contract_id),u=(0,ft.useLocation)();return(0,n.useEffect)((function(){var e=u.pathname.split("/").pop();e!=l.contract_id&&a(parseInt(e))}),[u.pathname,a,i,l.contract_id]),{contract_info:l,contract:c,is_loading:!l.contract_id}};var ad=r("./src/Modules/Contract/Containers/replay-chart.tsx");const id=(0,ye.observer)((function(){var e=od().contract_info,t=(0,i.isResetContract)(e.contract_type),r=(0,i.isAccumulatorContract)(e.contract_type);return o().createElement("div",{className:"contract-details-chart"},o().createElement(ad.A,{is_accumulator_contract:r,is_reset_contract:t,is_vertical_scroll_disabled:!0}))}));var ld,cd=r("./src/App/Components/Elements/PositionsDrawer/helpers/index.ts"),sd=r("./src/Stores/Modules/Trading/Helpers/logic.ts");function ud(e){return ud="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ud(e)}function dd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function fd(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?dd(Object(r),!0).forEach((function(t){md(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dd(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function md(e,t,r){return(t=function(e){var t=function(e){if("object"!=ud(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=ud(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ud(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var pd=function(e,t){var r,n,o,a,l,c=e.tick_count,s=e.tick_passed,u=e.contract_type,d=Number(c)<2?t.TICK:t.TICKS,f=(0,i.isAccumulatorContract)(u)?"".concat(s," ").concat(t.TICKS):"".concat(c," ").concat(d);return md(md(md(md(md({},t.REFERENCE_ID,[null!==(r=e.transaction_ids)&&void 0!==r&&r.buy?"".concat(e.transaction_ids.buy," (").concat(t.BUY,")"):"",null!==(n=e.transaction_ids)&&void 0!==n&&n.sell?"".concat(e.transaction_ids.sell," (").concat(t.SELL,")"):""]),t.STAKE,e.buy_price&&e.currency?"".concat((0,i.formatMoney)(e.currency,e.buy_price,!0)," ").concat(e.currency):""),t.DURATION,Number(c)>0?f:"".concat(null!==(o=(0,i.getDurationTime)(e))&&void 0!==o?o:""," ").concat(null!==(a=(0,i.getDurationUnitText)((0,i.getDurationPeriod)(e)))&&void 0!==a?a:"")),t.PAYOUT_PER_POINT,null!==(l=e.display_number_of_contracts)&&void 0!==l?l:""),t.POTENTIAL_PAYOUT,e.payout)},yd=function(e,t){var r,n,o,a,l,c,s=pd(e,t),u=function(e,t){var r,n;if(null!==(r=e.cancellation)&&void 0!==r&&r.ask_price&&e.currency)return n=(0,i.isUserCancelled)(e)?t.EXECUTED:(0,sd.d)(e)?t.EXPIRED:t.ACTIVE,["".concat((0,i.formatMoney)(e.currency,e.cancellation.ask_price,!0)," ").concat(e.currency),"(".concat(n,")")]}(e,t);return fd(fd(md(md(md(md({},t.REFERENCE_ID,s[t.REFERENCE_ID]),t.MULTIPLIER,e.multiplier?"x".concat(e.multiplier):""),t.STAKE,s[t.STAKE]),t.COMMISSION,e.commission?"".concat((0,i.formatMoney)(e.currency,e.commission,!0)," ").concat(e.currency):""),u&&md({},t.DEAL_CANCEL_FEE,u)),{},md(md(md({},t.TAKE_PROFIT,null!==(r=e.limit_order)&&void 0!==r&&null!==(n=r.take_profit)&&void 0!==n&&n.order_amount&&e.currency?"".concat((0,i.formatMoney)(e.currency,e.limit_order.take_profit.order_amount,!0)," ").concat(e.currency):t.NOT_SET),t.STOP_LOSS,null!==(o=e.limit_order)&&void 0!==o&&null!==(a=o.stop_loss)&&void 0!==a&&a.order_amount&&e.currency?"".concat((0,i.formatMoney)(e.currency,e.limit_order.stop_loss.order_amount,!0)," ").concat(e.currency):t.NOT_SET),t.STOP_OUT_LEVEL,null!==(l=e.limit_order)&&void 0!==l&&null!==(c=l.stop_out)&&void 0!==c&&c.order_amount&&e.currency?"".concat((0,i.formatMoney)(e.currency,e.limit_order.stop_out.order_amount,!0)," ").concat(e.currency):""))},_d=function(e,t){var r,n=e.barrier,o=e.purchase_time,a=e.shortcode,l=(0,i.isForwardStarting)(null!=a?a:"",o),c=(0,i.getStartTime)(null!=a?a:""),s=(0,i.hasForwardContractStarted)(null!=a?a:""),u=l&&!!c&&!s,d=pd(e,t);return md(md(md(md(md({},t.REFERENCE_ID,d[t.REFERENCE_ID]),t.DURATION,d[t.DURATION]),t.BARRIER,null!==(r=u?"TBD":n)&&void 0!==r?r:""),t.STAKE,d[t.STAKE]),t.POTENTIAL_PAYOUT,d[t.POTENTIAL_PAYOUT])},vd=function(e,t){var r,n,o,a=pd(e,t);return md(md(md(md(md(md({},t.REFERENCE_ID,a[t.REFERENCE_ID]),t.DURATION,a[t.DURATION]),t.BARRIER,null!==(r=e.barrier)&&void 0!==r?r:""),t.PAYOUT_PER_POINT,"".concat(a[t.PAYOUT_PER_POINT]," ").concat(e.currency)),t.STAKE,a[t.STAKE]),t.TAKE_PROFIT,null!==(n=e.limit_order)&&void 0!==n&&null!==(o=n.take_profit)&&void 0!==o&&o.order_amount&&e.currency?"".concat((0,i.formatMoney)(e.currency,e.limit_order.take_profit.order_amount,!0)," ").concat(e.currency):t.NOT_SET)},hd=function(e,t){var r,n=pd(e,t),o=null!==(r=(0,i.getDurationTime)(e))&&void 0!==r?r:"";return md(md(md(md(md({},t.REFERENCE_ID,n[t.REFERENCE_ID]),t.DURATION,"".concat(o," ").concat(+o>1?(0,i.getUnitMap)().t.name_plural:(0,i.getUnitMap)().t.name_singular)),t.TARGET,(0,cd.Vb)(e)),t.STAKE,n[t.STAKE]),t.POTENTIAL_PAYOUT,n[t.POTENTIAL_PAYOUT])},bd=function(e,t){var r,n,o=pd(e,t);return md(md(md(md(md({},t.REFERENCE_ID,o["".concat(t.REFERENCE_ID)]),t.DURATION,"".concat(null!==(r=(0,i.getDurationTime)(e))&&void 0!==r?r:""," ").concat(null!==(n=(0,i.getDurationUnitText)((0,i.getDurationPeriod)(e)))&&void 0!==n?n:"")),t.STRIKE_PRICE,((0,i.isResetContract)(e.contract_type)?(0,i.addComma)(e.entry_spot_display_value):(0,cd.Vb)(e))||" - "),t.PAYOUT_PER_POINT,"".concat(o[t.PAYOUT_PER_POINT]," ").concat(e.currency)),t.STAKE,o[t.STAKE])},gd=function(e,t){var r,n,o=pd(e,t);return md(md(md(md(md(md({},t.REFERENCE_ID,o["".concat(t.REFERENCE_ID)]),t.DURATION,"".concat(null!==(r=(0,i.getDurationTime)(e))&&void 0!==r?r:""," ").concat(null!==(n=(0,i.getDurationUnitText)((0,i.getDurationPeriod)(e)))&&void 0!==n?n:"")),t.HIGH_BARRIER,e.high_barrier),t.LOW_BARRIER,e.low_barrier),t.STAKE,o[t.STAKE]),t.POTENTIAL_PAYOUT,e.payout&&e.currency?"".concat((0,i.formatMoney)(e.currency,e.payout,!0)," ").concat(e.currency):"")},Ed=function(e,t){var r,n=pd(e,t);return md(md(md(md(md({},t.REFERENCE_ID,n[t.REFERENCE_ID]),t.DURATION,n[t.DURATION]),t.BARRIER,null!==(r=e.barrier)&&void 0!==r?r:""),t.STAKE,n[t.STAKE]),t.POTENTIAL_PAYOUT,e.payout&&e.currency?"".concat((0,i.formatMoney)(e.currency,e.payout,!0)," ").concat(e.currency):"")},Sd=function(e,t){var r,n,o,a,l=pd(e,t),c=e.contract_type==i.CONTRACT_TYPES.LB_CALL;return a=null!==(r=e.transaction_ids)&&void 0!==r&&r.sell?c?t.LOW_SPOT:t.HIGH_SPOT:c?t.INDICATIVE_LOW_SPOT:t.INDICATIVE_HIGH_SPOT,md(md(md(md(md({},t.REFERENCE_ID,l[t.REFERENCE_ID]),t.DURATION,l[t.DURATION]),t.MULTIPLIER,null!==(n=e.multiplier)&&void 0!==n?n:""),a,null!==(o=e.barrier)&&void 0!==o?o:""),t.STAKE,l[t.STAKE])},wd=function(e,t){var r,n,a,l,c=pd(e,t);return fd(fd(fd(md(md(md({},t.REFERENCE_ID,c[t.REFERENCE_ID]),t.DURATION,[c[t.DURATION],{caption:o().createElement(K.Localize,{key:"reset_time",i18n_default_text:"The reset time is {{ reset_time }}",values:{reset_time:void 0!==e.tick_count?"".concat(Math.floor(Number(e.tick_count)/2)," ").concat(Number(e.tick_count)<2?t.TICK:t.TICKS):(0,i.formatResetDuration)(e)}})}]),t.BARRIER,null!==(r=e.barrier)&&void 0!==r?r:""),e.reset_barrier?md({},t.RESET_BARRIER,e.reset_barrier):{}),e.reset_time?md({},t.RESET_TIME,null!==(a=e.reset_time,l=new Date(1e3*a),n=["".concat(l.getUTCDate().toString().padStart(2,"0")," ").concat(l.toLocaleString("en-GB",{month:"short",timeZone:"UTC"})," ").concat(l.getUTCFullYear()),"".concat(l.getUTCHours().toString().padStart(2,"0"),":").concat(l.getUTCMinutes().toString().padStart(2,"0"),":").concat(l.getUTCSeconds().toString().padStart(2,"0")," GMT")])&&void 0!==n?n:""):{}),{},md(md({},t.STAKE,c[t.STAKE]),t.POTENTIAL_PAYOUT,e.payout&&e.currency?"".concat((0,i.formatMoney)(e.currency,e.payout,!0)," ").concat(e.currency):""))},Ad=function(e,t){var r=pd(e,t);return md(md(md(md({},t.REFERENCE_ID,r[t.REFERENCE_ID]),t.DURATION,r[t.DURATION]),t.STAKE,r[t.STAKE]),t.POTENTIAL_PAYOUT,e.payout&&e.currency?"".concat((0,i.formatMoney)(e.currency,e.payout,!0)," ").concat(e.currency):"")},Od=function(e,t){var r,n,o=pd(e,t);return md(md(md(md(md({},t.REFERENCE_ID,o[t.REFERENCE_ID]),t.DURATION,o[t.DURATION]),t.SELECTED_TICK,[null!==(r=e.selected_tick)&&void 0!==r?r:"",{caption:null!==(n=e.barrier)&&void 0!==n?n:""}]),t.STAKE,o[t.STAKE]),t.POTENTIAL_PAYOUT,e.payout&&e.currency?"".concat((0,i.formatMoney)(e.currency,e.payout,!0)," ").concat(e.currency):"")},kd=(md(md(md(md(md(md(md(md(md(md(ld={},i.CONTRACT_TYPES.TURBOS.LONG,vd),i.CONTRACT_TYPES.TURBOS.SHORT,vd),i.CONTRACT_TYPES.MULTIPLIER.DOWN,yd),i.CONTRACT_TYPES.MULTIPLIER.UP,yd),i.CONTRACT_TYPES.MATCH_DIFF.MATCH,hd),i.CONTRACT_TYPES.MATCH_DIFF.DIFF,hd),i.CONTRACT_TYPES.EVEN_ODD.EVEN,hd),i.CONTRACT_TYPES.EVEN_ODD.ODD,hd),i.CONTRACT_TYPES.OVER_UNDER.OVER,hd),i.CONTRACT_TYPES.OVER_UNDER.UNDER,hd),md(md(md(md(md(md(md(md(md(md(ld,i.CONTRACT_TYPES.PUT,_d),i.CONTRACT_TYPES.PUTE,_d),i.CONTRACT_TYPES.CALLE,_d),i.CONTRACT_TYPES.CALL,_d),i.CONTRACT_TYPES.TOUCH.ONE_TOUCH,_d),i.CONTRACT_TYPES.TOUCH.NO_TOUCH,_d),i.CONTRACT_TYPES.ACCUMULATOR,(function(e,t){var r,n,o,a=pd(e,t);return fd(fd(md({},t.REFERENCE_ID,a[t.REFERENCE_ID]),fd({},(e.is_expired||e.is_sold)&&md({},t.DURATION,a[t.DURATION]))),{},md(md({},t.GROWTH_RATE,e.growth_rate?"".concat((0,i.getGrowthRatePercentage)(e.growth_rate),"%"):""),t.STAKE,a[t.STAKE]),fd({},(null===(r=e.limit_order)||void 0===r?void 0:r.take_profit)&&md({},t.TAKE_PROFIT,null!==(n=e.limit_order)&&void 0!==n&&null!==(o=n.take_profit)&&void 0!==o&&o.order_amount&&e.currency?"".concat((0,i.formatMoney)(e.currency,e.limit_order.take_profit.order_amount,!0)," ").concat(e.currency):t.NOT_SET)))})),i.CONTRACT_TYPES.VANILLA.CALL,bd),i.CONTRACT_TYPES.VANILLA.PUT,bd),i.CONTRACT_TYPES.END.IN,gd),md(md(md(md(md(md(md(md(md(md(ld,i.CONTRACT_TYPES.END.OUT,gd),i.CONTRACT_TYPES.STAY.IN,gd),i.CONTRACT_TYPES.STAY.OUT,gd),i.CONTRACT_TYPES.ASIAN.UP,Ed),i.CONTRACT_TYPES.ASIAN.DOWN,Ed),i.CONTRACT_TYPES.LB_HIGH_LOW,(function(e,t){var r,n,o,a,i,l=pd(e,t);return fd(fd(md(md(md({},t.REFERENCE_ID,l[t.REFERENCE_ID]),t.DURATION,l[t.DURATION]),t.MULTIPLIER,null!==(r=e.multiplier)&&void 0!==r?r:""),md(md({},null!==(n=e.transaction_ids)&&void 0!==n&&n.sell?t.HIGH_SPOT:t.INDICATIVE_HIGH_SPOT,null!==(o=e.high_barrier)&&void 0!==o?o:""),null!==(a=e.transaction_ids)&&void 0!==a&&a.sell?t.LOW_SPOT:t.INDICATIVE_LOW_SPOT,null!==(i=e.low_barrier)&&void 0!==i?i:"")),{},md({},t.STAKE,l[t.STAKE]))})),i.CONTRACT_TYPES.LB_CALL,Sd),i.CONTRACT_TYPES.LB_PUT,Sd),i.CONTRACT_TYPES.RESET.CALL,wd),i.CONTRACT_TYPES.RESET.PUT,wd),md(md(md(md(md(ld,i.CONTRACT_TYPES.TICK_HIGH_LOW.HIGH,Od),i.CONTRACT_TYPES.TICK_HIGH_LOW.LOW,Od),i.CONTRACT_TYPES.FALL,gd),i.CONTRACT_TYPES.RUN_HIGH_LOW.HIGH,Ad),i.CONTRACT_TYPES.RUN_HIGH_LOW.LOW,Ad));function xd(e){return xd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xd(e)}function Cd(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Td=function(e){var t=function(e){var t=e;if(t.contract_type){var r=kd[t.contract_type];return{details:r?r(t,(0,i.getCardLabelsV2)()):{}}}}(e.contract_info),r=t?t.details:{};return o().createElement(Ju,{title:o().createElement(K.Localize,{i18n_default_text:"Order Details"})},o().createElement("div",{className:"order-details"},o().createElement("div",{className:"order-details__table"},Object.entries(r).map((function(e){var t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Cd(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Cd(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e,2),r=t[0],n=t[1];return o().createElement("div",{className:"order-details__table-row",key:r},o().createElement("div",{className:"order-details__table-row-cell"},o().createElement(je.E,{size:"sm",color:"quill-typography__color--subtle"},r)),o().createElement("div",{className:"order-details__table-row-cell"},Array.isArray(n)?n.map((function(e,t){var n;return["number","string"].includes(xd(e))?o().createElement(je.E,{key:"".concat(r,"_").concat(t),size:"sm"},e):o().createElement(It.O,{key:"".concat(r,"_").concat(t),size:"sm",color:"quill-typography__color--subtle"},null!==(n=null==e?void 0:e.caption)&&void 0!==n?n:"")})):o().createElement(je.E,{size:"sm"},n)))})))))};function jd(e){return jd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jd(e)}function Ld(e,t,r){return(t=function(e){var t=function(e){if("object"!=jd(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=jd(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==jd(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Pd={isTakeProfitVisible:!1,isDealCancellationVisible:!1,isStopLossVisible:!1,isTpHistoryVisible:!1},Id=function(e){return Ld(Ld(Ld(Ld(Ld({},i.CONTRACT_TYPES.ACCUMULATOR,{isTakeProfitVisible:!0,isDealCancellationVisible:!1,isStopLossVisible:!1,isTpHistoryVisible:!0}),i.CONTRACT_TYPES.MULTIPLIER.UP,{isTakeProfitVisible:!0,isDealCancellationVisible:!0,isStopLossVisible:!0,isTpHistoryVisible:!0}),i.CONTRACT_TYPES.MULTIPLIER.DOWN,{isTakeProfitVisible:!0,isDealCancellationVisible:!0,isStopLossVisible:!0,isTpHistoryVisible:!0}),i.CONTRACT_TYPES.TURBOS.LONG,{isTakeProfitVisible:!0,isDealCancellationVisible:!1,isStopLossVisible:!1,isTpHistoryVisible:!0}),i.CONTRACT_TYPES.TURBOS.SHORT,{isTakeProfitVisible:!0,isDealCancellationVisible:!1,isStopLossVisible:!1,isTpHistoryVisible:!0})[e]||Pd},Nd=r("../../node_modules/@deriv/quill-icons/dist/esm/react/LabelPaired/LabelPairedCircleInfoSmRegularIcon.js");function Dd(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Md=function(e){var t=e.header_content,r=e.body_content,n=e.info_message,a=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Dd(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Dd(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o().useState(!1),2),i=a[0],l=a[1];return o().createElement(o().Fragment,null,o().createElement("button",{onClick:function(){return l(!i)}},o().createElement(Nd.A,{fill:"var(--component-textIcon-normal-default)"})),o().createElement(Le.M,{isNonExpandable:!0,shouldCloseModalOnSwipeDown:!0,isOpened:i,toggleModal:l,primaryButtonLabel:o().createElement(K.Localize,{i18n_default_text:"Got it"}),shouldCloseOnPrimaryButtonClick:!0,isMobile:!0,showHandleBar:!0},o().createElement(Le.M.Header,{title:t}),o().createElement(Le.M.Body,null,o().createElement("div",{className:"risk-management-info-modal__container"},o().createElement(je.E,{size:"md"},r),n&&o().createElement(fc.H,{message:n,size:"sm",status:"info"})))))},zd=(0,ye.observer)((function(e){var t=e.format,r=void 0===t?"mm:ss":t,n=(0,s.A)().common.server_time,a=(od().contract_info.cancellation||{}).date_expiry;return!a||n.unix()>+a?null:o().createElement(vr.v,{className:"deal-cancellation-badge","data-testid":"dt_deal_cancellation_badge",icon:o().createElement(ru.A,{key:"open-contract-card",fill:"var(--component-tag-label-color-default)"}),label:o().createElement(Oe.RemainingTime,{end_time:a,format:r,getCardLabels:i.getCardLabelsV2,start_time:n}),size:"sm",variant:"custom"})}));function Rd(e){return Rd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rd(e)}function Fd(e,t,r){return(t=function(e){var t=function(e){if("object"!=Rd(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Rd(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Rd(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ud(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return qd(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?qd(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qd(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Vd=(0,ye.observer)((function(e){var t,r,n,a,l,c,s=e.label,u=e.modal_body_content,d=e.is_deal_cancellation,f=void 0!==d&&d,m=e.value,p=e.type,y=Ud(o().useState(Boolean(m)),2),_=y[0],v=y[1],h=Ud(o().useState(!1),2),b=h[0],g=h[1],E=Ud(o().useState(!1),2),S=E[0],w=E[1],A=Ud(o().useState(),2),O=A[0],k=A[1],x=Ud(o().useState(!1),2),C=x[0],T=x[1],j=od(),L=j.contract_info,P=j.contract,I=L.contract_type,N=L.currency,D=L.validation_params,M=P.validation_errors,z=P.updateLimitOrder,R=P.clearContractUpdateConfigValues,F=(0,i.isValidToCancel)(L),U=(0,i.isAccumulatorContract)(I),q=(0,Zs.Dd)(L);o().useEffect((function(){return m&&(k(m),v(Boolean(m))),function(){return R()}}),[R,m]);var V=F,B=Math.abs(m),H="contract_update_".concat(p),G=null!==(t=null===(r=M[H])||void 0===r?void 0:r[0])&&void 0!==t?t:"",Y=F?o().createElement(K.Localize,{i18n_default_text:"Take profit and/or stop loss are not available while deal cancellation is active."}):null,W=Fd(Fd(Fd({},i.CONTRACT_TYPES.ACCUMULATOR,o().createElement(K.Localize,{i18n_default_text:"Take profit can’t be adjusted for ongoing accumulator contracts."})),i.CONTRACT_TYPES.MULTIPLIER.UP,Y),i.CONTRACT_TYPES.MULTIPLIER.DOWN,Y),$=p&&(null!==(n=null==D||null===(a=D[p])||void 0===a?void 0:a.min)&&void 0!==n?n:0),J=p&&(null!==(l=null==D||null===(c=D[p])||void 0===c?void 0:c.max)&&void 0!==l?l:0),X=function(){var e="take_profit"===p?(0,K.localize)("take profit"):(0,K.localize)("stop loss");return O?$&&+O<+$?(0,K.localize)("Please enter a {{field_label}} amount that's at least {{min_value}}.",{field_label:e,min_value:$}):J&&+O>+J?(0,K.localize)("Maximum {{field_label}} allowed is {{max_value}}.",{field_label:e,max_value:J}):G:(0,K.localize)("Please enter a {{field_label}} amount.",{field_label:e})},Z=C?X():"";return o().createElement("div",{className:"risk-management-item__container"},o().createElement("div",{className:"risk-management-item"},o().createElement("span",{className:"risk-management-item__title"},o().createElement(je.E,{size:"sm"},s),o().createElement(Md,{header_content:s,body_content:u,info_message:W[I]||""})),!f&&(U&&N?o().createElement(je.E,{size:"sm"},(0,i.formatMoney)(N,B,!0)," ",N):o().createElement(Qa.j,{disabled:V,checked:_,onChange:function(e){var t;R(),e?(g(!0),k(""),w(!0),T(!1)):(null===(t=P.onChange)||void 0===t||t.call(P,{name:"has_contract_update_".concat(p),value:e}),z(),v(!_))}})),F&&f&&o().createElement(zd,null)),!U&&_&&N&&o().createElement(ni.A,{variant:"fill",inputSize:"md",disabled:b,textAlignment:"center",value:"".concat((0,i.formatMoney)(N,"stop_loss"==p?-B:B,!0)," ").concat(N),onClick:function(){R(),k(B),g(!0),T(!1)},onFocus:function(){return g(!0)}}),o().createElement(Le.A.Root,{expandable:!1,isOpen:b,position:"left",onClose:function(){w(!1),g(!1),T(!1)}},o().createElement(Le.A.Portal,{shouldCloseOnDrag:!0},o().createElement(Le.A.Header,{title:s}),o().createElement(Le.A.Content,{className:"risk-management-item__action-sheet-content"},b&&o().createElement(Le.T,{allowDecimals:!0,allowSign:!1,className:"text-field--custom",customType:"commaRemoval",decimals:(0,i.getDecimalPlaces)(N),message:Z,minusDisabled:Number(O)-1<=0,name:p,noStatusIcon:!0,onChange:function(e){var t,r=e.target.value;k(r),T(!0),null===(t=P.onChange)||void 0===t||t.call(P,{name:"contract_update_".concat(p),value:r})},placeholder:(0,K.localize)("Amount"),regex:/[^0-9.,]/g,status:Z?"error":"neutral",textAlignment:"center",inputMode:"decimal",unitLeft:(0,i.getCurrencyDisplayCode)(N),value:O,variant:"fill"}),!!q&&o().createElement(qu,{currency:(0,i.getCurrencyDisplayCode)(N),is_bold:!1,totalProfitLoss:q})),o().createElement(Le.A.Footer,{shouldCloseOnPrimaryButtonClick:!1,primaryAction:{content:o().createElement(K.Localize,{i18n_default_text:"Save"}),onAction:function(){T(!0);var e,t,r=X();r?null===(e=P.onChange)||void 0===e||e.call(P,{name:H,value:r}):(S&&(null===(t=P.onChange)||void 0===t||t.call(P,{name:"has_contract_update_".concat(p),value:!0}),w(!1)),z(),g(!1))}}}))))}));const Bd=Vd,Hd=(0,ye.observer)((function(){var e,t,r=od().contract_info,n=r.limit_order;return Id(null!==(e=r.contract_type)&&void 0!==e?e:"").isTakeProfitVisible?o().createElement(Bd,{label:o().createElement(K.Localize,{i18n_default_text:"Take profit"}),modal_body_content:o().createElement(K.Localize,{i18n_default_text:"When your profit reaches or exceeds the set amount, your trade will be closed automatically."}),value:null==n||null===(t=n.take_profit)||void 0===t?void 0:t.order_amount,type:"take_profit"}):null})),Gd=(0,ye.observer)((function(){var e,t,r=od().contract_info,n=r.limit_order;return Id(null!==(e=r.contract_type)&&void 0!==e?e:"").isStopLossVisible?o().createElement(Bd,{label:o().createElement(K.Localize,{i18n_default_text:"Stop loss"}),modal_body_content:o().createElement(K.Localize,{i18n_default_text:"When your loss reaches or exceeds the set amount, your trade will be closed automatically."}),value:null==n||null===(t=n.stop_loss)||void 0===t?void 0:t.order_amount,type:"stop_loss"}):null})),Yd=(0,ye.observer)((function(){var e,t=od().contract_info,r=Id(null!==(e=t.contract_type)&&void 0!==e?e:"").isDealCancellationVisible;return(0,i.isValidToCancel)(t)&&r&&(0,i.isOpen)(t)?o().createElement(Ju,null,o().createElement(Bd,{label:o().createElement(K.Localize,{i18n_default_text:"Deal cancellation"}),modal_body_content:o().createElement(K.Localize,{i18n_default_text:"When this is active, you can cancel your trade within the chosen time frame. Your stake will be returned without loss."}),is_deal_cancellation:!0})):null}));var Wd=r("../../node_modules/@deriv-com/utils/dist/deriv-utils.js");function $d(){return $d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$d.apply(null,arguments)}var Kd=(0,ye.observer)((function(e){var t=e.contract_info,r=t.bid_price,n=t.currency,a=t.contract_id,l=t.cancellation,c=(void 0===l?{}:l).date_expiry,u=t.profit,d=t.contract_type,f=(0,s.A)(),m=f.contract_replay,p=f.common.server_time,y=m.onClickCancel,_=m.onClickSell,v=m.is_sell_requested,h=(0,i.isValidToSell)(t),b=(0,i.isValidToCancel)(t),g=(0,i.isMultiplierContract)(d),E=(0,i.getCardLabelsV2)(),S=Wd.DW.formatMoney(r||0,{currency:n}),w=Number(u)<0&&b,A=w?"":"".concat(S," ").concat(n),O="".concat(E.CLOSE," ").concat(A),k={color:"black-white",size:"lg",fullWidth:!0};return o().createElement("div",{className:"contract-details-footer--container"},g?o().createElement(o().Fragment,null,o().createElement("span",{className:"contract-details-footer-button__wrapper"},o().createElement(ir.$n,$d({label:O,isLoading:v,disabled:w,onClick:function(){return _(a)}},k))),b&&o().createElement("span",{className:"contract-details-footer-button__wrapper"},o().createElement(ir.$n,$d({onClick:function(){return y(a)},label:o().createElement(o().Fragment,null,E.CANCEL," ",o().createElement(Oe.RemainingTime,{as:"span",end_time:c,format:"mm:ss",getCardLabels:i.getCardLabelsV2,start_time:p})),disabled:Number(u)>=0,variant:"secondary"},k)))):o().createElement("span",{className:"contract-details-footer-button__wrapper"},o().createElement(ir.$n,$d({label:h?"".concat(E.CLOSE," ").concat(S," ").concat(n):E.RESALE_NOT_OFFERED,isLoading:v&&h,isOpaque:!0,onClick:h?function(){return _(a)}:void 0,disabled:!h,variant:"primary"},k))))}));const Jd=Kd,Xd=function(e){var t=e.class_name,r=e.contract_info,n=e.server_time,a=r.purchase_time,l=r.sell_time,c=r.shortcode,s=!!l||(0,i.isEnded)(r),u=(0,i.isForwardStarting)(null!=c?c:"",a),d=(0,i.getStartTime)(null!=c?c:""),f=(0,i.hasForwardContractStarted)(null!=c?c:"");return u&&d&&!f&&!s?o().createElement("div",{className:(0,ke.A)("banner__wrapper",t)},o().createElement("div",{className:"banner__content--left"},o().createElement(It.O,{size:"sm",className:"banner__text"},o().createElement(K.Localize,{i18n_default_text:"This contract starts on"})),o().createElement(It.O,{bold:!0,size:"sm",className:"banner__text"},(0,i.formatDate)((0,i.toMoment)(parseInt(d||"")),"DD MMM YYYY"),", ",(0,i.formatTime)(parseInt(d||""),"HH:mm [GMT]"))),o().createElement(je.E,{bold:!0,size:"md",className:"banner__timer",as:"div"},o().createElement(Dt.A,{fill:"var(--component-textIcon-static-prominentDark)"}),o().createElement(Oe.RemainingTime,{as:"span",className:"banner__timer__countdown",end_time:parseInt(d||""),getCardLabels:i.getCardLabels,start_time:n,key:"remaining-time"}))):null};var Zd=r("../../node_modules/@deriv/quill-icons/dist/esm/react/LabelPaired/LabelPairedArrowLeftSmBoldIcon.js");const Qd=(0,ye.observer)((function(){var e=(0,be.useLocation)().state,t=(0,be.useHistory)(),r=(0,s.A)().common.routeBackInApp;return o().createElement("header",{className:"header contract-details-header-v2"},o().createElement(o().Suspense,{fallback:o().createElement("div",null)},o().createElement(Io.K,{variant:"tertiary",icon:o().createElement(Zd.A,{height:"22px",width:"13px","data-testid":"arrow",key:"arrow"}),className:"arrow",color:"black-white",onClick:function(){return!(0,i.isEmptyObject)(e)&&e.from_table_row?t.goBack():r(t)}}),o().createElement(je.E,{size:"md",bold:!0,color:"quill-typography__color--prominent"},o().createElement(K.Localize,{i18n_default_text:"Contract details"}))))}));function ef(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var tf=(0,ye.observer)((function(){var e,t,r=od(),n=r.contract_info,a=r.is_loading,l=n.contract_id,c=n.currency,u=n.contract_type,d=n.limit_order,f=null!=d?d:{take_profit:{},stop_loss:{}},m=f.take_profit,p=f.stop_loss,y=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ef(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ef(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o().useState([]),2),_=y[0],v=y[1],h=(0,s.A)().common.server_time,b=Id(null!=u?u:""),g=b.isTakeProfitVisible,E=b.isStopLossVisible,S=(0,i.isValidToSell)(n),w=o().useCallback((function(e){e&&i.WS.contractUpdateHistory(e).then((function(e){v(e.contract_update_history.sort((function(e,t){return Number(null==t?void 0:t.order_date)-Number(null==e?void 0:e.order_date)})))})).catch((function(){return null}))}),[]);if(o().useEffect((function(){w(l)}),[l,null==m?void 0:m.order_amount,null==p?void 0:p.order_amount,w]),a)return o().createElement(Oe.Loading.DTraderV2,{is_contract_details:!0});var A=(0,i.isMultiplierContract)(n.contract_type),O=(0,i.isValidToCancel)(n),k=((0,i.hasContractEntered)(n)||(0,i.isForwardStarting)(null!==(e=null==n?void 0:n.shortcode)&&void 0!==e?e:"",n.purchase_time))&&(0,i.isOpen)(n),x=Id(null!==(t=n.contract_type)&&void 0!==t?t:""),C=x.isTpHistoryVisible,T=x.isDealCancellationVisible,j=A&&O,L=(0,i.isOpen)(n)&&(g||E)&&(S||T);return(0,i.isAccumulatorContract)(n.contract_type)&&(L=(0,i.isOpen)(n)&&Boolean(d)),o().createElement(o().Fragment,null,o().createElement(Qd,null),o().createElement("div",{className:at()("contract-details",{"contract-details--two-buttons":k&&j,"contract-details--one-button":k&&!j})},o().createElement(Xd,{contract_info:n,server_time:h}),o().createElement(mu,{contractInfo:n,serverTime:h,currency:c}),o().createElement(id,null),o().createElement(Yd,null),L&&o().createElement(Ju,null,o().createElement(Hd,null),o().createElement(Gd,null)),o().createElement(Td,{contract_info:n}),o().createElement(nd,{contract_info:n}),o().createElement(Qu,{contract_info:n}),C&&_.length>0&&o().createElement(rd,{history:_,currency:c,is_multiplier:A})),k&&o().createElement(Jd,{contract_info:n}))}));const rf=tf,nf=[{path:i.routes.trade,component:Xs,exact:!0,default:!1},{path:i.routes.trader_positions,component:$u,is_authenticated:!0,default:!1},{path:i.routes.contract,component:rf,is_authenticated:!0,default:!1},{path:"/*",component:(0,n.lazy)((function(){return Promise.resolve().then(r.bind(r,"./src/Modules/Page404/index.ts"))})),default:!1}];var of=r("./src/Modules/Page404/index.ts");function af(){return af=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},af.apply(null,arguments)}const lf=(0,ye.observer)((function(){var e=(0,s.A)(),t=e.client,r=e.common,a=e.portfolio,i=t.is_logged_in,l=r.current_language,c=a.onMount,u=a.onUnmount;return o().useEffect((function(){return c(),u}),[]),o().createElement(n.Suspense,{fallback:o().createElement(Oe.UILoader,null)},o().createElement(be.Switch,null,nf.map((function(e,t){return o().createElement(Oe.RouteWithSubroutes,af({key:t,is_logged_in:i,language:l,Component404:of.default,should_redirect_login:!0,routes:nf,to:""},e))}))))}));function cf(e){return cf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cf(e)}function sf(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function uf(e,t,r){return(t=function(e){var t=function(e){if("object"!=cf(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=cf(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==cf(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var df=(0,ye.observer)((function(){var e,t=(0,s.A)(),r=t.common,n=r.services_error,a=r.resetServicesError,l=t.ui.is_mf_verification_pending_modal_visible,c=t.client.is_logged_in,u=(0,Ie.P)(),d=u.is_multiplier,f=u.proposal_info,m=u.validation_errors,p=u.trade_types,y=u.contract_type,_=u.trade_type_tab,v=od().contract_info,h=(0,_r.d)().addSnackbar,b=(0,be.useLocation)().pathname,g=n||{},E=g.code,S=g.message,w=!(0,i.isEmptyObject)(n),A=Ye({services_error:n,is_mf_verification_pending_modal_visible:l}),O=null!==(e=f[(0,Et.H1)(p,y,_)[0]])&&void 0!==e?e:{},k=O.has_error,x=O.error_field,C=O.message,T=k&&!x&&!Object.keys(m).some((function(e){return m[e].length})),j=!(!w&&!T)&&(b===i.routes.trade?w&&!A||T:!(b!==i.routes.trader_positions&&!location.pathname.startsWith("/contract/"))&&w),L=j&&"CompanyWideLimitExceeded"===E,P=location.pathname.startsWith("/contract/")&&d&&(0,i.isValidToCancel)(v)?"104px":"48px",I={actionText:(0,K.localize)("View"),onActionClick:function(){return window.open((0,i.getStaticUrl)("tnc/trading-terms.pdf",!0))}};return o().useEffect((function(){j&&h(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?sf(Object(r),!0).forEach((function(t){uf(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sf(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({message:null!=S?S:C,status:"fail",hasCloseButton:!0,hasFixedHeight:!1,onSnackbarRemove:a,style:{marginBottom:c?P:"-8px",width:"calc(100% - var(--core-spacing-800)"}},L?I:{}))}),[j,L]),o().createElement(ba.C,null)}));const ff=df;function mf(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const pf=function(e){var t=e.passthrough,r=(0,a.A)(t.root_store,t.WS);return o().useEffect((function(){return function(){return r.ui.setPromptHandler(!1)}}),[r]),o().useLayoutEffect((function(){var e,t,r=document.head,n=r.querySelectorAll('link[rel="stylesheet"]'),o=null===(e=n[n.length-1])||void 0===e||null===(t=e.href)||void 0===t?void 0:t.includes("/trader"),a=function(e){return function(e){if(Array.isArray(e))return mf(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return mf(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?mf(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(n).filter((function(e){var t;return null==e||null===(t=e.href)||void 0===t?void 0:t.includes("/trader")}));if(!o){var i=null==a?void 0:a.map((function(e){return null==e?void 0:e.cloneNode(!0)}));return i.forEach((function(e){return r.appendChild(e)})),function(){return null==i?void 0:i.forEach((function(e){return r.removeChild(e)}))}}}),[]),o().useEffect((function(){window.location.pathname===i.routes.trade&&(0,wo._S)()}),[window.location.pathname]),o().createElement(c.A,{store:r},o().createElement(fe,null,o().createElement(l.A,{store:r},o().createElement(me._,null,o().createElement(pe.n,null,o().createElement(Ae,null),o().createElement(lf,null),o().createElement(ff,null))))))}},"./src/Modules/Contract/Containers/contract-replay-widget.tsx":(e,t,r)=>{r.d(t,{dO:()=>w,fy:()=>S,$i:()=>g,WN:()=>E});var n=r("react"),o=r.n(n),a=r("./src/Modules/Contract/Components/Digits/index.ts"),i=r("./src/App/Components/Animations/index.ts"),l=r("../../node_modules/classnames/index.js"),c=r.n(l),s=r("@deriv/components"),u=r("@deriv/translations"),d=r("@deriv/shared"),f=r("mobx-react-lite"),m=r("../stores/src/useStore.ts");function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const y=(0,f.observer)((function(e){var t=e.contract_info,r=(0,m.A)().ui.is_mobile,n=r?47:150,a=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o().useState(!0),2),i=a[0],l=a[1],f=function(e){e?(e.preventDefault(),("keydown"!==e.type||"keydown"===e.type&&"Enter"===e.key)&&l(!i)):l(!i)};return o().createElement("div",{className:"info-box-longcode"},o().createElement(s.Icon,{icon:"IcContractFlag",className:"info-box-longcode-icon",size:24}),o().createElement("div",{className:"info-box-longcode-wrapper",onClick:r?f:void 0,onKeyDown:f},o().createElement(s.Text,{size:"xs",className:c()("info-box-longcode-text",{"info-box-longcode-text--collapsed":i||r,"info-box-longcode-text--collapsed--fixed-height":!d.isTabletOs&&(i||r)})},t.longcode)," ",(null==t?void 0:t.longcode)&&t.longcode.length>n&&o().createElement(s.Text,{as:"a",href:"#",size:"xs",onClick:f,className:"info-box-longcode-text"},i||r?o().createElement(u.Localize,{i18n_default_text:"View more"}):o().createElement(u.Localize,{i18n_default_text:"View less"}))),o().createElement(s.Modal,{className:"info-box-longcode--modal",is_open:r&&!i,title:o().createElement(u.Localize,{i18n_default_text:"Trade info"}),has_close_icon:!1,should_close_on_click_outside:!0,small:!0,toggleModal:f},o().createElement(s.Modal.Body,null,o().createElement(s.Text,{size:"xs"},t.longcode)),o().createElement(s.Modal.Footer,null,o().createElement(s.Button,{className:"info-box-longcode--modal-button",primary:!0,large:!0,onClick:f},o().createElement(u.Localize,{i18n_default_text:"OK"})))))})),_=function(e){var t=e.message,r=void 0===t?"":t,n=e.onClickClose;return r?o().createElement("div",{className:"message"},o().createElement("div",{className:"message-icon"},o().createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16"},o().createElement("g",{fill:"none",fillRule:"evenodd"},o().createElement("circle",{cx:"8",cy:"8",r:"8",fill:"#F44336"}),o().createElement("path",{fill:"#FFF",fillRule:"nonzero",d:"M8 7.293l3.146-3.147a.5.5 0 0 1 .708.708L8.707 8l3.147 3.146a.5.5 0 0 1-.708.708L8 8.707l-3.146 3.147a.5.5 0 0 1-.708-.708L7.293 8 4.146 4.854a.5.5 0 1 1 .708-.708L8 7.293z"})))),o().createElement("div",{className:"message-text"},r),o().createElement("div",{className:"message-close",onClick:n},o().createElement(s.Icon,{icon:"IcCross"}))):null},v=function(e){var t=e.contract_info,r=e.error_message,n=e.removeError,a=!!t.longcode;return o().createElement(i.F,{is_visible:a,className:"info-box-container",keyname:"info-box-container"},!!t.contract_type&&o().createElement("div",{className:"info-box"},o().createElement(y,{contract_info:t})),o().createElement(_,{message:r,onClickClose:n}))};var h=r("./src/Modules/SmartChart/Components/bottom-widgets.tsx"),b=r("./src/Modules/SmartChart/Components/top-widgets.tsx"),g=(0,f.observer)((function(){var e=(0,m.A)(),t=e.contract_replay,r=e.ui.is_mobile,n=t.contract_store,i=n.contract_info,l=n.digits_info,c=n.display_status,s=n.is_digit_contract,u=n.is_ended;return o().createElement(a.A,{is_digit_contract:s,is_ended:u,is_mobile:r,contract_info:i,digits_info:l,display_status:c})})),E=(0,f.observer)((function(){var e=(0,m.A)().contract_replay,t=e.contract_store,r=e.removeErrorMessage,n=e.error_message,a=t.contract_info;return o().createElement(v,{contract_info:a,error_message:n,removeError:r})})),S=function(){return o().createElement(b.A,{InfoBox:o().createElement(E,null),is_title_enabled:!1})},w=function(){return o().createElement(h.A,{Widget:o().createElement(g,null)})}},"./src/Modules/Contract/Containers/replay-chart.tsx":(e,t,r)=>{r.d(t,{A:()=>y});var n=r("react"),o=r.n(n),a=r("@deriv/components"),i=r("@deriv/shared"),l=r("mobx-react-lite"),c=r("../stores/src/useStore.ts"),s=r("./src/Stores/useTraderStores.tsx"),u=r("./src/Modules/Contract/Containers/contract-replay-widget.tsx"),d=r("./src/Modules/SmartChart/Components/Markers/marker.tsx");const f=o().memo((function(e){var t=e.contract_info,r=null!=t?t:{},n=r.contract_type,a=r.entry_spot,i=r.reset_time,l=r.reset_barrier,c=/CALL/i.test(null!=n?n:""),s=Math.max(Number(a),Number(l));return c&&(s=Math.min(Number(a),Number(l))),o().createElement(o().Fragment,null,o().createElement(d.A,{is_positioned_behind:!0,marker_config:{ContentComponent:"div",x:Number(i),y:s},marker_content_props:{className:"sc-barrier_gradient sc-barrier_gradient--".concat(c?"to-bottom":"to-top")}}),o().createElement(d.A,{is_positioned_behind:!0,marker_config:{ContentComponent:"div",x:Number(i),y:Number(l)},marker_content_props:{className:"sc-reset_barrier"}}))}));var m=r("./src/Modules/SmartChart/index.js"),p=r("../../node_modules/@deriv-com/ui/dist/hooks/useDevice.js");const y=(0,l.observer)((function(e){var t,r=e.is_dark_theme_prop,n=e.is_accumulator_contract,l=e.is_reset_contract,y=e.is_vertical_scroll_disabled,_=(0,s.P)(),v=(0,c.A)(),h=v.contract_replay,b=v.common,g=v.ui,E=(0,p.Y)().isMobile,S=h.contract_store,w=h.chart_state,A=h.chartStateChange,O=h.margin,k=S.contract_config,x=S.is_digit_contract,C=S.barriers_array,T=S.getContractsArray,j=S.markers_array,L=S.contract_info,P=L.underlying,I=L.audit_details,N=L.barrier_count,D="READY"===w||"SCROLL_TO_LEFT"===w,M=b.app_routing_history,z=b.current_language,R=b.is_socket_opened,F=g.is_chart_layout_default,U=g.is_chart_countdown_visible,q=k||{},V=q.end_epoch,B=q.chart_type,H=q.start_epoch,G=q.granularity,Y=r||g.is_dark_mode_on,W=!(null==L||!L.is_forward_starting||(0,i.hasContractStarted)(L)||!L.is_sold),$="DBot"===(0,i.getPlatformRedirect)(M).name,K={language:z,theme:Y&&!$?"dark":"light",position:F?"bottom":"left",countdown:U,assetInformation:!1,isHighestLowestMarkerEnabled:!1},J=D&&k?k.scroll_to_epoch:void 0,X=I?I.all_ticks:[],Z=_.wsForget,Q=_.wsSubscribe,ee=_.wsSendRequest,te=_.wsForgetStream,re=function(){return!E&&x},ne=(0,a.usePrevious)(H),oe=!!(0,i.getEndTime)(L),ae=(0,i.isDtraderV2DesktopEnabled)(g.is_desktop)||(0,i.isDtraderV2MobileEnabled)(g.is_mobile);return o().createElement(m.GR,{id:"replay",barriers:C,bottomWidgets:re()?u.dO:void 0,chartControlsWidgets:null,chartType:B,endEpoch:V,margin:O,isMobile:E,enabledNavigationWidget:!E,enabledChartFooter:!1,granularity:G,requestAPI:ee,requestForget:Z,requestForgetStream:te,crosshair:E?0:void 0,maxTick:E?8:void 0,requestSubscribe:Q,settings:K,startEpoch:W?L.purchase_time:H,scrollToEpoch:J,stateChangeListener:A,symbol:P,allTicks:X,topWidgets:ae?function(){return o().createElement(o().Fragment,null)}:u.fy,isConnectionOpened:R,isStaticChart:!!n&&!!V&&Number(H)<Number(ne),shouldFetchTradingTimes:!1,should_zoom_out_on_yaxis:n,yAxisMargin:(t={top:E?96:148,bottom:re()?128:112},E&&(t.bottom=48,t.top=48),t),anchorChartToLeft:E,shouldFetchTickHistory:"seconds"!==(0,i.getDurationUnitText)((0,i.getDurationPeriod)(L))||"open"===L.status,shouldDrawTicksFromContractInfo:n,contractInfo:L,contracts_array:T(),isLive:!oe,isVerticalScrollEnabled:!y,startWithDataFitMode:!0},j.map((function(e){var t=e.content_config,r=e.marker_config,n=e.react_key,a=e.type;return o().createElement(d.A,{key:n,marker_config:r,marker_content_props:t,is_positioned_before:("SPOT_ENTRY"===a||"SPOT_EXIT"===a)&&2===N})})),l&&(null==L?void 0:L.reset_time)&&o().createElement(f,{contract_info:L}))}))},"./src/Stores/Modules/Trading/Helpers/end-time.ts":(e,t,r)=>{r.d(t,{X:()=>i,h:()=>l});var n=r("../../node_modules/moment/moment.js"),o=r.n(n),a=function(e,t){var r=o()(e);return r.minute(Math.ceil(r.minute()/t)*t)},i=function(e,t,r,n){for(var i=0;i<r.length;i++)if(t.isAfter(r[i])&&t.isBefore(n[i]))return a(t,5).format("HH:mm");for(var l=0;l<r.length;l++){var c=o()(r[l]);if(c.isAfter(e))return a(c,5).format("HH:mm")}return a(e,5).format("HH:mm")},l=function(e,t,r){var n={start:t.map((function(t){return e.isBefore(t)?o()(t).clone():e})),end:r};return n.start.length>0&&(n.start[0]=a(n.start[0],5)),n}},"./src/Stores/Modules/Trading/Helpers/logic.ts":(e,t,r)=>{r.d(t,{d:()=>o});var n=r("./src/_common/base/server_time.ts"),o=function(e){var t;return!(null===(t=e.cancellation)||void 0===t||!t.date_expiry)&&e.cancellation.date_expiry<n.A.get().unix()}}}]);